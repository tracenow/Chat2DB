(self.webpackChunkchat2db=self.webpackChunkchat2db||[]).push([[8185],{67381:function(At,Ea,K){"use strict";K.d(Ea,{ZP:function(){return l}});var pe={name:"workspaceConsoleDDL",primaryKey:{keyPath:"consoleId",autoIncrement:!0},column:[{name:"consoleId",isIndex:!0,keyPath:"consoleId",options:{unique:!0}},{name:"userId",isIndex:!0,keyPath:"userId",options:{unique:!1}},{name:"ddl",isIndex:!0,keyPath:"ddl",options:{unique:!1}}]},W=[{tableDetails:pe}],Da=function(Ae,Ve){return new Promise(function(la,$){var X=window.indexedDB.open(Ae,Ve);X.onerror=function(Je){$(Je.target.error)},X.onsuccess=function(Je){la(Je.target.result)},X.onupgradeneeded=function(Je){var s=Je.target.result;W.forEach(function(Xe){var ae=Xe.tableDetails,Ct=s.createObjectStore(ae.name,ae.primaryKey);ae.column.forEach(function(Ra){Ra.isIndex&&Ct.createIndex(Ra.name,Ra.keyPath,Ra.options)})})}})},ee=function(Ae,Ve,la){return new Promise(function($,X){var Je=window._indexedDB[Ae].transaction(Ve,"readwrite"),s=Je.objectStore(Ve),Xe=s.add(la);Xe.onsuccess=function(){$(!0)},Xe.onerror=function(ae){X(ae)}})},La=function(Ae,Ve,la,$){return new Promise(function(X,Je){var s=window._indexedDB[Ae].transaction(Ve,"readwrite"),Xe=s.objectStore(Ve),ae=Xe.index(la).delete($);ae.onsuccess=function(){X(!0)},ae.onerror=function(){Je(!1)}})},he=function(Ae,Ve,la){return new Promise(function($,X){var Je=window._indexedDB[Ae].transaction(Ve,"readwrite"),s=Je.objectStore(Ve),Xe=s.delete(la);Xe.onsuccess=function(){$(!0)},Xe.onerror=function(){X(!1)}})},Ua=function(Ae,Ve,la,$){return new Promise(function(X,Je){var s=window._indexedDB[Ae].transaction(Ve,"readwrite"),Xe=s.objectStore(Ve),ae=Xe.index(la).get($);ae.onsuccess=function(){X(ae.result)},ae.onerror=function(){Je(!1)}})},_e=function(Ae,Ve,la){return new Promise(function($,X){var Je=window._indexedDB[Ae].transaction(Ve,"readwrite"),s=Je.objectStore(Ve),Xe=s.openCursor(),ae=[];Xe.onsuccess=function(Ct){var Ra=Ct.target.result;if(Ra){var Ot=!0;Object.keys(la).forEach(function(jt){Ra.value[jt]!==la[jt]&&(Ot=!1)}),Ot&&ae.push(Ra.value),Ra.continue()}else $(ae)},Xe.onerror=function(){X(!1)}})},Et=function(Ae,Ve,la){return new Promise(function($,X){var Je=window._indexedDB[Ae].transaction(Ve,"readwrite"),s=Je.objectStore(Ve),Xe=s.put(la);Xe.onsuccess=function(){$(!0)},Xe.onerror=function(){X(!1)}})},j=function(Ae){return new Promise(function(Ve){window._indexedDB[Ae].close(),Ve(!0)})},l={createDB:Da,addData:ee,deleteDataByIndex:La,deleteData:he,getDataByIndex:Ua,getDataByCursor:_e,updateData:Et,closeDB:j}},42339:function(At,Ea,K){"use strict";K.r(Ea),K.d(Ea,{default:function(){return vd}});var pe=K(9783),W=K.n(pe),Da=K(15009),ee=K.n(Da),La=K(99289),he=K.n(La),Ua=K(19632),_e=K.n(Ua),Et=K(5574),j=K.n(Et),l=K(67294),Fa=K(96974),Ae=K(83159),Ve=K(83062),la=K(94184),$=K.n(la),X=K(48055),Je=K(9450),s=K(32888),Xe=K(58839),ae=K(46621),Ct=(0,ae.Z)("/api/connection/datasource/list",{}),Ra=(0,ae.Z)("/api/connection/datasource/:id",{}),Ot=(0,ae.Z)("/api/connection/datasource/create",{method:"post",delayTime:!0}),jt=(0,ae.Z)("/api/connection/datasource/close",{method:"post"}),Wn=(0,ae.Z)("/api/connection/datasource/pre_connect",{method:"post",delayTime:!0}),Hn=(0,ae.Z)("/api/connection/ssh/pre_connect",{method:"post",delayTime:!0}),Gn=(0,ae.Z)("/api/connection/datasource/update",{method:"post"}),qn=(0,ae.Z)("/api/connection/datasource/:id",{method:"delete"}),Kn=(0,ae.Z)("/api/connection/datasource/clone",{method:"post"}),zn=(0,ae.Z)("/api/rdb/database/list",{method:"get"}),Yn=(0,ae.Z)("/api/rdb/schema/list",{method:"get"}),Qn=(0,ae.Z)("/api/jdbc/driver/list",{errorLevel:!1,method:"get"}),$n=(0,ae.Z)("/api/jdbc/driver/download",{method:"get"}),Jn=(0,ae.Z)("/api/jdbc/driver/save",{method:"post"}),Xn=(0,ae.Z)("/api/common/environment/list_all",{errorLevel:!1}),ra={getEnvList:Xn,getList:Ct,getDetails:Ra,save:Ot,test:Wn,update:Gn,remove:qn,clone:Kn,getDatabaseList:zn,getSchemaList:Yn,close:jt,testSSH:Hn,getDriverList:Qn,downloadDriver:$n,saveDriver:Jn},zt=K(50161),kt=K(782),er=K(76248),ol=K(97857),h=K.n(ol),ll={layout:{panelLeft:!0,panelRight:!0,panelLeftWidth:220,panelRightWidth:300}},il=function(){return Re.setState(function(a){return{layout:h()(h()({},a.layout),{},{panelRight:!a.layout.panelRight})}})},sl=function(){return Re.setState(function(a){return{layout:h()(h()({},a.layout),{},{panelLeft:!a.layout.panelLeft})}})},ul=function(a){return Re.setState(function(t){return{layout:h()(h()({},t.layout),{},{panelLeftWidth:a})}})},cl=function(a){return Re.setState(function(t){return{layout:h()(h()({},t.layout),{},{panelRightWidth:a})}})},dl=(0,ae.Z)("/api/operation/saved/create",{method:"post"}),ml=(0,ae.Z)("/api/operation/saved/:id",{method:"get"}),fl=(0,ae.Z)("/api/operation/saved/update",{method:"post"}),vl=(0,ae.Z)("/api/operation/saved/list",{}),_l=(0,ae.Z)("/api/operation/saved/:id",{method:"delete"}),pl=(0,ae.Z)("/api/operation/log/create",{method:"post"}),hl=(0,ae.Z)("/api/operation/log/list",{}),Pa={getConsoleList:vl,updateSavedConsole:fl,getHistoryList:hl,createConsole:dl,deleteSavedConsole:_l,createHistory:pl,getWindowTab:ml},d=K(22216),Ge=K(2453),bl={consoleList:null,savedConsoleList:null,activeConsoleId:null,workspaceTabList:null,createConsoleLoading:!1},Tr=function(){Pa.getConsoleList({tabOpened:"y",pageNo:1,pageSize:20}).then(function(a){Re.setState({consoleList:a==null?void 0:a.data})})},mn=function(){Pa.getConsoleList({pageNo:1,pageSize:100,status:d.ConsoleStatus.RELEASE}).then(function(a){Re.setState({savedConsoleList:a==null?void 0:a.data})})},fn=function(a){Re.setState({activeConsoleId:a})},wt=function(a){Re.setState({workspaceTabList:a})},$a=function(a){var t=Re.getState().workspaceTabList,r=Re.getState().currentConnectionDetails,o=h()(h()({},a),{},{name:a.name||"untitled-".concat(a.databaseName||a.schemaName," (").concat(a.dataSourceName,")"),ddl:a.ddl||"",status:d.ConsoleStatus.DRAFT,operationType:a.operationType||d.WorkspaceTabType.CONSOLE,type:a.databaseType,supportDatabase:r==null?void 0:r.supportDatabase,supportSchema:r==null?void 0:r.supportSchema});return new Promise(function(i){if(((t==null?void 0:t.length)||0)>=20){Ge.ZP.warning((0,s.ZP)("workspace.tips.maxConsole"));return}Re.setState({createConsoleLoading:!0}),Pa.createConsole(o).then(function(u){var c=[].concat(_e()(t||[]),[{id:u,title:o.name,type:o.operationType,uniqueData:o}]);wt(c),fn(u),i(u)}).finally(function(){Re.setState({createConsoleLoading:!1})})})},ia=function(a){var t=Re.getState().workspaceTabList;if((t==null?void 0:t.findIndex(function(o){return(o==null?void 0:o.id)===(a==null?void 0:a.id)}))!==-1){fn(a.id);return}var r=[].concat(_e()(t||[]),[a]);wt(r),fn(a.id)},Nl={openCreateDatabaseModal:null},Sl=function(a){Re.setState({openCreateDatabaseModal:a})},Re=(0,zt.F)((0,kt.mW)((0,kt.tJ)(function(){return h()(h()(h()(h()({},bl),ll),Tl),Nl)},{name:"workspace-store",getStorage:function(){return localStorage},partialize:function(a){return{layout:a.layout,currentConnectionDetails:a.currentConnectionDetails}}}),{name:"workspaceStore"}),er.X),Tl={currentConnectionDetails:null,currentWorkspaceExtend:null,currentWorkspaceGlobalExtend:null},Yt=function(a){return Re.setState({currentConnectionDetails:a})},Er=function(a){return Re.setState({currentWorkspaceExtend:a})},Cr=function(a){return Re.setState({currentWorkspaceGlobalExtend:a})},El={connectionList:null,connectionEnvList:null},Ga=(0,zt.F)((0,kt.mW)(function(){return El}),er.X),Dd=function(a){return Ga.setState({connectionList:a})},Cl=function(a){return Ga.setState({connectionEnvList:a})},Mt=function(){return new Promise(function(a,t){var r=Re.getState().currentConnectionDetails;ra.getList({pageNo:1,pageSize:1e3,refresh:!0}).then(function(o){var i=(o==null?void 0:o.data)||[];if(Ga.setState({connectionList:i}),a(i),i.length===0){Yt(null);return}if(!(r!=null&&r.id)){Yt(i[0]);return}var u=i.find(function(c){return c.id===(r==null?void 0:r.id)});u||Yt(i[0])}).catch(function(){Ga.setState({connectionList:[]}),t([])})})},gl=function(){ra.getEnvList().then(function(a){Cl(a)})},xl=gl,Il={mainPageActiveTab:"connections"},gr=(0,zt.F)((0,kt.mW)((0,kt.tJ)(function(){return Il},{name:"main-page-store",getStorage:function(){return localStorage},partialize:function(a){return{mainPageActiveTab:a.mainPageActiveTab}}})),er.X),ar=function(a){return gr.setState({mainPageActiveTab:a})},xr=K(32887),tr=K(71807),nr={"f-icon-button":"f-icon-button___f5Q2x","f-fill-absolute":"f-fill-absolute____rU44","f-button":"f-button___lDL7c","f-doc-en-break":"f-doc-en-break___Px1jo",customLayout:"customLayout___rgUF1",iconPanel:"iconPanel___WNLHS","loading-animation":"loading-animation___Wh_PE"},e=K(85893),yl=(0,l.memo)(function(n){var a=n.className,t=Re(function(u){return{panelLeft:u.layout.panelLeft,panelRight:u.layout.panelRight}}),r=t.panelLeft,o=t.panelRight,i=function(c){c.stopPropagation()};return(0,e.jsxs)("div",{className:$()(nr.customLayout,a),children:[(0,e.jsx)("div",{className:$()(nr.iconPanel),onClick:sl,onDoubleClick:i,children:r?(0,e.jsx)(X.Z,{code:"\uE674"}):(0,e.jsx)(X.Z,{code:"\uE670"})}),(0,e.jsx)("div",{className:$()(nr.iconPanel),onClick:il,onDoubleClick:i,children:o?(0,e.jsx)(X.Z,{code:"\uE672"}):(0,e.jsx)(X.Z,{code:"\uE673"})})]})}),Zt={box:"box___tePuB",divider:"divider___WuOo7",dividerCenter:"dividerCenter___a4Tyh",box_column:"box_column___FUneH",displayDivider:"displayDivider___oB5Mz"},vn=(0,l.memo)(function(n){var a,t,r=n.children,o=n.showLine,i=o===void 0?!0:o,u=n.onResize,c=n.min,m=n.className,f=n.layout,b=f===void 0?"row":f,E=((a=r[0])===null||a===void 0?void 0:a.ref)||((t=r[1])===null||t===void 0?void 0:t.ref),O=(0,l.useRef)(null),T=(0,l.useRef)(null),x=(0,l.useState)(!1),_=j()(x,2),N=_[0],C=_[1],p=b==="row";(0,l.useEffect)(function(){O.current&&(O.current.onmousedown=function(k){if(E!=null&&E.current){k.preventDefault(),C(!0);var D=p?k.clientX:k.clientY,S=p?E.current.offsetWidth:E.current.offsetHeight;document.onmousemove=function(M){v(p?M.clientX:M.clientY,E.current,D,S)},document.onmouseup=function(){C(!1),document.onmouseup=null,document.onmousemove=null}}})},[]);var v=function(D,S,M,I){var L,P=D-M,w=0;w=(L=r[0])!==null&&L!==void 0&&L.ref?I+P:I-P,!(c&&w<c)&&(p?S.style.width=w+"px":S.style.height=w+"px",u&&u(w))};return(0,e.jsxs)("div",{className:$()(Zt.box,W()({},Zt.box_column,!p),m),children:[r[0],(0,e.jsx)("div",{style:{display:i?"block":"none"},ref:T,className:$()(Zt.divider,W()({},Zt.displayDivider,!r[1])),children:(0,e.jsx)("div",{ref:O,className:$()(Zt.dividerCenter,W()({},Zt.dragging,N))})}),r[1]]})}),Qt={"f-icon-button":"f-icon-button___imUPM","f-fill-absolute":"f-fill-absolute___nXCsA","f-button":"f-button___HKuNI","f-doc-en-break":"f-doc-en-break___n9hd5",workspaceLeft:"workspaceLeft___r6f3R",noConnectionList:"noConnectionList___cqiM3",noConnectionListIcon:"noConnectionListIcon___lLxKe",noConnectionListTips:"noConnectionListTips___pfNFq",create:"create___fltTj",createButtonBox:"createButtonBox___WIaHA",divider:"divider___jWHeR","loading-animation":"loading-animation___mO0k5"},Ir={"f-icon-button":"f-icon-button___nlNFV","f-fill-absolute":"f-fill-absolute___ucAsG","f-button":"f-button___YxLmm","f-doc-en-break":"f-doc-en-break___eG_HP",treeContainer:"treeContainer___b3A8z",treeBox:"treeBox___PYZTj",leftModuleTitleShadow:"leftModuleTitleShadow___tc72A","loading-animation":"loading-animation___ppXsg"},rr={operationLine:"operationLine___RbeOs",operationLineLeft:"operationLineLeft___ZQ658",searchBox:"searchBox___xUpxw"},xe=K(76972),Dl=[d.DatabaseTypeCode.H2],Ll=[d.DatabaseTypeCode.ORACLE],Rl=function(a){var t=(0,l.useState)(!1),r=j()(t,2),o=r[0],i=r[1],u=a.searchValue,c=a.setSearchValue,m=a.getTreeData,f=Re(function(x){return{currentConnectionDetails:x.currentConnectionDetails,openCreateDatabaseModal:x.openCreateDatabaseModal}}),b=f.currentConnectionDetails,E=f.openCreateDatabaseModal,O=function(){var _=b!=null&&b.supportDatabase?"database":"schema";E==null||E({type:_,relyOnParams:{databaseType:b.type,dataSourceId:b.id},executedCallback:function(){m(!0)}})},T=(0,l.useMemo)(function(){if(b!=null&&b.supportDatabase)return!Dl.includes(b.type);if(b!=null&&b.supportSchema)return!Ll.includes(b.type)},[b]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:rr.operationLine,children:(0,e.jsxs)("div",{className:rr.operationLineLeft,children:[T&&(0,e.jsx)(X.Z,{onClick:O,code:"\uEB78",box:!0,boxSize:20,size:15}),(0,e.jsx)(X.Z,{onClick:function(){m(!0)},code:"\uE668",box:!0,boxSize:20,size:14})]})}),(0,e.jsx)("div",{className:rr.searchBox,children:(0,e.jsx)(xe.Z,{size:"small",prefix:(0,e.jsx)(X.Z,{code:"\uE888"}),value:u,onChange:function(_){return c(_.target.value)},allowClear:!0,placeholder:(0,s.ZP)("workspace.tree.search.placeholder")})})]})},Pl=(0,l.memo)(Rl),ua={"f-icon-button":"f-icon-button___mrwpF","f-fill-absolute":"f-fill-absolute___SQlv6","f-button":"f-button___loVxw","f-doc-en-break":"f-doc-en-break___V3HA8",scrollBox:"scrollBox___zjDsq",treeBox:"treeBox___VmM1H",treeListHolder:"treeListHolder___aYu8g",treeBoxScroll:"treeBoxScroll___U0Nj_",leftModuleTitleShadow:"leftModuleTitleShadow___ARStP",treeNode:"treeNode___tMz9p",treeNodeFocus:"treeNodeFocus___y9Lro",right:"right___k3HU0",indent:"indent___QXXJ_",type:"type___yoEfx",left:"left___x0By4",moreBox:"moreBox___h8B66",moreButton:"moreButton___LCnhp",arrows:"arrows___SXdHP",loadingArrows:"loadingArrows___QEeao",arrowsIcon:"arrowsIcon___EUuHB",rotateArrowsIcon:"rotateArrowsIcon___XoiBH",dblclickArea:"dblclickArea___JEOG7",typeIcon:"typeIcon___srzeS",typeImg:"typeImg___zo80D",contentText:"contentText___y6RPH",name:"name___jKxcW",describe:"describe___cEl5R",hiddenTreeNode:"hiddenTreeNode___HGLbY","loading-animation":"loading-animation___Ic35M"},Ce=K(57632),ye=K(90403),$e,ze,yr=($e={},W()($e,d.TreeNodeType.DATABASE,{icon:"\uE669"}),W()($e,d.TreeNodeType.SCHEMAS,{icon:"\uE696"}),W()($e,d.TreeNodeType.TABLE,{icon:"\uE63E"}),W()($e,d.TreeNodeType.TABLES,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.COLUMNS,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.COLUMN,{icon:"\uE611"}),W()($e,d.TreeNodeType.KEYS,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.KEY,{icon:"\uE775"}),W()($e,d.TreeNodeType.INDEXES,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.INDEX,{icon:"\uE65B"}),W()($e,d.TreeNodeType.VIEW,{icon:"\uE70C"}),W()($e,d.TreeNodeType.FUNCTION,{icon:"\uE76A"}),W()($e,d.TreeNodeType.PROCEDURE,{icon:"\uE73C"}),W()($e,d.TreeNodeType.TRIGGER,{icon:"\uE64A"}),W()($e,d.TreeNodeType.VIEWCOLUMNS,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.VIEWCOLUMN,{icon:"\uE647"}),W()($e,d.TreeNodeType.FUNCTIONS,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.PROCEDURES,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.TRIGGERS,{icon:"\uEABE",unfoldIcon:"\uEABF"}),W()($e,d.TreeNodeType.VIEWS,{icon:"\uEABE",unfoldIcon:"\uEABF"}),$e),_n=(ze={},W()(ze,d.TreeNodeType.DATA_SOURCES,{getChildren:function(){return new Promise(function(a,t){var r={pageNo:1,pageSize:1e3};ra.getList(r).then(function(o){var i=o.data.map(function(u){return{uuid:(0,Ce.Z)(),key:u.id,name:u.alias,treeNodeType:d.TreeNodeType.DATA_SOURCE,extraParams:{databaseType:u.type,dataSourceId:u.id,dataSourceName:u.alias}}});a(i)}).catch(function(){t()})})}}),W()(ze,d.TreeNodeType.DATA_SOURCE,{getChildren:function(a){return new Promise(function(t,r){var o=a.extraParams;delete a.extraParams,ra.getDatabaseList(a).then(function(i){var u=i.map(function(c){return{uuid:(0,Ce.Z)(),key:c.name,name:c.name,treeNodeType:d.TreeNodeType.DATABASE,extraParams:h()(h()({},o),{},{databaseName:c.name})}});t(u)}).catch(function(){r()})})},operationColumn:[d.OperationColumn.EditSource,d.OperationColumn.Refresh,d.OperationColumn.ShiftOut],next:d.TreeNodeType.DATABASE}),W()(ze,d.TreeNodeType.DATABASE,{icon:"\uE62C",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ra.getSchemaList(a).then(function(i){var u=i.map(function(c){return{uuid:(0,Ce.Z)(),key:c.name,name:c.name,treeNodeType:d.TreeNodeType.SCHEMAS,schemaName:c.name,extraParams:h()(h()({},t),{},{schemaName:c.name})}});r(u)}).catch(function(){o()})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CreateSchema,d.OperationColumn.CopyName,d.OperationColumn.Refresh],next:d.TreeNodeType.SCHEMAS}),W()(ze,d.TreeNodeType.SCHEMAS,{icon:"\uE696",getChildren:function(a){var t=a.extraParams,r=t.dataSourceId,o=t.databaseName,i=t.schemaName,u=[r,o,i].join("-");return new Promise(function(c){var m=[{uuid:(0,Ce.Z)(),key:"".concat(u,"-tables"),name:"tables",treeNodeType:d.TreeNodeType.TABLES,extraParams:a.extraParams},{uuid:(0,Ce.Z)(),key:"".concat(u,"-views"),name:"view",treeNodeType:d.TreeNodeType.VIEWS,extraParams:a.extraParams},{uuid:(0,Ce.Z)(),key:"".concat(u,"-functions"),name:"functions",treeNodeType:d.TreeNodeType.FUNCTIONS,extraParams:a.extraParams},{uuid:(0,Ce.Z)(),key:"".concat(u,"-procedures"),name:"procedures",treeNodeType:d.TreeNodeType.PROCEDURES,extraParams:a.extraParams},{uuid:(0,Ce.Z)(),key:"".concat(u,"-triggers"),name:"triggers",treeNodeType:d.TreeNodeType.TRIGGERS,extraParams:a.extraParams}];c(m)})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.TABLES,{icon:"\uEAC5",getChildren:function(a,t){var r=a.extraParams;return delete a.extraParams,a.pageSize=1e3,new Promise(function(o,i){ye.Z.getTableList(a,t).then(function(u){var c,m=(c=u.data)===null||c===void 0?void 0:c.map(function(f){return{uuid:(0,Ce.Z)(),name:f.name,treeNodeType:d.TreeNodeType.TABLE,key:f.name,pinned:f.pinned,comment:f.comment,extraParams:h()(h()({},r),{},{tableName:f.name})}});o({data:m,pageNo:u.pageNo,pageSize:u.pageSize,total:u.total,hasNextPage:u.hasNextPage})}).catch(function(u){i(u)})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.ViewAllTable,d.OperationColumn.CreateTable,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.TABLE,{icon:"\uE63E",getChildren:function(a){return new Promise(function(t){var r=a.extraParams,o=r.dataSourceId,i=r.databaseName,u=r.schemaName,c=r.tableName,m=[o,i,u,c].join("-"),f=[{uuid:(0,Ce.Z)(),key:"".concat(m,"-columns"),name:"columns",treeNodeType:d.TreeNodeType.COLUMNS,extraParams:a.extraParams},{uuid:(0,Ce.Z)(),key:"".concat(m,"-keys"),name:"keys",treeNodeType:d.TreeNodeType.KEYS,extraParams:a.extraParams},{uuid:(0,Ce.Z)(),key:"".concat(m,"-indexs"),name:"indexs",treeNodeType:d.TreeNodeType.INDEXES,extraParams:a.extraParams}];t(f)})},operationColumn:[d.OperationColumn.OpenTable,d.OperationColumn.CreateConsole,d.OperationColumn.Pin,d.OperationColumn.ViewDDL,d.OperationColumn.EditTable,d.OperationColumn.CopyName,d.OperationColumn.Refresh,d.OperationColumn.DeleteTable]}),W()(ze,d.TreeNodeType.VIEWS,{icon:"\uE70C",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getViewList(a).then(function(i){var u,c=(u=i.data)===null||u===void 0?void 0:u.map(function(m){return{uuid:(0,Ce.Z)(),name:m.name,treeNodeType:d.TreeNodeType.VIEW,key:m.name,pinned:m.pinned,comment:m.comment,extraParams:h()(h()({},t),{},{tableName:m.name})}});r(c)}).catch(function(i){o(i)})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.FUNCTIONS,{icon:"\uE76A",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getFunctionList(a).then(function(i){var u,c=(u=i.data)===null||u===void 0?void 0:u.map(function(m){return{uuid:(0,Ce.Z)(),name:m.functionName,treeNodeType:d.TreeNodeType.FUNCTION,key:m.name,pinned:m.pinned,comment:m.comment,isLeaf:!0,extraParams:h()(h()({},t),{},{functionName:m.functionName})}});r(c)}).catch(function(i){o(i)})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.FUNCTION,{icon:"\uE76A",operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.OpenFunction,d.OperationColumn.CopyName]}),W()(ze,d.TreeNodeType.PROCEDURES,{icon:"\uE73C",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getProcedureList(a).then(function(i){var u,c=(u=i.data)===null||u===void 0?void 0:u.map(function(m){return{uuid:(0,Ce.Z)(),name:m.procedureName,treeNodeType:d.TreeNodeType.PROCEDURE,key:m.name,pinned:m.pinned,comment:m.comment,isLeaf:!0,extraParams:h()(h()({},t),{},{procedureName:m.procedureName})}});r(c)}).catch(function(i){o(i)})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.PROCEDURE,{icon:"\uE73C",operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.OpenProcedure,d.OperationColumn.CopyName]}),W()(ze,d.TreeNodeType.TRIGGERS,{icon:"\uE64A",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getTriggerList(a).then(function(i){var u,c=(u=i.data)===null||u===void 0?void 0:u.map(function(m){return{uuid:(0,Ce.Z)(),name:m.triggerName,treeNodeType:d.TreeNodeType.TRIGGER,key:m.name,pinned:m.pinned,comment:m.comment,isLeaf:!0,extraParams:h()(h()({},t),{},{triggerName:m.triggerName})}});r(c)}).catch(function(i){o(i)})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.TRIGGER,{icon:"\uE64A",operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.OpenTrigger,d.OperationColumn.CopyName]}),W()(ze,d.TreeNodeType.VIEW,{icon:"\uE70C",getChildren:function(a){return new Promise(function(t){var r=[{uuid:(0,Ce.Z)(),name:"columns",treeNodeType:d.TreeNodeType.COLUMNS,key:"columns",extraParams:a.extraParams}];t(r)})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.OpenView,d.OperationColumn.CopyName]}),W()(ze,d.TreeNodeType.VIEWCOLUMNS,{icon:"\uE647",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getViewColumnList(a).then(function(i){var u,c=(u=i.data)===null||u===void 0?void 0:u.map(function(m){return{uuid:(0,Ce.Z)(),name:m.name,treeNodeType:d.TreeNodeType.VIEWCOLUMN,key:m.name,pinned:m.pinned,comment:m.comment,isLeaf:!0,extraParams:t}});r(c)}).catch(function(i){o(i)})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CopyName,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.VIEWCOLUMN,{icon:"\uE647",operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CopyName]}),W()(ze,d.TreeNodeType.COLUMNS,{icon:"\uEAC5",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getColumnList(a).then(function(i){var u=i==null?void 0:i.map(function(c){return{uuid:(0,Ce.Z)(),name:c.name,treeNodeType:d.TreeNodeType.COLUMN,key:c.name,isLeaf:!0,columnType:c.columnType,comment:c.comment,extraParams:t}});r(u)}).catch(function(){o()})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.COLUMN,{icon:"\uE611",operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CopyName]}),W()(ze,d.TreeNodeType.KEYS,{icon:"\uEAC5",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getKeyList(a).then(function(i){var u=i==null?void 0:i.map(function(c){return{uuid:(0,Ce.Z)(),name:c.name,treeNodeType:d.TreeNodeType.KEY,key:c.name,isLeaf:!0,extraParams:t}});r(u)}).catch(function(){o()})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CopyName,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.KEY,{icon:"\uE775",operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CopyName]}),W()(ze,d.TreeNodeType.INDEXES,{icon:"\uEAC5",getChildren:function(a){var t=a.extraParams;return delete a.extraParams,new Promise(function(r,o){ye.Z.getIndexList(a).then(function(i){var u=i==null?void 0:i.map(function(c){return{uuid:(0,Ce.Z)(),name:c.name,treeNodeType:d.TreeNodeType.INDEX,key:c.name,isLeaf:!0,extraParams:t}});r(u)}).catch(function(){o()})})},operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CopyName,d.OperationColumn.Refresh]}),W()(ze,d.TreeNodeType.INDEX,{icon:"\uE65B",operationColumn:[d.OperationColumn.CreateConsole,d.OperationColumn.CopyName]}),ze),Al=K(55988),Ca={"f-icon-button":"f-icon-button___SRkxR","f-fill-absolute":"f-fill-absolute___NPxmR","f-button":"f-button___EqK2Z","f-doc-en-break":"f-doc-en-break___Yh4Hi",spinner:"spinner___k4crZ",spinnerBlade:"spinnerBlade___XlJnW","spinner-fade9234":"spinner-fade9234___NGPGn","loading-animation":"loading-animation___j2Ndf"},or=(0,l.memo)(function(a){var t=a.className;return(0,e.jsxs)("div",{className:$()(Ca.spinner,Ca.center),children:[(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade}),(0,e.jsx)("div",{className:Ca.spinnerBlade})]})}),Ol=K(73445),Dr={focusId:null,focusTreeNode:null},$t=(0,Ol.Ue)((0,kt.mW)(function(){return Dr})),jl=function(a){$t.setState({focusId:a})},kl=function(a){$t.setState({focusTreeNode:a})},wl=function(){$t.setState(Dr)},H=function(n){return n.INPUT="input",n.PASSWORD="password",n.SELECT="select",n}({}),Se=function(n){return n.USERANDPASSWORD="1",n.NONE="2",n}({}),Ld=function(n){return n[n.PASSWORD=1]="PASSWORD",n[n.KEYPAIR=2]="KEYPAIR",n[n.OPENSSH=3]="OPENSSH",n}({}),ca={items:[{defaultValue:!1,inputType:H.SELECT,labelNameCN:"\u4F7F\u7528SSH",labelNameEN:"USE SSH",name:"use",required:!1,selects:[{label:"false",value:!1},{label:"true",value:!0}]},{defaultValue:"",inputType:H.INPUT,labelNameCN:"SSH \u4E3B\u673A",labelNameEN:"SSH Hostname",name:"hostName",required:!1,styles:{width:"70%"}},{defaultValue:"22",inputType:H.INPUT,labelNameCN:"SSH \u7AEF\u53E3",labelNameEN:"Port",name:"port",required:!1,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"70px",labelAlign:"right"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"SSH UserName",name:"userName",required:!1,styles:{width:"70%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u672C\u5730\u7AEF\u53E3",labelNameEN:"LocalPort",name:"localPort",placeholder:"\u4E0D\u5FC5\u586B",placeholderEN:"Need not fill in",required:!1,styles:{width:"30%",labelWidthEN:"70px",labelWidthCN:"70px",labelAlign:"right"}},{defaultValue:"password",inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"password",value:"password"},{items:[{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u5BC6\u94A5\u6587\u4EF6",labelNameEN:"Private key file",name:"keyFile",required:!0,placeholder:"/user/userName/.ssh/xxxx",placeholderEN:"/user/userName/.ssh/xxxx"},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801\u77ED\u8BED",labelNameEN:"Passphrase",name:"passphrase",required:!0}],label:"Private key",value:"keyFile"}],styles:{width:"50%"}}]},da={defaultValue:"",inputType:H.SELECT,labelNameCN:"\u73AF\u5883",labelNameEN:"Env",name:"environmentId",required:!0,selects:[],styles:{width:"50%"}},pn=[{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"3306",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1},{defaultValue:"jdbc:mysql://localhost:3306",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:mysql:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:mysql://{host}:{port}/{database}"},ssh:ca,extendInfo:[{key:"zeroDateTimeBehavior",value:"convertToNull"},{key:"useInformationSchema",value:"true"}],type:d.DatabaseTypeCode.MYSQL},{type:d.DatabaseTypeCode.POSTGRESQL,baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"5432",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"postgres",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1},{defaultValue:"jdbc:postgresql://localhost:5432",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:postgresql:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:postgresql://{host}:{port}/{database}"},ssh:ca},{type:d.DatabaseTypeCode.ORACLE,baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"1521",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:"sid",inputType:H.SELECT,labelNameCN:"\u94FE\u63A5\u7C7B\u578B",labelNameEN:"Service type",name:"serviceType",required:!0,selects:[{label:"SID",value:"sid",items:[{defaultValue:"XE",inputType:H.INPUT,labelNameCN:"SID",labelNameEN:"SID",name:"sid",required:!0,styles:{width:"70%"}}],onChange:function(a){return a.baseInfo.pattern=/jdbc:oracle:(.*):@(.*):(\d+):(.*)/,a.baseInfo.template="jdbc:oracle:{driver}:@{host}:{port}:{sid}",a}},{label:"Service",value:"service",items:[{defaultValue:"XE",inputType:H.INPUT,labelNameCN:"\u670D\u52A1\u540D",labelNameEN:"Service name",name:"serviceName",required:!0,styles:{width:"70%"}}],onChange:function(a){return a.baseInfo.pattern=/jdbc:oracle:(.*):@\/\/(.*):(\d+)\/(.*)/,a.baseInfo.template="jdbc:oracle:{driver}:@//{host}:{port}/{serviceName}",a}}],styles:{width:"50%"}},{defaultValue:"thin",inputType:H.SELECT,labelNameCN:"\u9A71\u52A8",labelNameEN:"Driver",name:"driver",required:!0,labelTextAlign:"right",selects:[{value:"thin",label:"thin"},{value:"oci",label:"oci"},{value:"oci8",label:"oci8"}],styles:{width:"30%",labelWidthEN:"70px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"jdbc:oracle:thin:@localhost:1521:XE",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:oracle:(.*):@(.*):(\d+):(.*)/,template:"jdbc:oracle:{driver}:@{host}:{port}:{sid}"},ssh:ca},{type:d.DatabaseTypeCode.H2,baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"9092",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:"TCP",inputType:H.SELECT,labelNameCN:"\u94FE\u63A5\u7C7B\u578B",labelNameEN:"Service type",name:"serviceType",required:!0,selects:[{label:(0,s.ZP)("common.label.tcp"),value:"TCP",items:[],onChange:function(a){return a.baseInfo.pattern=/jdbc:h2:tcp:\/\/(.*):(\d+)(\/(\w+))?/,a.baseInfo.template="jdbc:h2:tcp://{host}:{port}/{database}",a}},{label:(0,s.ZP)("common.label.LocalFile"),value:"LocalFile",items:[{defaultValue:"",inputType:H.INPUT,labelNameCN:"File",labelNameEN:"File",name:"file",required:!0}],onChange:function(a){return a.baseInfo.pattern=/jdbc:h2:(.*)?/,a.baseInfo.template="jdbc:h2:{file}",a}}],styles:{width:"70%"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1},{defaultValue:"jdbc:h2:tcp://localhost:9092",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:h2:tcp:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:h2:tcp://{host}:{port}/{database}"},ssh:ca},{type:d.DatabaseTypeCode.SQLSERVER,extendInfo:[{key:"encrypt",value:"false"},{key:"trustServerCertificate",value:"true"},{key:"integratedSecurity",value:"false"},{key:"Trusted_Connection",value:"yes"}],baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"1433",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"Instance",labelNameEN:"Instance",name:"instance",required:!1},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1},{defaultValue:"jdbc:sqlserver://localhost:1433",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:sqlserver:\/\/(.*):(\d+)(;database=(\w+))?/,template:"jdbc:sqlserver://{host}:{port};database={database}"},ssh:ca},{type:d.DatabaseTypeCode.SQLITE,baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"identifier.sqlite",inputType:H.INPUT,labelNameCN:"File",labelNameEN:"File",name:"file",required:!0},{defaultValue:"jdbc:sqlite:identifier.sqlite",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:sqlite:(.*)?/,template:"jdbc:sqlite:{file}"},ssh:ca},{type:d.DatabaseTypeCode.MARIADB,baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"3306",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1},{defaultValue:"jdbc:mariadb://localhost:3306",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:mariadb:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:mariadb://{host}:{port}/{database}"},ssh:ca},{type:d.DatabaseTypeCode.CLICKHOUSE,baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"8123",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1},{defaultValue:"jdbc:clickhouse://localhost:8123",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:clickhouse:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:clickhouse://{host}:{port}/{database}",excludes:[d.OperationColumn.ViewDDL,d.OperationColumn.CreateTable,d.OperationColumn.EditTable]},ssh:ca},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"5236",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1},{defaultValue:"jdbc:dm://localhost:5236",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0}],pattern:/jdbc:dm:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:dm://{host}:{port}/{database}"},ssh:ca,extendInfo:[{key:"zeroDateTimeBehavior",value:"convertToNull"}],type:d.DatabaseTypeCode.DM},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0,styles:{width:"100%"}},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"50000",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0,styles:{width:"100%"}},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0,styles:{width:"100%"}}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1,styles:{width:"100%"}},{defaultValue:"jdbc:db2://localhost:50000",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0,styles:{width:"100%"}}],pattern:/jdbc:db2:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:db2://{host}:{port}/{database}"},ssh:ca,extendInfo:[],type:d.DatabaseTypeCode.DB2},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0,styles:{width:"100%"}},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"8080",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0,styles:{width:"100%"}},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0,styles:{width:"100%"}}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1,styles:{width:"100%"}},{defaultValue:"jdbc:presto://localhost:8080",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0,styles:{width:"100%"}}],pattern:/jdbc:presto:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:presto://{host}:{port}/{database}"},ssh:ca,extendInfo:[],type:d.DatabaseTypeCode.PRESTO},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0,styles:{width:"100%"}},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"2883",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0,styles:{width:"100%"}},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0,styles:{width:"100%"}}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1,styles:{width:"100%"}},{defaultValue:"jdbc:oceanbase://localhost:2883",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0,styles:{width:"100%"}}],pattern:/jdbc:oceanbase:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:oceanbase://{host}:{port}/{database}"},ssh:ca,extendInfo:[],type:d.DatabaseTypeCode.OCEANBASE},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0,styles:{width:"100%"}},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"6379",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0,styles:{width:"100%"}},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0,styles:{width:"100%"}}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1,styles:{width:"100%"}},{defaultValue:"jdbc:redis://localhost:6379",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0,styles:{width:"100%"}}],pattern:/jdbc:redis:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:redis://{host}:{port}/{database}"},ssh:ca,extendInfo:[],type:d.DatabaseTypeCode.REDIS},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0,styles:{width:"100%"}},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"10000",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0,styles:{width:"100%"}},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0,styles:{width:"100%"}}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1,styles:{width:"100%"}},{defaultValue:"jdbc:hive2://localhost:10000",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0,styles:{width:"100%"}}],pattern:/jdbc:hive2:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:hive2://{host}:{port}/{database}"},ssh:ca,extendInfo:[],type:d.DatabaseTypeCode.HIVE},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0,styles:{width:"100%"}},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"54321",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0,styles:{width:"100%"}},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0,styles:{width:"100%"}}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1,styles:{width:"100%"}},{defaultValue:"jdbc:kingbase8://127.0.0.1:54321",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0,styles:{width:"100%"}}],pattern:/jdbc:kingbase8:\/\/(.*):(\d+)(\/(\w+))?/,template:"jdbc:kingbase8://{host}:{port}/{database}"},ssh:ca,extendInfo:[],type:d.DatabaseTypeCode.KINGBASE},{baseInfo:{items:[{defaultValue:"@localhost",inputType:H.INPUT,labelNameCN:"\u540D\u79F0",labelNameEN:"Name",name:"alias",required:!0,styles:{width:"100%"}},da,{defaultValue:"localhost",inputType:H.INPUT,labelNameCN:"\u4E3B\u673A",labelNameEN:"Host",name:"host",required:!0,styles:{width:"70%"}},{defaultValue:"27017",inputType:H.INPUT,labelNameCN:"\u7AEF\u53E3",labelNameEN:"Port",name:"port",labelTextAlign:"right",required:!0,styles:{width:"30%",labelWidthEN:"40px",labelWidthCN:"40px",labelAlign:"right"}},{defaultValue:Se.USERANDPASSWORD,inputType:H.SELECT,labelNameCN:"\u8EAB\u4EFD\u9A8C\u8BC1",labelNameEN:"Authentication",name:"authenticationType",required:!0,selects:[{items:[{defaultValue:"root",inputType:H.INPUT,labelNameCN:"\u7528\u6237\u540D",labelNameEN:"User",name:"user",required:!0,styles:{width:"100%"}},{defaultValue:"",inputType:H.PASSWORD,labelNameCN:"\u5BC6\u7801",labelNameEN:"Password",name:"password",required:!0,styles:{width:"100%"}}],label:"User&Password",value:Se.USERANDPASSWORD},{label:"NONE",value:Se.NONE,items:[]}],styles:{width:"50%"}},{defaultValue:"",inputType:H.INPUT,labelNameCN:"\u6570\u636E\u5E93",labelNameEN:"Database",name:"database",required:!1,styles:{width:"100%"}},{defaultValue:"mongodb://localhost:27017",inputType:H.INPUT,labelNameCN:"URL",labelNameEN:"URL",name:"url",required:!0,styles:{width:"100%"}}],pattern:/mongodb:\/\/(.*):(\d+)(\/(\w+))?/,template:"mongodb://{host}:{port}/{database}",excludes:[d.OperationColumn.ViewDDL,d.OperationColumn.CreateTable,d.OperationColumn.EditTable]},ssh:ca,extendInfo:[],type:d.DatabaseTypeCode.MONGODB}],Lr=function(a){var t,r,o=a.treeNodeData;$a({name:o.name,operationType:d.WorkspaceTabType.VIEW,dataSourceId:o.extraParams.dataSourceId,dataSourceName:o.extraParams.dataSourceName,databaseType:o.extraParams.databaseType,databaseName:(t=o.extraParams)===null||t===void 0?void 0:t.databaseName,schemaName:(r=o.extraParams)===null||r===void 0?void 0:r.schemaName,loadSQL:function(){return new Promise(function(u){var c;ye.Z.getViewDetail({dataSourceId:o.extraParams.dataSourceId,databaseType:o.extraParams.databaseType,databaseName:o.extraParams.databaseName,schemaName:(c=o.extraParams)===null||c===void 0?void 0:c.schemaName,tableName:o.name}).then(function(m){u(m.ddl)})})}})},Rr=function(a){var t,r,o=a.treeNodeData;$a({name:o.name,operationType:d.WorkspaceTabType.FUNCTION,dataSourceId:o.extraParams.dataSourceId,dataSourceName:o.extraParams.dataSourceName,databaseType:o.extraParams.databaseType,databaseName:(t=o.extraParams)===null||t===void 0?void 0:t.databaseName,schemaName:(r=o.extraParams)===null||r===void 0?void 0:r.schemaName,loadSQL:function(){return new Promise(function(u){var c;ye.Z.getFunctionDetail({dataSourceId:o.extraParams.dataSourceId,databaseType:o.extraParams.databaseType,databaseName:o.extraParams.databaseName,schemaName:(c=o.extraParams)===null||c===void 0?void 0:c.schemaName,functionName:o.name}).then(function(m){u(m.functionBody)})})}})},Pr=function(a){var t,r,o=a.treeNodeData;$a({name:o.name,operationType:d.WorkspaceTabType.PROCEDURE,dataSourceId:o.extraParams.dataSourceId,dataSourceName:o.extraParams.dataSourceName,databaseType:o.extraParams.databaseType,databaseName:(t=o.extraParams)===null||t===void 0?void 0:t.databaseName,schemaName:(r=o.extraParams)===null||r===void 0?void 0:r.schemaName,loadSQL:function(){return new Promise(function(u){var c;ye.Z.getProcedureDetail({dataSourceId:o.extraParams.dataSourceId,databaseType:o.extraParams.databaseType,databaseName:o.extraParams.databaseName,schemaName:(c=o.extraParams)===null||c===void 0?void 0:c.schemaName,procedureName:o.name}).then(function(m){u(m.procedureBody)})})}})},Ar=function(a){var t,r,o=a.treeNodeData;$a({name:o.name,operationType:d.WorkspaceTabType.TRIGGER,dataSourceId:o.extraParams.dataSourceId,dataSourceName:o.extraParams.dataSourceName,databaseType:o.extraParams.databaseType,databaseName:(t=o.extraParams)===null||t===void 0?void 0:t.databaseName,schemaName:(r=o.extraParams)===null||r===void 0?void 0:r.schemaName,loadSQL:function(){return new Promise(function(u){var c;ye.Z.getTriggerDetail({dataSourceId:o.extraParams.dataSourceId,databaseType:o.extraParams.databaseType,databaseName:o.extraParams.databaseName,schemaName:(c=o.extraParams)===null||c===void 0?void 0:c.schemaName,triggerName:o.name}).then(function(m){u(m.triggerBody)})})}})},Or=function(a){var t=a.treeNodeData,r=a.loadData,o=t.pinned?"deleteTablePin":"addTablePin";ye.Z[o]({dataSourceId:t.extraParams.dataSourceId,databaseName:t.extraParams.databaseName,schemaName:t.extraParams.schemaName,tableName:t.name}).then(function(){r({refresh:!0})})},Ml={monacoEditorBox:"monacoEditorBox___EGtJZ"},Jt=K(93181),jr=K(39825);function Zl(n,a){var t=(0,l.useRef)(!0);(0,l.useEffect)(function(){t.current?t.current=!1:n()},a)}var Bl=K(88541);function Rd(n){var a=n.url,t=useMemo(function(){return uuidv4()},[]),r=useState(""),o=_slicedToArray(r,2),i=o[0],u=o[1];useEffect(function(){c()},[]);var c=function(){var f=new EventSourcePolyfill(a,{headers:{uid:t}});f.onmessage=function(b){u(b.data);var E=b.data==="[DONE]";E&&f.close()},f.onerror=function(b){console.error("EventSourcePolyfill error:",b)}};return i}var Pd=null,we=K(49900),Ul={fontFamily:`"Menlo", 
    "DejaVu Sans Mono", 
    "Liberation Mono", 
    "Consolas", 
    "Ubuntu Mono", 
    "Courier New", 
    "andale mono", 
    "lucida console", 
    "monospace"`,scrollBeyondLastLine:!1,automaticLayout:!0,dragAndDrop:!1,fontSize:12,tabSize:2,lineHeight:18,theme:"vscode",roundedSelection:!1,readOnly:!1,folding:!1,insertSpaces:!0,autoClosingQuotes:"always",detectIndentation:!1,wordWrap:"on",fixedOverflowWidgets:!0,codeLens:!1,scrollbar:{alwaysConsumeMouseWheel:!1},unicodeHighlight:{ambiguousCharacters:!1,invisibleCharacters:!1},minimap:{enabled:!1}},Fl=K(41157),Vl={editorContainer:"editorContainer___GZvvD"},Wl=Object.keys(d.DatabaseTypeCode).map(function(n){return{type:n,id:n,label:n}});function Hl(n,a){var t=n.id,r=n.className,o=n.language,i=o===void 0?"sql":o,u=n.didMount,c=n.options,m=n.defaultValue,f=n.appendValue,b=n.shortcutKey,E=(0,l.useRef)(),O=(0,l.useRef)(),T=(0,jr.F)(),x=j()(T,1),_=x[0],N=l.useState(!1),C=j()(N,2),p=C[0],v=C[1];(0,l.useEffect)(function(){var I=we.editor.create(document.getElementById("monaco-editor-".concat(t)),h()(h()(h()({},Ul),c),{},{value:m||"",language:i,theme:_.backgroundColor}));return E.current=I,u&&u(I),O.current=I.addCommand(0,function(L,P){var w=L.get(Fl.eJ);P(w)}),we.editor.defineTheme(d.EditorThemeType.DashboardLightTheme,{base:"vs",inherit:!0,rules:[{background:"#15161a"}],colors:{"editor.foreground":"#000000","editor.background":"#f8f9fa"}}),we.editor.defineTheme(d.EditorThemeType.DashboardBlackTheme,{base:"vs-dark",inherit:!0,rules:[{background:"#15161a"}],colors:{"editor.foreground":"#ffffff","editor.background":"#131418"}}),M(I),function(){n.needDestroy&&E.current&&E.current.dispose()}},[]),(0,l.useEffect)(function(){var I,L,P=function(){v(!0),n.focusChange&&n.focusChange(!0)},w=function(){v(!1),n.focusChange&&n.focusChange(!1)};(I=E.current)===null||I===void 0||I.onDidFocusEditorText(P),(L=E.current)===null||L===void 0||L.onDidBlurEditorText(w)},[]),(0,l.useEffect)(function(){E.current&&(b==null||b(E.current,we,p))},[E.current,p]),(0,l.useEffect)(function(){var I=function(){var P;(P=E.current)===null||P===void 0||P.layout()};return window.addEventListener("resize",I),function(){window.removeEventListener("resize",I)}},[]),(0,l.useEffect)(function(){c!=null&&c.theme&&we.editor.setTheme(c.theme)},[c==null?void 0:c.theme]),(0,l.useImperativeHandle)(a,function(){return{getCurrentSelectContent:D,getAllContent:S,setValue:k}}),(0,l.useEffect)(function(){f&&kr(E.current,f==null?void 0:f.text,f==null?void 0:f.range)},[f]);var k=function(L,P){kr(E.current,L,P)},D=function(){var L,P=(L=E.current)===null||L===void 0?void 0:L.getSelection();if(!P||P.isEmpty())return"";var w,Z=(w=E.current)===null||w===void 0||(w=w.getModel())===null||w===void 0?void 0:w.getValueInRange(P);return Z||""},S=function(){var L,P=(L=E.current)===null||L===void 0?void 0:L.getModel(),w=P==null?void 0:P.getValue();return w||""},M=function(L){L.createContextKey("shouldShowSqlRunnerAction",!0),!(!n.addAction||!n.addAction.length)&&n.addAction.forEach(function(P){var w=P.id,Z=P.label,B=P.action;L.addAction({id:w,label:Z,precondition:"shouldShowSqlRunnerAction",contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(g){var A,V=((A=L.getModel())===null||A===void 0?void 0:A.getValueInRange(L.getSelection()))||"";w==="changeSQL"?g.trigger("",O.current,function(U){U.pick(Wl).then(function(Q){B(V,Q==null?void 0:Q.label)})}):B(V)}})})};return(0,e.jsx)("div",{ref:a,id:"monaco-editor-".concat(t),className:$()(r,Vl.editorContainer)})}var kr=function(a,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"end";if(a){var o=(a==null?void 0:a.getModel)&&a.getModel(a),i=r;if(r==="reset"){a.setValue(t||"");return}var u=t,c=a.getModel().getLineCount(),m=a.getModel().getLineMaxColumn(c);switch(r){case"cover":i=o.getFullModelRange(),a.revealLine(c);break;case"front":i=new we.Range(1,1,1,1),a.revealLine(1),a.setPosition({lineNumber:1,column:1});break;case"select":{var f=a.getSelection();f&&(i=new we.Range(f.startLineNumber,f.startColumn,f.endLineNumber,f.endColumn));break}case"end":i=new we.Range(c,m,c,m),u="".concat(t);break;case"cursor":{var b=a.getPosition();b&&(i=new we.Range(b.lineNumber,b.column,b.lineNumber,b.column))}break;default:break}var E={range:i,text:u},O=[{}];a.executeEdits("setValue",[E],O);var T=a.getModel().getLineCount();r==="end"&&setTimeout(function(){a.revealLine(T+1)},0)}},gt=(0,l.forwardRef)(Hl),wr=function(a){var t=function(){return new Promise(function(o){ye.Z.exportCreateTableSql({dataSourceId:a.extraParams.dataSourceId,databaseName:a.extraParams.databaseName,schemaName:a.extraParams.schemaName,tableName:a.name}).then(function(i){o(i)})})};(0,Jt.h7)({title:"DDL-".concat(a.name),width:"60%",height:"60%",footer:!1,content:(0,e.jsx)("div",{className:Ml.monacoEditorBox,children:(0,e.jsx)(Gl,{getSql:t})})})},Gl=function(a){var t=a.getSql,r=l.useRef();return t().then(function(o){r.current.setValue(o)}),(0,e.jsx)(gt,{id:(0,Ce.Z)(),ref:r})},hn=K(84567),Oe=K(15867),bn={deleteTableFooter:"deleteTableFooter___Iv3A8",checkContainer:"checkContainer___xM5kb",deleteModalContent:"deleteModalContent___Vwe7k"},Mr=function(a,t){(0,Jt.h7)({width:"450px",content:(0,e.jsx)(ql,{treeNodeData:a,loadData:t,openModal:Jt.h7})})},ql=function(a){var t=a.treeNodeData,r=a.loadData,o=(0,l.useState)(!1),i=j()(o,2),u=i[0],c=i[1],m=function(){var b={dataSourceId:t.extraParams.dataSourceId,databaseName:t.extraParams.databaseName,schemaName:t.extraParams.schemaName,tableName:t.name};ye.Z.deleteTable(b).then(function(){r({refresh:!0,treeNodeData:t.parentNode}),(0,Jt.h7)(!1)})};return(0,e.jsxs)("div",{className:bn.deleteModalContent,children:[(0,e.jsx)("div",{className:bn.title,children:(0,s.ZP)("workspace.tree.delete.table.tip",'"'.concat(t.name,'"'))}),(0,e.jsx)("div",{className:bn.checkContainer,children:(0,e.jsx)(hn.Z,{value:u,onChange:function(b){c(b.target.checked)},children:(0,s.ZP)("workspace.tree.delete.tip")})}),(0,e.jsxs)("div",{className:bn.deleteTableFooter,children:[(0,e.jsx)(Oe.ZP,{type:"primary",onClick:function(){(0,Jt.h7)(!1)},children:(0,s.ZP)("common.button.cancel")}),(0,e.jsx)(Oe.ZP,{disabled:!u,onClick:m,children:(0,s.ZP)("common.button.affirm")})]})]})},ma=K(40169);function Kl(n){var a=[];return n.databases?a=((n==null?void 0:n.databases)||[]).map(function(t){var r=[];return t.schemas&&(r=t.schemas.map(function(o){return{value:o.name,label:o.name,type:"schema",isLeaf:!0}})),{value:t.name,label:t.name,type:"database",children:r,isLeaf:r.length===0}}):n!=null&&n.schemas&&(a=((n==null?void 0:n.schemas)||[]).map(function(t){return{value:t.name,label:t.name,type:"schema",isLeaf:!0}})),a}function lr(n,a){return[ma.Z.ORACLE,ma.Z.SQLITE,ma.Z.POSTGRESQL,ma.Z.H2,ma.Z.DB2,ma.Z.KINGBASE,ma.Z.DM].includes(a)?'"'.concat(n,'"'):[ma.Z.SQLSERVER].includes(a)?"[".concat(n,"]"):[ma.Z.MYSQL,ma.Z.CLICKHOUSE,ma.Z.MARIADB].includes(a)?"`".concat(n,"`"):"".concat(n)}var zl=function(a){var t=a.treeNodeData,r=a.loadData,o=Re(function(f){return{openCreateDatabaseModal:f.openCreateDatabaseModal,currentConnectionDetails:f.currentConnectionDetails}}),i=o.openCreateDatabaseModal,u=o.currentConnectionDetails,c=function(b){var E={databaseType:t.extraParams.databaseType,dataSourceId:t.extraParams.dataSourceId,databaseName:t.name};i==null||i({type:b,relyOnParams:E,executedCallback:function(){r({refresh:!0})}})},m=(0,l.useMemo)(function(){var f,b=_n[t.treeNodeType],E=b.operationColumn,O=pn.find(function(N){var C;return N.type===((C=t.extraParams)===null||C===void 0?void 0:C.databaseType)});function T(){var N=O.baseInfo.excludes,C=[];return E==null||E.map(function(p){var v=!1;N==null||N.map(function(k){p===k&&(v=!0)}),v||C.push(p)}),C}var x=(f={},W()(f,d.OperationColumn.Refresh,{text:(0,s.ZP)("common.button.refresh"),icon:"\uEC08",handle:function(){r==null||r({refresh:!0})}}),W()(f,d.OperationColumn.CreateConsole,{text:(0,s.ZP)("workspace.menu.queryConsole"),icon:"\uE619",handle:function(){var C,p;$a({dataSourceId:t.extraParams.dataSourceId,dataSourceName:t.extraParams.dataSourceName,databaseType:t.extraParams.databaseType,databaseName:(C=t.extraParams)===null||C===void 0?void 0:C.databaseName,schemaName:(p=t.extraParams)===null||p===void 0?void 0:p.schemaName})}}),W()(f,d.OperationColumn.ViewAllTable,{text:(0,s.ZP)("workspace.menu.viewAllTable"),icon:"\uE611",handle:function(){var C,p;ia({id:(0,Ce.Z)(),type:d.WorkspaceTabType.ViewAllTable,title:"".concat(t.extraParams.databaseName,"-tables"),uniqueData:{dataSourceId:t.extraParams.dataSourceId,dataSourceName:t.extraParams.dataSourceName,databaseType:t.extraParams.databaseType,databaseName:(C=t.extraParams)===null||C===void 0?void 0:C.databaseName,schemaName:(p=t.extraParams)===null||p===void 0?void 0:p.schemaName}})}}),W()(f,d.OperationColumn.CreateTable,{text:(0,s.ZP)("editTable.button.createTable"),icon:"\uE792",handle:function(){var C,p;ia({id:(0,Ce.Z)(),title:(0,s.ZP)("editTable.button.createTable"),type:d.WorkspaceTabType.CreateTable,uniqueData:{dataSourceId:t.extraParams.dataSourceId,databaseType:t.extraParams.databaseType,databaseName:(C=t.extraParams)===null||C===void 0?void 0:C.databaseName,schemaName:(p=t.extraParams)===null||p===void 0?void 0:p.schemaName,submitCallback:function(){r==null||r({refresh:!0})}}})},discard:t.treeNodeType===d.TreeNodeType.DATABASE&&(u==null?void 0:u.supportSchema)}),W()(f,d.OperationColumn.DeleteTable,{text:(0,s.ZP)("workspace.menu.deleteTable"),icon:"\uE6A7",handle:function(){Mr(t,r)}}),W()(f,d.OperationColumn.ViewDDL,{text:(0,s.ZP)("workspace.menu.ViewDDL"),icon:"\uE665",handle:function(){wr(t)}}),W()(f,d.OperationColumn.Pin,{text:t.pinned?(0,s.ZP)("workspace.menu.unPin"):(0,s.ZP)("workspace.menu.pin"),icon:t.pinned?"\uE61D":"\uE627",handle:function(){Or({treeNodeData:t,loadData:function(){r({treeNodeData:t.parentNode})}})}}),W()(f,d.OperationColumn.EditTable,{text:(0,s.ZP)("workspace.menu.editTable"),icon:"\uE602",handle:function(){var C,p;ia({id:"".concat(d.OperationColumn.EditTable,"-").concat(t.uuid),title:t==null?void 0:t.name,type:d.WorkspaceTabType.EditTable,uniqueData:{dataSourceId:t.extraParams.dataSourceId,databaseType:t.extraParams.databaseType,databaseName:(C=t.extraParams)===null||C===void 0?void 0:C.databaseName,schemaName:(p=t.extraParams)===null||p===void 0?void 0:p.schemaName,tableName:t==null?void 0:t.name,submitCallback:function(){r({treeNodeData:t.parentNode,refresh:!0})}}})}}),W()(f,d.OperationColumn.CopyName,{text:(0,s.ZP)("common.button.copyName"),icon:"\uEC7A",handle:function(){navigator.clipboard.writeText(t.name)}}),W()(f,d.OperationColumn.OpenTable,{text:(0,s.ZP)("workspace.menu.openTable"),icon:"\uE618",doubleClickTrigger:!0,handle:function(){var C,p,v=lr(t.name,t.extraParams.databaseType);ia({id:"".concat(d.OperationColumn.OpenTable,"-").concat(t.uuid),title:t.name,type:d.WorkspaceTabType.EditTableData,uniqueData:{dataSourceId:t.extraParams.dataSourceId,databaseType:t.extraParams.databaseType,databaseName:(C=t.extraParams)===null||C===void 0?void 0:C.databaseName,schemaName:(p=t.extraParams)===null||p===void 0?void 0:p.schemaName,tableName:t.name,sql:"select * from "+v}})}}),W()(f,d.OperationColumn.OpenView,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Lr({addWorkspaceTab:ia,treeNodeData:t})}}),W()(f,d.OperationColumn.OpenFunction,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Rr({addWorkspaceTab:ia,treeNodeData:t})}}),W()(f,d.OperationColumn.OpenProcedure,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Pr({addWorkspaceTab:ia,treeNodeData:t})}}),W()(f,d.OperationColumn.OpenTrigger,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Ar({addWorkspaceTab:ia,treeNodeData:t})}}),W()(f,d.OperationColumn.CreateDatabase,{text:(0,s.ZP)("workspace.menu.createDatabase"),icon:"\uE816",handle:function(){c("database")}}),W()(f,d.OperationColumn.CreateSchema,{text:(0,s.ZP)("workspace.menu.createSchema"),icon:"\uE696",handle:function(){c("schema")},discard:!(u!=null&&u.supportSchema)}),f),_=[];return T().forEach(function(N,C){var p=x[N];p.discard||_.push({key:C,onClick:p==null?void 0:p.handle,type:N,doubleClickTrigger:p.doubleClickTrigger,labelProps:{icon:p==null?void 0:p.icon,label:p==null?void 0:p.text}})}),_},[t]);return m},Yl=function(a){var t,r=a.treeNodeData,o=a.loadData,i=Re.getState().openCreateDatabaseModal,u=Re.getState().currentConnectionDetails,c=function(_){var N={databaseType:r.extraParams.databaseType,dataSourceId:r.extraParams.dataSourceId,databaseName:r.name};i==null||i({type:_,relyOnParams:N,executedCallback:function(){o({refresh:!0})}})},m=_n[r.treeNodeType],f=m.operationColumn,b=pn.find(function(x){var _;return x.type===((_=r.extraParams)===null||_===void 0?void 0:_.databaseType)});function E(){var x=b.baseInfo.excludes,_=[];return f==null||f.map(function(N){var C=!1;x==null||x.map(function(p){N===p&&(C=!0)}),C||_.push(N)}),_}var O=(t={},W()(t,d.OperationColumn.Refresh,{text:(0,s.ZP)("common.button.refresh"),icon:"\uEC08",handle:function(){o==null||o({refresh:!0})}}),W()(t,d.OperationColumn.CreateConsole,{text:(0,s.ZP)("workspace.menu.queryConsole"),icon:"\uE619",handle:function(){var _,N;$a({dataSourceId:r.extraParams.dataSourceId,dataSourceName:r.extraParams.dataSourceName,databaseType:r.extraParams.databaseType,databaseName:(_=r.extraParams)===null||_===void 0?void 0:_.databaseName,schemaName:(N=r.extraParams)===null||N===void 0?void 0:N.schemaName})}}),W()(t,d.OperationColumn.ViewAllTable,{text:(0,s.ZP)("workspace.menu.viewAllTable"),icon:"\uE611",handle:function(){var _,N;ia({id:(0,Ce.Z)(),type:d.WorkspaceTabType.ViewAllTable,title:"".concat(r.extraParams.databaseName,"-tables"),uniqueData:{dataSourceId:r.extraParams.dataSourceId,dataSourceName:r.extraParams.dataSourceName,databaseType:r.extraParams.databaseType,databaseName:(_=r.extraParams)===null||_===void 0?void 0:_.databaseName,schemaName:(N=r.extraParams)===null||N===void 0?void 0:N.schemaName}})}}),W()(t,d.OperationColumn.CreateTable,{text:(0,s.ZP)("editTable.button.createTable"),icon:"\uE792",handle:function(){var _,N;ia({id:(0,Ce.Z)(),title:(0,s.ZP)("editTable.button.createTable"),type:d.WorkspaceTabType.CreateTable,uniqueData:{dataSourceId:r.extraParams.dataSourceId,databaseType:r.extraParams.databaseType,databaseName:(_=r.extraParams)===null||_===void 0?void 0:_.databaseName,schemaName:(N=r.extraParams)===null||N===void 0?void 0:N.schemaName,submitCallback:function(){var p;(p=r.loadData)===null||p===void 0||p.call(r,{refresh:!0})}}})},discard:r.treeNodeType===d.TreeNodeType.DATABASE&&(u==null?void 0:u.supportSchema)}),W()(t,d.OperationColumn.DeleteTable,{text:(0,s.ZP)("workspace.menu.deleteTable"),icon:"\uE6A7",handle:function(){Mr(r)}}),W()(t,d.OperationColumn.ViewDDL,{text:(0,s.ZP)("workspace.menu.ViewDDL"),icon:"\uE665",handle:function(){wr(r)}}),W()(t,d.OperationColumn.Pin,{text:r.pinned?(0,s.ZP)("workspace.menu.unPin"):(0,s.ZP)("workspace.menu.pin"),icon:r.pinned?"\uE61D":"\uE627",handle:function(){Or({treeNodeData:r,loadData:r.parentNode.loadData})}}),W()(t,d.OperationColumn.EditTable,{text:(0,s.ZP)("workspace.menu.editTable"),icon:"\uE602",handle:function(){var _,N;ia({id:"".concat(d.OperationColumn.EditTable,"-").concat(r.uuid),title:r==null?void 0:r.name,type:d.WorkspaceTabType.EditTable,uniqueData:{dataSourceId:r.extraParams.dataSourceId,databaseType:r.extraParams.databaseType,databaseName:(_=r.extraParams)===null||_===void 0?void 0:_.databaseName,schemaName:(N=r.extraParams)===null||N===void 0?void 0:N.schemaName,tableName:r==null?void 0:r.name,submitCallback:function(){var p,v;(p=r.parentNode)===null||p===void 0||(v=p.loadData)===null||v===void 0||v.call(p,{refresh:!0})}}})}}),W()(t,d.OperationColumn.CopyName,{text:(0,s.ZP)("common.button.copyName"),icon:"\uEC7A",handle:function(){navigator.clipboard.writeText(r.name)}}),W()(t,d.OperationColumn.OpenTable,{text:(0,s.ZP)("workspace.menu.openTable"),icon:"\uE618",doubleClickTrigger:!0,handle:function(){var _,N,C=lr(r.name,r.extraParams.databaseType);ia({id:"".concat(d.OperationColumn.OpenTable,"-").concat(r.uuid),title:r.name,type:d.WorkspaceTabType.EditTableData,uniqueData:{dataSourceId:r.extraParams.dataSourceId,databaseType:r.extraParams.databaseType,databaseName:(_=r.extraParams)===null||_===void 0?void 0:_.databaseName,schemaName:(N=r.extraParams)===null||N===void 0?void 0:N.schemaName,tableName:r.name,sql:"select * from "+C}})}}),W()(t,d.OperationColumn.OpenView,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Lr({addWorkspaceTab:ia,treeNodeData:r})}}),W()(t,d.OperationColumn.OpenFunction,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Rr({addWorkspaceTab:ia,treeNodeData:r})}}),W()(t,d.OperationColumn.OpenProcedure,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Pr({addWorkspaceTab:ia,treeNodeData:r})}}),W()(t,d.OperationColumn.OpenTrigger,{text:(0,s.ZP)("workspace.menu.view"),icon:"\uE651",doubleClickTrigger:!0,handle:function(){Ar({addWorkspaceTab:ia,treeNodeData:r})}}),W()(t,d.OperationColumn.CreateDatabase,{text:(0,s.ZP)("workspace.menu.createDatabase"),icon:"\uE816",handle:function(){c("database")}}),W()(t,d.OperationColumn.CreateSchema,{text:(0,s.ZP)("workspace.menu.createSchema"),icon:"\uE696",handle:function(){c("schema")},discard:!(u!=null&&u.supportSchema)}),t),T=[];return E().forEach(function(x,_){var N=O[x];N.discard||T.push({key:_,onClick:N==null?void 0:N.handle,type:x,doubleClickTrigger:N.doubleClickTrigger,labelProps:{icon:N==null?void 0:N.icon,label:N==null?void 0:N.text}})}),T},Xt={"f-icon-button":"f-icon-button___patno","f-fill-absolute":"f-fill-absolute___rU8ls","f-button":"f-button___QsohD","f-doc-en-break":"f-doc-en-break___pXj0Z",menuLabel:"menuLabel___gNQKr",menuLabelIconBox:"menuLabelIconBox___BL9hI",menuLabelIconBright:"menuLabelIconBright___Nu_hE","loading-animation":"loading-animation___Y9muQ"},ba=(0,l.memo)(function(n){var a=n.className,t=n.icon,r=n.label,o=n.iconBright;return(0,e.jsxs)("div",{className:$()(Xt.menuLabel,a),children:[(0,e.jsx)("div",{className:Xt.menuLabelIconBox,children:t&&(0,e.jsx)(X.Z,{className:$()(Xt.menuLabelIcon,W()({},Xt.menuLabelIconBright,o)),code:t})}),(0,e.jsx)("div",{className:Xt.menuLabelTitle,children:r})]})}),Ql=K(13769),ir=K.n(Ql),Zr={loadingContent:"loadingContent___mjNCO",stateIndicator:"stateIndicator___JC29N",empty:"empty___jzfQL",coverLoading:"coverLoading___olCx_"},dt={"f-icon-button":"f-icon-button___wDkMs","f-fill-absolute":"f-fill-absolute___HRlv8","f-button":"f-button___tznen","f-doc-en-break":"f-doc-en-break___Fejkq",box:"box___kEY3U",empty:"empty___YeF_H",errorBox:"errorBox___Oht7F",error:"error___wh3mR",errorText:"errorText___jUoAH",successBox:"successBox___lqWPE",successText:"successText___ffF1G","loading-animation":"loading-animation___Q49K5"},mt=K(75081),Ad={LOADING:"loading",EMPTY:"empty",ERROR:"error",SUCCESS:"success"},Od={loading:{icon:"\uE6CD;"},empty:{icon:"\uE760"},error:{icon:"\uE755"},success:{icon:"\uE62E"}},$l=function(a){var t=a.className,r=a.state,o=a.text,i=a.image,u=i===void 0?!1:i,c=function(){switch(r){case"loading":return(0,e.jsx)(mt.Z,{});case"error":return(0,e.jsxs)("div",{className:dt.errorBox,children:[u&&(0,e.jsx)("div",{className:$()(t,dt[r])}),(0,e.jsx)("div",{className:dt.errorText,children:o})]});case"success":return(0,e.jsxs)("div",{className:dt.successBox,children:[u&&(0,e.jsx)("div",{className:$()(t,dt[r])}),(0,e.jsx)("div",{className:dt.successText,children:o})]});default:return(0,e.jsx)("div",{className:$()(t,dt[r])})}};return(0,e.jsx)("div",{className:$()(t,dt.box),children:c()})},en=(0,l.memo)($l),Jl=["children","className","data","handleEmpty","empty","isLoading","coverLoading"];function Nn(n){var a=n.children,t=n.className,r=n.data,o=r===void 0?!0:r,i=n.handleEmpty,u=i===void 0?!1:i,c=n.empty,m=n.isLoading,f=n.coverLoading,b=ir()(n,Jl),E=!m&&u&&!(o!=null&&o.length),O=function(){return(m||!o)&&!f?(0,e.jsx)(en,{state:"loading"}):E?c||(0,e.jsx)(en,{state:"empty"}):(0,e.jsxs)(e.Fragment,{children:[a,(m||!o)&&f&&(0,e.jsx)("div",{className:Zr.coverLoading,children:(0,e.jsx)(en,{state:"loading"})})]})};return(0,e.jsx)("div",{className:$()(Zr.loadingContent,t),children:O()})}var Bt=K(96486),Ye=K.n(Bt),Br=(0,l.createContext)({}),Ur=function n(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return a.forEach(function(o){r&&(o.parentNode=r,o.level=(r.level||0)+1),t.push(o),o.children&&n(o.children,t,o)}),t};function Fr(n,a){var t=[];return n.forEach(function(r){var o;if(((o=r.parentNode)===null||o===void 0?void 0:o.uuid)===a){t.push(r);var i=Fr(n,r.uuid);i.length&&(r.children=i)}}),t}var Vr=function(a,t){var r=new RegExp(t,"i");return r.test(a||"")};function Xl(n,a){var t=[];function r(i){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(Vr(i.name,a)){t=[].concat(_e()(t),_e()(u),[i]);return}i.children&&i.children.forEach(function(c){r(c,[].concat(_e()(u),[i]))})}n.forEach(function(i){return r(i)});var o=[];return t.forEach(function(i){Vr(i.name,a)||(i.children=null),o.findIndex(function(u){return u.uuid===i.uuid})===-1&&o.push(i)}),Fr(o,void 0)}var Wr=26,ei=2,ai=function(a){var t,r=a.className,o=a.treeData,i=a.searchValue,u=(0,l.useState)(null),c=j()(u,2),m=c[0],f=c[1],b=(0,l.useState)([]),E=j()(b,2),O=E[0],T=E[1],x=(0,l.useState)(null),_=j()(x,2),N=_[0],C=_[1],p=(0,l.useState)(null),v=j()(p,2),k=v[0],D=v[1],S=(0,l.useState)(0),M=j()(S,2),I=M[0],L=M[1],P=(0,l.useMemo)(function(){var B=Math.floor(I/Wr);return B=Math.max(B-ei,0),B},[I]),w=Wr*P;(0,l.useEffect)(function(){return function(){wl()}},[i]),(0,l.useEffect)(function(){f(o),L(0)},[o]),(0,l.useEffect)(function(){if(m){var B=[];Ur(m,B),T(B)}else T([])},[m]),(0,l.useEffect)(function(){if(N){var B=[];Ur(N,B),D(B)}else D(null)},[N]);var Z=(0,l.useMemo)(function(){var B=(k||O).slice(P,P+50);return B.map(function(R){return(0,e.jsx)(ti,{level:R.level||0,data:R},R.uuid)})},[O,k,P]);return(0,l.useEffect)(function(){if(i&&m){var B=Xl((0,Bt.cloneDeep)(m),i);C(B),L(0)}else C(null)},[i]),(0,e.jsx)(Nn,{isLoading:!m,className:$()(r),children:(0,e.jsx)(Br.Provider,{value:{treeData:m,setTreeData:f,searchTreeData:N,setSearchTreeData:C},children:(0,e.jsx)("div",{className:$()(ua.scrollBox),onScroll:function(R){L(R.target.scrollTop)},children:(0,e.jsxs)("div",{className:ua.treeListHolder,style:{"--tree-node-count":(t=k||O)===null||t===void 0?void 0:t.length},children:[(0,e.jsx)("div",{style:{height:w}}),Z]})})})})},ti=(0,l.memo)(function(n){var a=n.data,t=n.level,r=(0,l.useState)(!1),o=j()(r,2),i=o[0],u=o[1],c=new Array(t).fill("indent"),m=(0,l.useContext)(Br),f=m.treeData,b=m.setTreeData,E=m.searchTreeData,O=m.setSearchTreeData;function T(S){var M,I=(S==null?void 0:S.treeNodeData)||n.data,L=_n[I.pretendNodeType||I.treeNodeType];u(!0),((S==null?void 0:S.pageNo)===1||!(S!=null&&S.pageNo))&&(_(f,I.uuid,null,[f,b]),E&&_(E,I.uuid,null,[E,O])),(M=L.getChildren)===null||M===void 0||M.call(L,h()(h()({},I.extraParams),{},{extraParams:h()({},I.extraParams),refresh:(S==null?void 0:S.refresh)||!1,pageNo:(S==null?void 0:S.pageNo)||1})).then(function(P){P.length||P.data?(P.data?(_(f,I.uuid,P.data,[f,b]),E&&_(E,I.uuid,P.data,[E,O]),P.hasNextPage&&T({refresh:(S==null?void 0:S.refresh)||!1,pageNo:P.pageNo+1})):(_(f,I.uuid,P,[f,b]),E&&_(E,I.uuid,P,[E,O])),u(!1)):L.next?(I.pretendNodeType=L.next,T()):(_(f,I.uuid,[],[f,b]),E&&_(E,I.uuid,[],[E,O]),u(!1))}).catch(function(){u(!1)})}var x=$t(function(S){return S.focusId})===a.uuid,_=function S(M,I,L,P){for(var w=j()(P,2),Z=w[0],B=w[1],R=null,g=0;g<(M==null?void 0:M.length);g++)if(M[g].uuid===I){R=M[g],L?(L.map(function(A){A.parentNode=R}),R.children=[].concat(_e()(R.children||[]),_e()(L||[]))):R.children=null,B==null||B((0,Bt.cloneDeep)(_e()(Z||[])));break}else if(M[g].children&&(R=S(M[g].children,I,L,P),R))break;return R},N=function(){a!=null&&a.children?(_(f,a.uuid,null,[f,b]),E&&_(E,a.uuid,null,[E,O])):T()},C=function(M){if(M===d.TreeNodeType.DATA_SOURCE){var I;return(I=d.databaseMap[a.extraParams.databaseType])===null||I===void 0?void 0:I.icon}else{var L,P;return((L=yr[M])===null||L===void 0?void 0:L[a.children?"unfoldIcon":"icon"])||((P=yr[M])===null||P===void 0?void 0:P.icon)}},p=function(){var M,I;if(Al.E.setState({focusedContent:a.name||""}),a.treeNodeType===d.TreeNodeType.TABLE){var L,P,w,Z,B;Cr({code:"viewDDL",uniqueData:{dataSourceId:(L=a.extraParams)===null||L===void 0?void 0:L.dataSourceId,dataSourceName:(P=a.extraParams)===null||P===void 0?void 0:P.dataSourceName,databaseName:(w=a.extraParams)===null||w===void 0?void 0:w.databaseName,databaseType:(Z=a.extraParams)===null||Z===void 0?void 0:Z.databaseType,schemaName:(B=a.extraParams)===null||B===void 0?void 0:B.schemaName,tableName:a.name}})}jl(a.uuid||""),kl({dataSourceId:a.extraParams.dataSourceId,dataSourceName:a.extraParams.dataSourceName,databaseType:a.extraParams.databaseType,databaseName:(M=a.extraParams)===null||M===void 0?void 0:M.databaseName,schemaName:(I=a.extraParams)===null||I===void 0?void 0:I.schemaName})},v=function(){if(a.treeNodeType===d.TreeNodeType.TABLE||a.treeNodeType===d.TreeNodeType.VIEW||a.treeNodeType===d.TreeNodeType.PROCEDURE||a.treeNodeType===d.TreeNodeType.FUNCTION||a.treeNodeType===d.TreeNodeType.TRIGGER){var M;(M=k.find(function(I){return I.doubleClickTrigger}))===null||M===void 0||M.onClick(a)}else N()},k=zl({treeNodeData:a,loadData:T}),D=(0,l.useMemo)(function(){var S,M,I=k.map(function(L){return{key:L.key,onClick:function(){L.onClick(a)},label:(0,e.jsx)(ba,{icon:L.labelProps.icon,label:L.labelProps.label})}});return(0,e.jsx)(Ae.Z,{trigger:["contextMenu"],menu:{items:I,style:I!=null&&I.length?{}:{display:"none"}},overlayStyle:{zIndex:1080},children:(0,e.jsx)(Ve.Z,{placement:"right",color:(S=window._AppThemePack)===null||S===void 0?void 0:S.colorPrimary,title:a.comment,children:(0,e.jsxs)("div",{className:$()(ua.treeNode,W()({},ua.treeNodeFocus,x)),onClick:p,onContextMenu:p,onDoubleClick:v,"data-chat2db-general-can-copy-element":!0,children:[(0,e.jsx)("div",{className:ua.left,children:c.map(function(L,P){return(0,e.jsx)("div",{className:ua.indent},P)})}),(0,e.jsxs)("div",{className:ua.right,children:[!a.isLeaf&&(0,e.jsx)("div",{onClick:N,className:$()(ua.arrows,W()({},ua.loadingArrows,i)),children:i?(0,e.jsx)(or,{}):(0,e.jsx)(X.Z,{className:$()(ua.arrowsIcon,W()({},ua.rotateArrowsIcon,a.children)),code:"\uE641"})}),(0,e.jsxs)("div",{className:ua.dblclickArea,children:[(0,e.jsx)("div",{className:ua.typeIcon,children:(0,e.jsx)(X.Z,{code:C(a.treeNodeType)})}),(0,e.jsxs)("div",{className:ua.contentText,children:[(0,e.jsx)("div",{className:ua.name,dangerouslySetInnerHTML:{__html:a.name}}),a.treeNodeType===d.TreeNodeType.COLUMN&&(0,e.jsx)("div",{className:ua.type,children:(M=a.columnType)===null||M===void 0?void 0:M.toLowerCase()})]})]})]})]})})})},[x,i,k,a.children]);return D}),ni=(0,l.memo)(ai),ri=(0,l.memo)(function(n){var a=n.className,t=(0,l.useState)(null),r=j()(t,2),o=r[0],i=r[1],u=(0,l.useState)(""),c=j()(u,2),m=c[0],f=c[1],b=Re(function(O){return O.currentConnectionDetails}),E=function(){var T,x,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(b!=null&&b.id)){i([]);return}var N=b.supportDatabase?d.TreeNodeType.DATA_SOURCE:d.TreeNodeType.DATABASE;i(null),(T=(x=_n[N]).getChildren)===null||T===void 0||T.call(x,{dataSourceId:b.id,dataSourceName:b.alias,refresh:_,extraParams:{dataSourceId:b.id,dataSourceName:b.alias,databaseType:b.type}}).then(function(C){i(C)}).catch(function(){i([])})};return(0,l.useEffect)(function(){E()},[b]),(0,e.jsxs)("div",{className:$()(Ir.treeContainer,a),children:[(0,e.jsx)(Pl,{getTreeData:E,searchValue:m,setSearchValue:f}),(0,e.jsx)(ni,{className:Ir.treeBox,searchValue:m,treeData:o})]})}),ft={"f-icon-button":"f-icon-button___qXMS8","f-fill-absolute":"f-fill-absolute___q6f_O","f-button":"f-button___A2KBX","f-doc-en-break":"f-doc-en-break___SgukK",selectConnection:"selectConnection___CXolE",menuLabel:"menuLabel___i7JJ_",dropDownArrow:"dropDownArrow___ZHeFa",dropdownOverlay:"dropdownOverlay___wlWiN",menuLabelIconBox:"menuLabelIconBox___LjTQK",menuLabelIcon:"menuLabelIcon___HSsNu",menuLabelTag:"menuLabelTag___ts3Jr",menuLabelTitle:"menuLabelTitle___2UAeV",envTag:"envTag___gUG5u",databaseTypeIcon:"databaseTypeIcon___fdtdR","loading-animation":"loading-animation___mE7_d"},oi=(0,l.memo)(function(){var n=Ga(function(u){return{connectionList:u.connectionList}}),a=n.connectionList,t=Re(function(u){return{currentConnectionDetails:u.currentConnectionDetails}}),r=t.currentConnectionDetails,o=function(c){var m;return(0,e.jsxs)("div",{className:$()(ft.menuLabel),children:[(0,e.jsx)("span",{className:ft.envTag,style:{background:c.environment.color.toLocaleLowerCase()}}),(0,e.jsx)("div",{className:ft.menuLabelIconBox,children:(0,e.jsx)(X.Z,{className:$()(ft.menuLabelIcon),code:(m=d.databaseMap[c.type])===null||m===void 0?void 0:m.icon})}),(0,e.jsx)("div",{className:ft.menuLabelTitle,children:c.alias})]})},i=(0,l.useMemo)(function(){return(a==null?void 0:a.map(function(u){return{key:u.id,label:o(u),onClick:function(){Yt(u)}}}))||[]},[a,r]);return(0,e.jsx)(Ae.Z,{menu:{items:i},trigger:["click"],overlayClassName:ft.dropdownOverlay,children:(0,e.jsxs)("div",{className:ft.selectConnection,children:[r&&o(r),(0,e.jsx)("div",{className:ft.dropDownArrow,children:(0,e.jsx)(X.Z,{code:"\uE641"})})]})})}),Ja={"f-icon-button":"f-icon-button___HLPxn","f-fill-absolute":"f-fill-absolute___gt70h","f-button":"f-button___loovJ","f-doc-en-break":"f-doc-en-break___PUG9e",monacoEditorBox:"monacoEditorBox___U42aA",errorBox:"errorBox___CAAw0",previewBox:"previewBox___LRmAh",previewText:"previewText___ZPgA5",previewLine:"previewLine___Ohx3t","loading-animation":"loading-animation___yUQ69"},re=K(95986),Aa=K(79407),li=[d.DatabaseTypeCode.MYSQL],ii=function(){var a=re.Z.useForm(),t=j()(a,1),r=t[0],o=(0,l.useMemo)(function(){return(0,Ce.Z)()},[]),i=l.useRef(null),u=(0,l.useState)(!1),c=j()(u,2),m=c[0],f=c[1],b=(0,l.useState)(null),E=j()(b,2),O=E[0],T=E[1],x=(0,l.useState)(!1),_=j()(x,2),N=_[0],C=_[1],p=(0,l.useState)("database"),v=j()(p,2),k=v[0],D=v[1],S=(0,l.useState)(null),M=j()(S,2),I=M[0],L=M[1],P=l.useRef();(0,l.useEffect)(function(){if(!m){var V;T(null),r.resetFields(),(V=i.current)===null||V===void 0||V.setValue("","cover")}},[m]);var w=(0,l.useMemo)(function(){return k==="database"?{title:"".concat((0,s.ZP)("common.title.create")," Database"),api:ye.Z.getCreateDatabaseSql,formName:"databaseName"}:{title:"".concat((0,s.ZP)("common.title.create")," Schema"),api:ye.Z.getCreateSchemaSql,formName:"schemaName"}},[k]),Z={flex:"70px"},B=(0,l.useCallback)((0,Bt.debounce)(function(){var V=r.getFieldsValue();if(!(!V.databaseName&&k==="database")&&!(!V.schemaName&&k==="schema")){var U=h()({databaseType:I==null?void 0:I.databaseType,dataSourceId:I==null?void 0:I.dataSourceId,databaseName:I==null?void 0:I.databaseName},V);w.api(U).then(function(Q){var G,z=Q.sql;(G=i.current)===null||G===void 0||G.setValue(z,"cover")})}},500),[I,k,i,w]),R=function(U){var Q={dataSourceId:I==null?void 0:I.dataSourceId,databaseType:I==null?void 0:I.databaseType,databaseName:I==null?void 0:I.databaseName,sql:U};return C(!0),T(null),ye.Z.executeDDL(Q).then(function(G){if(G.success){var z;f(!1),(z=P.current)===null||z===void 0||z.call(P)}else T(G)}).finally(function(){C(!1)})},g=function(){var U,Q=((U=i.current)===null||U===void 0?void 0:U.getAllContent())||"";R(Q)},A=function(U){f(!0),D(U.type),L(U.relyOnParams),P.current=U.executedCallback};return(0,l.useEffect)(function(){Sl(A)},[]),!!I&&(0,e.jsx)(Aa.Z,{onCancel:function(){f(!1)},title:w.title,destroyOnClose:!0,confirmLoading:N,open:m,onOk:g,children:(0,e.jsxs)("div",{className:Ja.createDatabaseDom,children:[(0,e.jsxs)(re.Z,{labelAlign:"left",form:r,labelCol:Z,onFieldsChange:B,name:"create",children:[(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("common.label.name"),name:w.formName,children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}),li.includes(I.databaseType)?null:(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("common.label.comment"),name:"comment",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})})]}),(0,e.jsxs)("div",{className:Ja.previewBox,children:[(0,e.jsx)("div",{className:Ja.previewText,children:(0,s.ZP)("common.title.preview")}),(0,e.jsx)("div",{className:Ja.previewLine})]}),(0,e.jsx)("div",{className:Ja.monacoEditorBox,children:(0,e.jsx)(gt,{ref:i,options:{lineNumbers:"off"},id:o})}),O&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:$()(Ja.previewBox,Ja.errorBox),children:[(0,e.jsx)("div",{className:Ja.previewText,children:(0,s.ZP)("common.title.errorMessage")}),(0,e.jsx)("div",{className:Ja.previewLine})]}),(0,e.jsx)("div",{children:O.message})]})]})})},si=ii,ui=(0,l.memo)(function(){var n=Ga(function(r){return{connectionList:r.connectionList}}),a=n.connectionList,t=function(){ar("connections")};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:$()(Qt.workspaceLeft),children:a!=null&&a.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(oi,{}),(0,e.jsx)(ri,{})]}):(0,e.jsxs)("div",{className:Qt.noConnectionList,children:[(0,e.jsx)(X.Z,{className:Qt.noConnectionListIcon,code:"\uE638"}),(0,e.jsx)("div",{className:Qt.noConnectionListTips,children:(0,s.ZP)("workspace.tips.noConnection")}),(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{className:Qt.create,onClick:t,children:(0,s.ZP)("common.title.create")}),(0,s.ZP)("connection.title.connections")]})]})}),(0,e.jsx)(si,{})]})}),ci=ui,Sn={"f-icon-button":"f-icon-button___PGEUN","f-fill-absolute":"f-fill-absolute___GFjVL","f-button":"f-button___KxeuO","f-doc-en-break":"f-doc-en-break___bDYO7",workspaceRight:"workspaceRight___OR4bm",workspaceExtendNav:"workspaceExtendNav___oLWjY",draggableContainer:"draggableContainer___Ubja0",workspaceExtendBody:"workspaceExtendBody___sN4fS",workspaceExtend:"workspaceExtend___CC3wk",consoleTabsContainer:"consoleTabsContainer___ktU7F",searchResultContainer:"searchResultContainer___erxQP","loading-animation":"loading-animation___VvWZY"},ga={"f-icon-button":"f-icon-button___huUpx","f-fill-absolute":"f-fill-absolute___B8Qcs","f-button":"f-button___CIMA6","f-doc-en-break":"f-doc-en-break___ukgoI",output:"output___dt7Df",outputTitle:"outputTitle___WfWF7",outputContent:"outputContent____wmKd",outputItem:"outputItem___YMwWZ",timeBox:"timeBox___s0Z7f",timeSpan:"timeSpan___qDo2b",timeBoxIcon:"timeBoxIcon___SReVH",failureIconBox:"failureIconBox___sxyQ7",executedDatabaseBox:"executedDatabaseBox___pwYk1",sqlBox:"sqlBox___nlw31",iconBox:"iconBox___iIK8l",executedDatabase:"executedDatabase___b52Un","loading-animation":"loading-animation___rT026"},sr={"f-icon-button":"f-icon-button___FTEKY","f-fill-absolute":"f-fill-absolute___aoUfF","f-button":"f-button___x0Dz2","f-doc-en-break":"f-doc-en-break___todeA",box:"box___bBkaG",tips:"tips___qmuf6","loading-animation":"loading-animation___ZhT_5"},di=(0,l.memo)(function(n){var a=n.className,t=n.children,r=n.scrollerElement,o=n.threshold,i=n.onReachBottom,u=n.finished,c=r.current,m=(0,l.useRef)(c),f=(0,l.useRef)(!1),b=(0,l.useRef)(!1),E=(0,l.useRef)(null),O=(0,l.useRef)(i);(0,l.useEffect)(function(){m.current=r.current,x(E.current,r.current)},[]),(0,l.useEffect)(function(){b.current=u},[u]),(0,l.useEffect)(function(){O.current=i},[i]);var T=(0,l.useCallback)(function(){if(!(b.current||f.current)){var _=m.current;_&&_.scrollTop>=_.scrollHeight-_.clientHeight-o&&(f.current=!0,O.current().then(function(){f.current=!1}))}},[]);(0,l.useEffect)(function(){if(m.current)return m.current.addEventListener("scroll",T),function(){m.current.removeEventListener("scroll",T)}},[T]);var x=function(N,C){N.clientHeight<=C.clientHeight&&!b.current&&O.current()};return(0,e.jsxs)("div",{ref:E,className:$()(a,sr.box),children:[t,(0,e.jsx)(e.Fragment,{children:!u&&(0,e.jsx)("div",{className:sr.tips,children:(0,e.jsx)(mt.Z,{className:sr.loading})})})]})}),mi=K(95161),fa=K(19515),xa=K(55241),fi=(0,l.memo)(function(n){var a=n.className,t=l.useState([]),r=j()(t,2),o=r[0],i=r[1],u=l.useRef(null),c=l.useRef(1),m=l.useRef(!1),f=function(){return Pa.getHistoryList({pageNo:c.current++,pageSize:40}).then(function(T){m.current=!T.hasNextPage;var x=T.data.map(function(_){return new Promise(function(N){var C=_.ddl||"";mi.j6.colorize(C,"sql",{}).then(function(p){N(h()(h()({},_),{},{highlightedCode:p}))})})});Promise.all(x).then(function(_){i([].concat(_e()(o),_e()(_)))})})},b=function(T){(0,fa.JG)(T||"")},E=function(T){$a({ddl:T.ddl||"",dataSourceId:T.dataSourceId,dataSourceName:T.dataSourceName,databaseType:T.type,databaseName:T.databaseName,schemaName:T.schemaName})};return(0,e.jsxs)("div",{className:$()(ga.output,a),children:[(0,e.jsx)("div",{className:ga.outputTitle,children:(0,s.ZP)("common.title.executiveLogging")}),(0,e.jsx)("div",{className:ga.outputContent,ref:u,children:(0,e.jsx)(di,{onReachBottom:f,scrollerElement:u,threshold:300,finished:m.current,children:(0,e.jsx)(e.Fragment,{children:o.map(function(O,T){var x=[O.dataSourceName,O.databaseName,O.schemaName];return(0,e.jsxs)("div",{className:ga.outputItem,children:[(0,e.jsxs)("div",{className:ga.timeBox,children:[(0,e.jsx)(X.Z,{classNameBox:$()(ga.timeBoxIcon,W()({},ga.failureIconBox,O.status!=="success")),box:!0,boxSize:20,code:"\uE650"}),(0,e.jsxs)("span",{className:ga.timeSpan,children:["[",O.gmtCreate,"]"]}),!!O.useTime&&(0,e.jsx)("span",{children:(0,s.ZP)("common.text.executionTime",O.useTime)})]}),(0,e.jsxs)("div",{className:ga.executedDatabaseBox,children:[(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("workspace.tips.openExecutiveLogging"),children:(0,e.jsx)(X.Z,{classNameBox:ga.iconBox,box:!0,boxSize:20,code:"\uE6BB",onClick:function(){E(O)}})}),(0,e.jsx)("div",{className:ga.executedDatabase,children:x.filter(function(_){return _}).join(" > ")})]}),(0,e.jsxs)("div",{className:ga.sqlBox,children:[(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("common.button.copy"),children:(0,e.jsx)(X.Z,{classNameBox:ga.iconBox,box:!0,boxSize:20,code:"\uEC7A",onClick:function(){b(O.ddl)}})}),(0,e.jsx)("div",{className:ga.sqlContent,dangerouslySetInnerHTML:{__html:O.highlightedCode}})]})]},T)})})})})]})}),vi={"f-icon-button":"f-icon-button___YhHE_","f-fill-absolute":"f-fill-absolute___g_P7W","f-button":"f-button___kEe1H","f-doc-en-break":"f-doc-en-break___llhrF",viewDDL:"viewDDL___z2Cir","loading-animation":"loading-animation___R0FJC"},Hr=(0,l.memo)(function(n){var a=n.className,t=n.data,r=l.useState((0,Ce.Z)()),o=j()(r,1),i=o[0],u=l.useRef(null),c=l.useState(""),m=j()(c,2),f=m[0],b=m[1];return(0,l.useEffect)(function(){t&&ye.Z.exportCreateTableSql(h()({},t)).then(function(E){b(E)})},[t]),(0,l.useEffect)(function(){var E;(E=u.current)===null||E===void 0||E.setValue(f||"","reset")},[f]),(0,e.jsx)("div",{className:$()(vi.viewDDL,a),children:(0,e.jsx)(gt,{id:i,ref:u,options:{lineNumbers:"off",readOnly:!0,glyphMargin:!1,folding:!1}})})}),ur={viewDDLBox:"viewDDLBox___rKX88",viewDDLHeader:"viewDDLHeader___GK7WM",viewDDL:"viewDDL___swyJf",noInformation:"noInformation___EFxlr"},_i=function(){var a=Re(function(r){return{currentWorkspaceGlobalExtend:r.currentWorkspaceGlobalExtend}}),t=a.currentWorkspaceGlobalExtend;switch(t==null?void 0:t.code){case Tn.view_ddl:return(0,e.jsxs)("div",{className:ur.viewDDLBox,children:[(0,e.jsx)("div",{className:ur.viewDDLHeader,children:"".concat(t.uniqueData.tableName,"-DDL")}),(0,e.jsx)(Hr,{data:t.uniqueData}),";"]});default:return(0,e.jsx)("div",{className:ur.noInformation,children:"No information"})}},pi=_i,Oa={"f-icon-button":"f-icon-button___G8YWe","f-fill-absolute":"f-fill-absolute____Sq7H","f-button":"f-button___hbgQj","f-doc-en-break":"f-doc-en-break___FXlP3",saveModule:"saveModule___yILRD",leftModuleTitle:"leftModuleTitle___RLb2M",leftModuleTitleText:"leftModuleTitleText___Dz90h",modelName:"modelName___Radzg",iconBox:"iconBox___zW8zl",refreshIcon:"refreshIcon___d7OJF",searchIcon:"searchIcon___PdLJ9",leftModuleTitleSearch:"leftModuleTitleSearch___UGPsM",loadingContent:"loadingContent___BX6iD",saveBoxList:"saveBoxList___nJwrp",leftModuleTitleShadow:"leftModuleTitleShadow___ndQT_",saveItem:"saveItem___B3mAG",saveItemText:"saveItemText___sU7na",itemName:"itemName___HYShh","loading-animation":"loading-animation___cD0mf"},hi=function(){var a,t=(0,l.useState)(!1),r=j()(t,2),o=r[0],i=r[1],u=(0,l.useRef)(),c=(0,l.useState)(),m=j()(c,2),f=m[0],b=m[1],E=(0,l.useRef)(null),O=(0,l.useRef)(null),T=Re(function(I){return I.savedConsoleList}),x=(0,l.useState)(null),_=j()(x,2),N=_[0],C=_[1];(0,l.useEffect)(function(){mn()},[]),(0,l.useEffect)(function(){o&&u.current.focus({cursor:"start"})},[o]);function p(){i(!0)}function v(){u.current.input.value||(i(!1),b(void 0))}function k(I){T&&b((0,fa.jt)(T,I))}function D(I){var L={id:I.id,tabOpened:d.ConsoleOpenedStatus.IS_OPEN};Pa.updateSavedConsole(L).then(function(){ia({id:I.id,type:I.operationType,title:I.name,uniqueData:{dataSourceId:I.dataSourceId,dataSourceName:I.dataSourceName,databaseType:I.type,databaseName:I.databaseName,schemaName:I.schemaName,status:I.status,ddl:I.ddl,connectable:I.connectable}})})}function S(I){var L={id:I.id};Pa.deleteSavedConsole(L).then(function(){mn()})}var M=function(L){C(L)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:Oa.saveModule,children:[(0,e.jsx)("div",{ref:E,className:Oa.leftModuleTitle,children:o?(0,e.jsx)("div",{className:Oa.leftModuleTitleSearch,children:(0,e.jsx)(xe.Z,{ref:u,size:"small",placeholder:(0,s.ZP)("common.text.search"),prefix:(0,e.jsx)(X.Z,{code:"\uE600"}),onBlur:v,onChange:function(L){return k(L.target.value)},allowClear:!0})}):(0,e.jsxs)("div",{className:Oa.leftModuleTitleText,children:[(0,e.jsx)("div",{className:Oa.modelName,children:(0,s.ZP)("workspace.title.savedConsole")}),(0,e.jsx)("div",{className:Oa.iconBox,children:(0,e.jsx)("div",{className:Oa.searchIcon,onClick:function(){return p()},children:(0,e.jsx)(X.Z,{code:"\uE600"})})})]})}),(0,e.jsx)("div",{ref:O,className:Oa.saveBoxList,children:(0,e.jsx)(Nn,{className:Oa.loadingContent,data:T,handleEmpty:!0,children:(a=f||T)===null||a===void 0?void 0:a.map(function(I){var L;return(0,e.jsx)(Ae.Z,{trigger:["contextMenu"],menu:{items:[{key:"open",label:(0,e.jsx)(ba,{icon:"\uEC83",label:(0,s.ZP)("common.button.open")}),onClick:function(){D(I)}},{key:"edit",label:(0,e.jsx)(ba,{icon:"\uE602",label:(0,s.ZP)("common.text.rename")}),onClick:function(){M(I)}},{key:"delete",label:(0,e.jsx)(ba,{icon:"\uE6A7",label:(0,s.ZP)("common.button.delete")}),onClick:function(){S(I)}}]},children:(0,e.jsx)("div",{onDoubleClick:function(){D(I)},className:Oa.saveItem,children:(0,e.jsxs)("div",{className:Oa.saveItemText,children:[(0,e.jsx)("div",{className:Oa.iconBox,children:(0,e.jsx)(X.Z,{code:(L=d.workspaceTabConfig[I.operationType])===null||L===void 0?void 0:L.icon})}),(0,e.jsx)("div",{className:Oa.itemName,dangerouslySetInnerHTML:{__html:I.name}})]})})},I.id)})})})]}),(0,e.jsx)(Aa.Z,{title:(0,s.ZP)("common.text.rename"),open:!!N,onOk:function(){var L={id:N.id,name:N.name};Pa.updateSavedConsole(L).then(function(){mn(),C(null)})},onCancel:function(){return C(null)},children:(0,e.jsx)(xe.Z,{value:N==null?void 0:N.name,onChange:function(L){C(h()(h()({},N),{},{name:L.target.value}))}})})]})},bi=hi,an,Tn=function(n){return n.view_ddl="viewDDL",n.executive_log="executiveLog",n.save_list="saveList",n}({}),Gr=(an={},W()(an,Tn.view_ddl,Hr),W()(an,Tn.executive_log,fi),W()(an,Tn.save_list,bi),an),qr=[{code:"info",title:(0,s.ZP)("common.title.info"),icon:"\uE8E8",components:pi},{code:"executiveLog",title:(0,s.ZP)("common.title.executiveLogging"),icon:"\uE8AD",components:Gr.executiveLog},{code:"saveList",title:(0,s.ZP)("workspace.title.savedConsole"),icon:"\uE619",components:Gr.saveList}],Ni=function(){var n=Re(function(r){return{currentWorkspaceExtend:r.currentWorkspaceExtend}}),a=n.currentWorkspaceExtend,t=(0,l.useMemo)(function(){var r;return(r=qr.find(function(o){return o.code===a}))===null||r===void 0?void 0:r.components},[a]);return t?(0,e.jsx)(t,{}):!1},Kr={"f-icon-button":"f-icon-button___AlNdA","f-fill-absolute":"f-fill-absolute___Hs3cq","f-button":"f-button___i53Mj","f-doc-en-break":"f-doc-en-break___p3nIn",workspaceExtendNav:"workspaceExtendNav___XdEBM",rightBarFront:"rightBarFront___PBH7p",workspaceExtendActive:"workspaceExtendActive___BUECi","loading-animation":"loading-animation___mA1ov"},Si=function(n){var a=n.className,t=Re(function(i){return{currentWorkspaceExtend:i.currentWorkspaceExtend}}),r=t.currentWorkspaceExtend,o=function(u){if(r===u.code){Er(null);return}Er(u.code)};return(0,e.jsx)("div",{className:$()(a,Kr.workspaceExtendNav),children:qr.map(function(i,u){return(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,placement:"left",content:i.title,children:(0,e.jsx)("div",{className:Kr.rightBarFront,onClick:o.bind(null,i),children:(0,e.jsx)(X.Z,{code:i.icon,box:!0,size:18,active:r===i.code})})},u)})})},En={"f-icon-button":"f-icon-button___LkjYj","f-fill-absolute":"f-fill-absolute___I5mM5","f-button":"f-button___X3yLc","f-doc-en-break":"f-doc-en-break___xArDX",tabBox:"tabBox___m6o76",ears:"ears___bnum4","loading-animation":"loading-animation___JKQLX"},jd=K(52677),Ti=Object.prototype.toString,tn=function(a){return function(t){return Ei(t)==="[object ".concat(a,"]")}},Ei=function(a){return Ti.call(a)},kd=Array.isArray,Cn=function(a){return a!=null},wd=function(a){return typeof a=="function"},Md=tn("Object"),Zd=tn("String"),Bd=tn("Boolean"),Ci=tn("Number"),Ud=function(a){return a&&a instanceof Map},Fd=function(a){return a&&a instanceof Set},Vd=function(a){return a&&a instanceof WeakMap},Wd=function(a){return a&&a instanceof WeakSet},Hd=function(a){return Ci(a)||/^\d+$/.test(a)},Gd=function(a){return _typeof(a)==="object"},qd=tn("RegExp"),Kd=function(a){return a&&a.$$typeof&&a._owner},zd=function(a){return Object.prototype.toString.call(a).indexOf("HTML")>-1},ea={"f-icon-button":"f-icon-button___WGoYX","f-fill-absolute":"f-fill-absolute___FykFK","f-button":"f-button___EuOy1","f-doc-en-break":"f-doc-en-break___WdWcM",tabBox:"tabBox___svbUV",tabsNav:"tabsNav___vLw5m",tabsContent:"tabsContent___HTtXX",tabsContentItem:"tabsContentItem___is6c0",tabsContentItemActive:"tabsContentItemActive___kYV5p",activeContent:"activeContent___z2hMc",tabList:"tabList___X4B72",tabItem:"tabItem___dMiZL",textBox:"textBox___R08eb",text:"text___z7X99",icon:"icon___cYega",activeTab:"activeTab___YUCdI",rightBox:"rightBox___o4__4",moreTabs:"moreTabs___WKDbK",addIcon:"addIcon___Gv9Lu",addIconDisabled:"addIconDisabled___zifws",input:"input___YVjQP",prefixIcon:"prefixIcon___jVHYW","loading-animation":"loading-animation___nlcZQ"},zr=20,Yr=(0,l.memo)(function(n){var a,t=n.className,r=n.items,o=n.onChange,i=n.onEdit,u=n.activeKey,c=n.hideAdd,m=n.lastTabCannotClosed,f=n.editableNameOnBlur,b=n.concealTabHeader,E=n.destroyInactiveTabPane,O=E===void 0?!1:E,T=(0,l.useState)([]),x=j()(T,2),_=x[0],N=x[1],C=(0,l.useState)(null),p=j()(C,2),v=p[0],k=p[1],D=(0,l.useState)(),S=j()(D,2),M=S[0],I=S[1],L=(0,l.useRef)(null),P=(0,l.useRef)(null),w=(0,l.useRef)(!1),Z=(0,l.useState)(!1),B=j()(Z,2),R=B[0],g=B[1];(0,l.useEffect)(function(){Cn(u)&&k(u),w.current=typeof u=="number"},[u]),(0,l.useEffect)(function(){if(N(r||[]),r!=null&&r.length&&!Cn(v)){var q;k((q=r[0])===null||q===void 0?void 0:q.key)}},[r]),(0,l.useEffect)(function(){var q,Y=function(de){de.deltaY&&(de.preventDefault(),P.current&&(P.current.scrollLeft-=de.deltaY))};return(q=P.current)===null||q===void 0||q.addEventListener("wheel",Y),function(){var J;(J=P.current)===null||J===void 0||J.removeEventListener("wheel",Y)}},[]),(0,l.useEffect)(function(){if(o==null||o(v),L.current){var q=L.current.querySelector(".".concat(ea.activeTab));q&&q.scrollIntoView({block:"nearest"})}},[v]),(0,l.useEffect)(function(){if(L.current){var q,Y,J=((q=P.current)===null||q===void 0?void 0:q.getBoundingClientRect().width)||0,de=((Y=L.current)===null||Y===void 0?void 0:Y.getBoundingClientRect().width)||0;g(J<de)}},[_]);var A=function(Y){var J=_==null?void 0:_.filter(function(ue){return ue.key!==Y.key}),de=v;if(Y.key===v){var se=_.findIndex(function(ue){return ue.key===Y.key});if(se===0){var Me;de=(Me=_[1])===null||Me===void 0?void 0:Me.key}else{var oe;de=(oe=_[se-1])===null||oe===void 0?void 0:oe.key}}Q(de),N(J),i==null||i("remove",[Y],J)},V=function(Y){var J=_==null?void 0:_.filter(function(se){return se.key===Y.key}),de=_==null?void 0:_.filter(function(se){return se.key!==Y.key});Q(Y.key),N(J),i==null||i("remove",de,J)},U=function(){Q(null),N([]),i==null||i("remove",_e()(_))},Q=function(Y){k(Y)},G=function(){_.length>=zr||i==null||i("add")},z=function(Y){Y.editableName&&I(Y.key)},y=function(Y,J){function de(ue){_[J].label=ue,N(_e()(_))}function se(){f==null||f(Y),I(void 0)}function Me(){return!(m&&_.length===1||Y.canClosed===!0)}var oe=[{label:(0,s.ZP)("common.button.close"),key:"close",onClick:function(){A(Y)}},{label:(0,s.ZP)("common.button.closeOthers"),key:"closeOther",onClick:function(){V(Y)}},{label:(0,s.ZP)("common.button.closeAll"),key:"closeAll",onClick:function(){U()}}];return(0,e.jsx)(Ae.Z,{menu:{items:oe},trigger:["contextMenu"],children:(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:Y.popover,children:(0,e.jsxs)("div",{onDoubleClick:function(){z(Y)},style:Y.styles,className:$()(ea.tabItem,W()({},ea.activeTab,Y.key===v)),children:[Y.key===M?(0,e.jsx)("input",{value:Y.label,onChange:function(Te){de(Te.target.value)},className:ea.input,autoFocus:!0,onBlur:se,type:"text"}):(0,e.jsxs)("div",{className:ea.textBox,onClick:Q.bind(null,Y.key),children:[Y.prefixIcon&&(typeof Y.prefixIcon=="string"?(0,e.jsx)(X.Z,{className:ea.prefixIcon,code:Y.prefixIcon}):Y.prefixIcon),(0,e.jsx)("div",{className:ea.text,children:Y.label})]},Y.key),Me()&&(0,e.jsx)("div",{className:ea.icon,onClick:A.bind(null,Y),children:(0,e.jsx)(X.Z,{code:"\uE634"})})]})},Y.key)},Y.key)},F=(_||[]).map(function(q){return{label:q.label,key:q.key.toString(),value:q.key}});return(0,e.jsxs)("div",{className:$()(ea.tabBox,t),children:[!b&&(0,e.jsxs)("div",{className:ea.tabsNav,ref:P,children:[!!(_!=null&&_.length)&&(0,e.jsx)("div",{className:ea.tabList,ref:L,children:_.map(function(q,Y){return y(q,Y)})}),(0,e.jsxs)("div",{className:ea.rightBox,children:[R&&(0,e.jsx)("div",{className:ea.moreTabs,children:(0,e.jsx)(Ae.Z,{menu:{style:{maxHeight:"200px",overflowY:"auto"},items:F,selectable:!0,selectedKeys:["".concat(v)],onClick:function(Y){var J,de=((J=F.find(function(se){return(se==null?void 0:se.key)===Y.key}))===null||J===void 0?void 0:J.value)||null;Q(de)}},trigger:["click"],children:(0,e.jsx)("a",{onClick:function(Y){return Y.preventDefault()},children:(0,e.jsx)(X.Z,{code:"\uE601"})})})}),!c&&(0,e.jsx)("div",{className:$()(ea.addIcon,W()({},ea.addIconDisabled,_.length>=zr)),onClick:G,children:(0,e.jsx)(X.Z,{code:"\uE631"})})]})]}),O?(0,e.jsx)("div",{className:ea.tabsContent,children:(0,e.jsx)("div",{className:$()(ea.tabsContentItem,ea.tabsContentItemActive),children:(a=_.find(function(q){return q.key===v}))===null||a===void 0?void 0:a.children})}):(0,e.jsx)("div",{className:ea.tabsContent,children:_==null?void 0:_.map(function(q){return(0,e.jsx)("div",{className:$()(ea.tabsContentItem,W()({},ea.tabsContentItemActive,q.key===v)),children:q.children},q.key)})})]})}),gi=K(68400),xi=K.n(gi),Qr=K(42075),$r=K(20145),Jr=K(50250),Ii=K(20648),ja={screeningResult:"screeningResult___xkLvc",whereBox:"whereBox___mAwT1",orderByBox:"orderByBox___zTfr2",titleBox:"titleBox___dSJOz",titleIcon:"titleIcon___uwxam",title:"title___kah6E",activeTitle:"activeTitle___dGL3W",monacoEditor:"monacoEditor___q1xNw"},yi={"f-icon-button":"f-icon-button___l5GSA","f-fill-absolute":"f-fill-absolute___Oe_Ko","f-button":"f-button___toG2v","f-doc-en-break":"f-doc-en-break___Di30n",singleFileMonacoEditor:"singleFileMonacoEditor___Q_cIg","loading-animation":"loading-animation___Qe7mh"},Di={lineNumbers:!1,renderLineHighlight:"none",scrollBeyondLastLine:!1,wordWrap:"off",minimap:{enabled:!1},scrollbar:{vertical:"hidden",horizontal:"hidden"},overviewRulerBorder:!1,glyphMargin:!1,folding:!1,lineDecorationsWidth:0,lineNumbersMinChars:0},Li=(0,l.memo)((0,l.forwardRef)(function(n,a){var t=n.className,r=n.handelEnter,o=n.focusChange,i=(0,l.useRef)(null),u=(0,l.useRef)(null),c=(0,l.useMemo)(function(){return(0,Ce.Z)()},[]),m=(0,l.useCallback)(function(E){if(E.key==="Enter"&&i.current){var O,T=i.current.getContribution("editor.contrib.suggestController"),x=T._widget;if(x&&x.suggestWidgetVisible.get())return;E.preventDefault();var _=((O=u.current)===null||O===void 0?void 0:O.getAllContent().trim())||"";r&&r(_)}},[]),f=(0,l.useCallback)(function(E,O,T){T?(i.current=E,window.addEventListener("keydown",m)):window.removeEventListener("keydown",m)},[]),b=function(){var O;return((O=u.current)===null||O===void 0?void 0:O.getAllContent())||""};return(0,l.useImperativeHandle)(a,function(){return{getAllContent:b}}),(0,e.jsx)("div",{ref:a,className:$()(yi.singleFileMonacoEditor,t),children:(0,e.jsx)(gt,{ref:u,id:c,options:Di,shortcutKey:f,focusChange:o})})})),Xr=Li,Ri=["AND","OR","NOT","IS","NULL","IN","IS NOT NULL","IS NULL","IS NOT","NOT IN","EXISTS","BETWEEN","LIKE","ASC","DESC"],Pi=(0,l.memo)(function(n){var a=n.promptWord,t=n.getTableData,r=(0,l.useContext)(co),o=r.notChangedSql,i=l.useState(!1),u=j()(i,2),c=u[0],m=u[1],f=l.useRef(null),b=l.useRef(null),E=l.useRef(null),O=l.useRef(null);(0,l.useEffect)(function(){f.current&&f.current.dispose(),b.current&&b.current.dispose(),c&&T()},[a,c]);var T=function(){var C=a.slice(1).map(function(v){return{insertText:v.name,kind:we.languages.CompletionItemKind.Field,label:v.name}}),p=function(){return{suggestions:C}};b.current=we.languages.registerCompletionItemProvider("sql",{provideCompletionItems:p,triggerCharacters:[]}),f.current=we.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){return{suggestions:Ri.map(function(k){return{insertText:k,kind:we.languages.CompletionItemKind.Keyword,label:k}})}},triggerCharacters:[]})},x=function(){var C,p,v=((C=E.current)===null||C===void 0?void 0:C.getAllContent().trim())||"",k=((p=O.current)===null||p===void 0?void 0:p.getAllContent().trim())||"",D=v?o+" WHERE "+v:o;D=k?D+" ORDER BY "+k:D,t({sql:D})},_=function(C){m(C)};return(0,e.jsxs)("div",{className:ja.screeningResult,children:[(0,e.jsxs)("div",{className:ja.whereBox,children:[(0,e.jsxs)("div",{className:ja.titleBox,children:[(0,e.jsx)(X.Z,{box:!0,boxSize:20,classNameBox:ja.titleIcon,code:"\uE66A"}),(0,e.jsx)("div",{className:$()(ja.title,W()({},ja.activeTitle,!0)),children:"WHERE"})]}),(0,e.jsx)(Xr,{ref:E,focusChange:_,handelEnter:x,className:ja.monacoEditor})]}),(0,e.jsxs)("div",{className:ja.orderByBox,children:[(0,e.jsxs)("div",{className:ja.titleBox,children:[(0,e.jsx)(X.Z,{box:!0,boxSize:20,classNameBox:ja.titleIcon,code:"\uE69A"}),(0,e.jsx)("div",{className:$()(ja.title,W()({},ja.activeTitle,!0)),children:"ORDER BY"})]}),(0,e.jsx)(Xr,{ref:O,focusChange:_,handelEnter:x,className:ja.monacoEditor})]})]})}),Ne={"f-icon-button":"f-icon-button___fYevS","f-fill-absolute":"f-fill-absolute___rgfNe","f-button":"f-button___cJgSl","f-doc-en-break":"f-doc-en-break___iYv4J",tableBox:"tableBox___PQaUQ",allSelectBox:"allSelectBox___LKFDi",noDataTableBox:"noDataTableBox___DOyQk",toolBar:"toolBar___blqEs",toolBarItem:"toolBarItem___uFS2l",toolBarRight:"toolBarRight____vTmN",exportBar:"exportBar___fn6Kr",editTableDataBar:"editTableDataBar___Z7rDk",editTableDataBarItem:"editTableDataBarItem___UAS4m",disableBar:"disableBar___yA7vW",viewSqlBar:"viewSqlBar___toiFL",refreshBar:"refreshBar___M2FPB",refreshIconBox:"refreshIconBox___Bzwj1",supportBaseTableBox:"supportBaseTableBox___iHsAi",supportBaseTableSpin:"supportBaseTableSpin___NWr2V",supportBaseTableBoxHidden:"supportBaseTableBoxHidden___ALr5y",table:"table___WcqkS",tableItem:"tableItem___sP1MC",tableItemContent:"tableItemContent___rQlec",previewTableItemContent:"previewTableItemContent___owOhw",cellValueNull:"cellValueNull___mP_8l",tableItemEdit:"tableItemEdit___Moz84",tableItemHighlight:"tableItemHighlight___HViGx",tableItemFocus:"tableItemFocus___C4Fnj",tableItemSuccess:"tableItemSuccess___E1_Jz",tableItemError:"tableItemError___FxgUb",tableItemNo:"tableItemNo___ENP_b",pagination:"pagination___UAVZd",monacoEditor:"monacoEditor___PA0B5",errorDetail:"errorDetail___kKJPq","loading-animation":"loading-animation___YTrVQ"};function Ai(n,a){if(!n)return-1;if(!a)return 1;if(n.length!==a.length)return n.length-a.length;for(var t=0;t<n.length;t++)if(n[t]!==a[t])return n.charCodeAt(t)-a.charCodeAt(t);return 0}function Oi(n,a){fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(t){var r=t.headers.get("content-disposition"),o=r?decodeURIComponent(r.split("''")[1]):"file.txt";return t.blob().then(function(i){return{blob:i,filename:o}})}).then(function(t){var r=t.blob,o=t.filename,i=URL.createObjectURL(r),u=document.createElement("a");u.style.display="none",u.href=i,u.download=o,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(i)}).catch(function(t){console.error("\u4E0B\u8F7D\u6587\u4EF6\u5931\u8D25:",t)})}var eo=function(a){return a===In.DEFAULT?null:a},ao=K(71385),gn=function(n){return n.CSV="CSV",n.INSERT="INSERT",n.WORD="WORD",n.EXCEL="EXCEL",n.HTML="HTML",n.MARKDOWN="MARKDOWN",n.PDF="PDF",n}({}),xn=function(n){return n.CURRENT_PAGE="CURRENT_PAGE",n.ALL="ALL",n}({}),to=K(2550),Va={"f-icon-button":"f-icon-button___wn3Sl","f-fill-absolute":"f-fill-absolute___NsOaB","f-button":"f-button___pyJO5","f-doc-en-break":"f-doc-en-break___qnKCD",executeSQL:"executeSQL___bOK71",monacoEditorModal:"monacoEditorModal___CK0Pz",monacoEditorHeader:"monacoEditorHeader___lpuhA",formatButton:"formatButton___mJVAF",executeButton:"executeButton___TyhAk",monacoEditorContent:"monacoEditorContent___BztUH",monacoEditor:"monacoEditor___r6CmD",result:"result___Hp8xO",resultHeader:"resultHeader___iZhdA",resultContent:"resultContent___CZ0cd",errorTitle:"errorTitle___iRLp4",errorMessage:"errorMessage___T1R_S","loading-animation":"loading-animation___E7xoC"},ji=K(82784);function no(n,a){var t=["bigquery","db2","hive","mariadb","mysql","n1ql","plsql","postgresql","redshift","spark","sqlite","sql","trino","transactsql","singlestoredb","snowflake"],r=t.includes(a.toLowerCase())?a.toLowerCase():"sql";return new Promise(function(o){var i="";try{i=(0,ji.WU)(n||"",{language:r})}catch(u){console.log("Frontend format sql error",u)}i?o(i):ye.Z.sqlFormat({sql:n,dbType:a}).then(function(u){i=u,o(i)})})}var ro=(0,l.memo)(function(n){var a=n.className,t=n.initSql,r=t===void 0?null:t,o=n.initError,i=o===void 0?null:o,u=n.databaseType,c=n.databaseName,m=n.dataSourceId,f=n.schemaName,b=n.tableName,E=n.executeSqlApi,O=E===void 0?"executeDDL":E,T=n.executeSuccessCallBack,x=(0,l.useRef)(null),_=(0,l.useState)(!1),N=j()(_,2),C=N[0],p=N[1],v=(0,l.useState)(""),k=j()(v,2),D=k[0],S=k[1],M=(0,l.useState)(null),I=j()(M,2),L=I[0],P=I[1];(0,l.useEffect)(function(){S(r||""),P(i)},[]);var w=function(){var g,A=((g=x.current)===null||g===void 0?void 0:g.getAllContent())||"";no(A,u).then(function(V){S(V)})},Z=function(){var g,A={sql:((g=x.current)===null||g===void 0?void 0:g.getAllContent())||"",dataSourceId:m,databaseName:c,schemaName:f,tableName:b};p(!0),ye.Z[O](A).then(function(V){V.success?T==null||T():P(V.message)}).finally(function(){p(!1)})},B=(0,l.useMemo)(function(){return(0,e.jsx)(gt,{className:Va.monacoEditor,id:"view_sql",ref:x,appendValue:{text:D,range:"reset"}})},[D]);return(0,e.jsx)("div",{className:$()(Va.executeSQL,a),children:(0,e.jsxs)("div",{className:Va.monacoEditorModal,children:[(0,e.jsxs)("div",{className:Va.monacoEditorContent,children:[(0,e.jsxs)("div",{className:Va.monacoEditorHeader,children:[(0,e.jsxs)("div",{className:Va.formatButton,onClick:w,children:[(0,e.jsx)(X.Z,{code:"\uE64F"}),(0,s.ZP)("common.button.format")]}),(0,e.jsxs)(Oe.ZP,{className:Va.executeButton,type:"primary",onClick:Z,loading:C,children:[(0,e.jsx)(X.Z,{code:"\uE656"}),(0,s.ZP)("common.button.execute")]})]}),B]}),L&&(0,e.jsxs)("div",{className:Va.result,children:[(0,e.jsx)("div",{className:Va.resultHeader,children:(0,s.ZP)("common.text.errorMessage")}),(0,e.jsx)("div",{className:Va.resultContent,children:(0,e.jsx)("div",{className:Va.errorMessage,children:L})})]})]})})}),ki=K(80882),wi=K(69976),Mi=K(6171),Zi=K(18073),Bi=K(74160),oo=K(87957),aa=K(68974),qa={"f-icon-button":"f-icon-button___u87sW","f-fill-absolute":"f-fill-absolute___RDPWr","f-button":"f-button___gfTBN","f-doc-en-break":"f-doc-en-break___wg3sA",paginationWrapper:"paginationWrapper___g087u","item-icon":"item-icon___Bxk3V","item-icon-disabled":"item-icon-disabled___TQOYf","input-number":"input-number___Lo6u5","loading-animation":"loading-animation___2EQGy"};function Ui(n){var a,t=n.onPageNoChange,r=n.onPageSizeChange,o=n.paginationConfig,i=(0,l.useState)(1),u=j()(i,2),c=u[0],m=u[1],f=(0,l.useState)(!1),b=j()(f,2),E=b[0],O=b[1];(0,l.useEffect)(function(){var p;m((p=o==null?void 0:o.pageNo)!==null&&p!==void 0?p:1)},[o==null?void 0:o.pageNo]);var T=function(v){m(v)},x=function(){Ye().isNumber(c)?t&&t(c):(m(1),t&&t(1))},_=function(){var p=he()(ee()().mark(function v(){var k;return ee()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(n.onClickTotalBtn){S.next=2;break}return S.abrupt("return");case 2:return O(!0),S.next=5,n.onClickTotalBtn();case 5:return k=S.sent,O(!1),S.abrupt("return",k);case 8:case"end":return S.stop()}},v)}));return function(){return p.apply(this,arguments)}}(),N=function(){var p=he()(ee()().mark(function v(k){var D,S,M;return ee()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!(!t||!o)){L.next=2;break}return L.abrupt("return");case 2:if(!C(k)){L.next=4;break}return L.abrupt("return");case 4:L.t0=k,L.next=L.t0==="first"?7:L.t0==="last"?9:L.t0==="pre"?15:L.t0==="next"?17:19;break;case 7:return t(1),L.abrupt("break",20);case 9:return L.next=11,_();case 11:return D=L.sent,S=o||{},M=S.pageSize,Ye().isNumber(D)&&Ye().isNumber(M)&&n.onPageNoChange&&n.onPageNoChange(Math.ceil(D/M)),L.abrupt("break",20);case 15:return t((o==null?void 0:o.pageNo)-1),L.abrupt("break",20);case 17:return t((o==null?void 0:o.pageNo)+1),L.abrupt("break",20);case 19:return L.abrupt("break",20);case 20:case"end":return L.stop()}},v)}));return function(k){return p.apply(this,arguments)}}(),C=function(v){if(!o)return!1;if(v==="first"||v==="pre")return(o==null?void 0:o.pageNo)===1;var k=Ye().isNumber(o.total),D=o.pageNo*o.pageSize;return v==="next"||v==="last"?k?D>o.total:!(o!=null&&o.hasNextPage):!0};return(0,e.jsxs)("div",{className:qa.paginationWrapper,children:[(0,e.jsx)(wi.Z,{className:$()(qa["item-icon"],W()({},qa["item-icon-disabled"],C("first"))),onClick:function(){return N("first")}}),(0,e.jsx)(Mi.Z,{className:$()(qa["item-icon"],W()({},qa["item-icon-disabled"],C("pre"))),onClick:function(){return N("pre")}}),(0,e.jsx)(oo.Z,{className:qa["input-number"],size:"small",min:1,value:c,controls:!1,onPressEnter:x,onBlur:x,onChange:T}),(0,e.jsx)(Zi.Z,{className:$()(qa["item-icon"],W()({},qa["item-icon-disabled"],C("next"))),onClick:function(){return N("next")}}),(0,e.jsx)(Bi.Z,{className:$()(qa["item-icon"],W()({},qa["item-icon-disabled"],C("last"))),onClick:function(){return N("last")}}),(0,e.jsx)(aa.Z,{popupMatchSelectWidth:!1,size:"small",value:(a=o==null?void 0:o.pageSize)!==null&&a!==void 0?a:200,onChange:r,options:[{label:10,value:10},{label:50,value:50},{label:100,value:100},{label:200,value:200},{label:500,value:500},{label:1e3,value:1e3}]}),(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("workspace.table.total.tip"),children:(0,e.jsxs)(Oe.ZP,{type:"link",loading:E,onClick:_,children:[(0,s.ZP)("workspace.table.total"),"\uFF1A",o==null?void 0:o.total]})})]})}var Fi={"f-icon-button":"f-icon-button___SqLXN","f-fill-absolute":"f-fill-absolute___WxQjk","f-button":"f-button___wxI2w","f-doc-en-break":"f-doc-en-break___sm_5S",statusBar:"statusBar___ncH9u","loading-animation":"loading-animation___zULJB"},lo=(0,l.memo)(function(n){var a=n.className,t=n.description,r=n.duration,o=n.dataLength;return(0,e.jsxs)("div",{className:$()(Fi.statusBar,a),children:[(0,e.jsx)("span",{children:"\u3010".concat((0,s.ZP)("common.text.result"),"\u3011").concat(t,".")}),(0,e.jsx)("span",{children:"\u3010".concat((0,s.ZP)("common.text.timeConsuming"),"\u3011").concat(r,"ms.")}),!!o&&(0,e.jsx)("span",{children:"\u3010".concat((0,s.ZP)("common.text.searchRow"),"\u3011").concat(o," ").concat((0,s.ZP)("common.text.row"),".")})]})}),Vi=K(28459),Wi={"f-icon-button":"f-icon-button___tk0Du","f-fill-absolute":"f-fill-absolute___dq5FC","f-button":"f-button___lHn_T","f-doc-en-break":"f-doc-en-break____rauj",dropdownOverlay:"dropdownOverlay___ZV2KZ","loading-animation":"loading-animation___kT75_"},We=function(n){return n.CopyCell="copy-cell",n.CopyRow="copy-row",n.CloneRow="clone-row",n.DeleteRow="delete-row",n.SetDefault="set-default",n.SetNull="set-null",n.ViewData="view-data",n}({}),Hi=(0,l.memo)(function(n){var a,t=n.children,r=n.menuList,o=l.useState(void 0),i=j()(o,2),u=i[0],c=i[1],m=l.useState(!1),f=j()(m,2),b=f[0],E=f[1];(0,l.useEffect)(function(){u===!1&&c(void 0)},[u]),(0,l.useEffect)(function(){var x=function(N){var C=N.target;C.closest("[data-chat2db-edit-table-data-can-right-click]")?E(!0):E(!1)};return document.addEventListener("contextmenu",x),function(){document.removeEventListener("contextmenu",x)}},[]);var O=(a={},W()(a,We.CopyCell,{label:(0,e.jsx)(ba,{icon:"\uEC7A",label:(0,s.ZP)("common.button.copy")}),key:We.CopyCell}),W()(a,We.CopyRow,{label:(0,e.jsx)(ba,{icon:"\uEC7A",label:(0,s.ZP)("common.button.copyRowAs")}),key:We.CopyRow,children:[{label:(0,s.ZP)("common.button.insertSql"),key:"copy-row-1"},{label:(0,s.ZP)("common.button.updateSql"),key:"copy-row-2"},{label:(0,s.ZP)("common.button.tabularSeparatedValues"),key:"copy-row-3"},{label:(0,s.ZP)("common.button.tabularSeparatedValuesFieldName"),key:"copy-row-4"},{label:(0,s.ZP)("common.button.tabularSeparatedValuesFieldNameAndData"),key:"copy-row-5"}]}),W()(a,We.CloneRow,{label:(0,e.jsx)(ba,{icon:"\uE8DB",label:(0,s.ZP)("common.button.cloneRow")}),key:We.CloneRow}),W()(a,We.DeleteRow,{label:(0,e.jsx)(ba,{icon:"\uE6A7",label:(0,s.ZP)("common.button.deleteRow")}),key:We.DeleteRow}),W()(a,We.SetDefault,{label:(0,e.jsx)(ba,{label:(0,s.ZP)("common.button.setDefault")}),key:We.SetDefault}),W()(a,We.SetNull,{label:(0,e.jsx)(ba,{label:(0,s.ZP)("common.button.setNull")}),key:We.SetNull}),W()(a,We.ViewData,{label:(0,e.jsx)(ba,{icon:"\uE788",label:(0,s.ZP)("common.button.viewData")}),key:We.ViewData}),a),T=(0,l.useMemo)(function(){return r==null?void 0:r.map(function(x){var _;return h()(h()({},O[x.key]),{},{onClick:function(){var C;(C=x.callback)===null||C===void 0||C.call(x),c(!1)},children:(_=x.children)===null||_===void 0?void 0:_.map(function(N,C){return N.hide?null:h()(h()({},O[x.key].children[C]),{},{onClick:function(){N.callback(),c(!1)}})})})})},[r]);return(0,e.jsx)(Vi.ZP,{theme:{token:{motion:!1}},children:(0,e.jsx)(Ae.Z,{menu:{items:T||[],style:T?{}:{display:"none"}},trigger:["contextMenu"],overlayClassName:Wi.dropdownOverlay,open:u&&b,onOpenChange:function(_){c(_)},children:t})})}),Gi=function(a){var t=a.tableData,r=a.setTableData,o=a.preCode,i=a.editingCell,u=a.columns,c=a.curOperationRowNo,m=a.oldDataList,f=a.updateData,b=a.setUpdateData,E=a.queryResultData,O=a.setCurOperationRowNo,T=a.setEditingCell,x=a.tableBoxRef,_=a.oldTableData,N=a.colNoCode,C=function(D,S){var M,I,L=Ye().cloneDeep(t),P=[],w=[],Z=null;if(D==="setCell"&&(typeof S=="string"||S===null)){var B=i,R=j()(B,2),g=R[0],A=R[1];Z=A,L.forEach(function(Q){Q[N]===A&&(Q[g]=S,w=Object.keys(Q).map(function(G){return Q[G]}))})}D==="setRow"&&Array.isArray(S)&&c&&(Z=c[0],S.unshift(c[0]),L.forEach(function(Q){if(Q[N]===c[0]){var G=Object.keys(Q).length;Object.keys(Q).forEach(function(z,y){y>G||(Q[z]=S[y]||null)});return}}),w=S),r(L),m.forEach(function(Q){Q[0]===Z&&(P=Q)});var V=f.findIndex(function(Q){return Q.rowId===Z});if(((M=P)===null||M===void 0?void 0:M.join(","))===((I=w)===null||I===void 0?void 0:I.join(","))){V!==-1&&b(f.filter(function(Q){return Q.rowId!==Z&&Q.type!==d.CRUD.UPDATE}));return}if(V===-1){b([].concat(_e()(f),[{type:d.CRUD.UPDATE,oldDataList:P,dataList:w,rowId:Z}]));return}var U=h()(h()({},f[V]),{},{dataList:w});U.type===d.CRUD.DELETE&&(U.type=d.CRUD.UPDATE),f[V]=U,b(_e()(f))},p=function(D){var S=Ye().cloneDeep(t),M=[{}];D?M=D:M.forEach(function(L,P){u.forEach(function(w,Z){if(w.name==="No.")L["".concat(o).concat(Z).concat(w.name)]=(S.length+P+1).toString();else{var B,R=((B=E.headerList.find(function(g){return g.name===w.name}))===null||B===void 0?void 0:B.defaultValue)!==null;if(R){L["".concat(o).concat(Z).concat(w.name)]=In.DEFAULT;return}L["".concat(o).concat(Z).concat(w.name)]=null}})}),r(S.concat(M));var I=M.map(function(L,P){return{type:d.CRUD.CREATE,dataList:Object.keys(L).map(function(w){return L[w]}),rowId:(S.length+P+1).toString()}});b([].concat(_e()(f),_e()(I))),O([(S.length+1).toString()]),T(null),setTimeout(function(){var L,P;(L=x.current)===null||L===void 0||L.scrollTo(0,((P=x.current)===null||P===void 0?void 0:P.scrollHeight)+31)},0)},v=function(){if(!(!c&&!i)){var D=c||[i[1]],S=[],M=[],I=[],L=Ye().cloneDeep(f),P=Ye().cloneDeep(t);D.forEach(function(w){var Z=!1;L.forEach(function(B){B.rowId===w&&(B.type===d.CRUD.CREATE?(Z=!0,S.push(w)):B.type===d.CRUD.UPDATE&&(Z=!0,M.push(w)))}),Z||I.push(w)}),S.forEach(function(w){L=L.filter(function(Z){return Z.rowId!==w}),P=P.filter(function(Z){return Z[N]!==w})}),M.forEach(function(w){var Z,B=(Z=L.find(function(g){return g.rowId===w}))===null||Z===void 0?void 0:Z.oldDataList;P=P.map(function(g){return g[N]===w?_.find(function(A){return g[N]===A[N]}):g});var R=L.findIndex(function(g){return g.rowId===w});L[R]=h()(h()({},L[R]),{},{type:d.CRUD.DELETE,oldDataList:B})}),I.forEach(function(w){var Z=m.find(function(B){return B[0]===w});L.push({type:d.CRUD.DELETE,oldDataList:Object.keys(Z).map(function(B){return Z[B]}),rowId:w})}),b(L),r(P),T(null),O(null)}};return{updateTableData:C,handleCreateData:p,handleDeleteData:v}},qi=Gi,Ki=function(a){var t=a.curOperationRowNo,r=a.setCurOperationRowNo,o=a.tableData,i=a.colNoCode,u=a.setFocusedContent,c=(0,l.useRef)(!1),m=(0,l.useRef)(!1),f=(0,l.useState)(null),b=j()(f,2),E=b[0],O=b[1];(0,l.useEffect)(function(){t||O(null)},[t]),(0,l.useEffect)(function(){var _=function(p){p.keyCode===16&&(c.current=!0),(p.keyCode===91||p.keyCode===17)&&(m.current=!0)},N=function(p){p.keyCode===16&&(c.current=!1),p.keyCode===91&&(m.current=!1)};return document.addEventListener("keydown",_),document.addEventListener("keyup",N),function(){document.removeEventListener("keydown",_),document.removeEventListener("keyup",N)}},[]);var T=function(N){var C=o.filter(function(v){return N.includes(v[i])}),p=C.map(function(v){var k=Ye().cloneDeep(v);return delete k[i],Object.keys(k).map(function(D){return k[D]})});u(p)},x=(0,l.useCallback)(function(_){if(_===null){r(null);return}if(c.current&&E){var N=o.findIndex(function(M){return M[i]===E}),C=o.findIndex(function(M){return M[i]===_}),p=0,v=0;N<C?(p=N,v=C):(p=C,v=N);var k=o.slice(p,v+1).map(function(M){return M[i]});r(k),T(k);return}if(m.current){if(t){if(t.includes(_)){var D=t.filter(function(M){return M!==_});r(D),T(D);return}var S=[].concat(_e()(t),[_]);r(S),T(S);return}r([_]),T([_]);return}O(_),r([_]),T([_])},[c.current,E,t]);return{multipleSelect:x}},zi=Ki,Yi=function(a){var t=a.curOperationRowNo,r=a.editingCell,o=a.updateTableData,i=(0,l.useState)(!1),u=j()(i,2),c=u[0],m=u[1];(0,l.useEffect)(function(){var f=function(E){var O=E.target;O.closest("[data-chat2db-edit-table-data-can-paste]")?m(!0):m(!1)};return document.addEventListener("click",f),document.addEventListener("contextmenu",f),function(){document.removeEventListener("click",f),document.removeEventListener("contextmenu",f)}},[]),(0,l.useEffect)(function(){var f=function(){t&&navigator.clipboard.readText().then(function(E){var O=(0,fa.wE)(E);o("setRow",O[0])}).catch(function(E){console.error("Failed to read clipboard contents: ",E)}),r&&r[2]===!1&&navigator.clipboard.readText().then(function(E){o("setCell",E)}).catch(function(E){console.error("Failed to read clipboard contents: ",E)})};return c?document.addEventListener("paste",f):document.removeEventListener("paste",f),function(){document.removeEventListener("paste",f)}},[t,r,c])},Qi=Yi,io,In=function(n){return n.DEFAULT="CHAT2DB_UPDATE_TABLE_DATA_USER_FILLED_DEFAULT",n}({}),$i=(0,Ii.ZP)($r.B)(io||(io=xi()([`
  &.supportBaseTable {
    --bgcolor: var(--color-bg-base);
    --header-bgcolor: var(--color-bg-subtle);
    --hover-bgcolor: transparent;
    --header-hover-bgcolor: var(--color-bg-subtle);
    --highlight-bgcolor: transparent;
    --header-highlight-bgcolor: var(--color-bg-subtle);
    --color: var(--color-text);
    --header-color: var(--color-text);
    --lock-shadow: rgb(37 37 37 / 0.5) 0 0 6px 2px;
    --border-color: var(--color-border-secondary);
    --cell-padding: 0px;
    --row-height: 32px;
    --lock-shadow: 0px 1px 2px 0px var(--color-border);
  }
`]))),yn="$$chat2db_",qe="".concat(yn,"0No."),Ji={pageNo:1,pageSize:200,total:0,hasNextPage:!0},Yd=l.createContext({});function Xi(n){var a,t,r,o,i=n.className,u=n.outerQueryResultData,c=n.isActive,m=n.concealTabHeader,f=(0,l.useState)(null),b=j()(f,2),E=b[0],O=b[1],T=Ge.ZP.useMessage(),x=j()(T,2),_=x[1],N=(0,l.useState)(Ji),C=j()(N,2),p=C[0],v=C[1],k=(0,l.useState)(u),D=j()(k,2),S=D[0],M=D[1],I=(0,l.useState)([]),L=j()(I,2),P=L[0],w=L[1],Z=(0,l.useState)([]),B=j()(Z,2),R=B[0],g=B[1],A=(0,l.useState)([]),V=j()(A,2),U=V[0],Q=V[1],G=(0,l.useState)(null),z=j()(G,2),y=z[0],F=z[1],q=(0,l.useState)(""),Y=j()(q,2),J=Y[0],de=Y[1],se=(0,l.useState)(null),Me=j()(se,2),oe=Me[0],ue=Me[1],Te=(0,l.useState)([]),He=j()(Te,2),Pe=He[0],Ze=He[1],Ee=(0,l.useState)(null),je=j()(Ee,2),be=je[0],De=je[1],ge=(0,l.useState)(null),Ke=j()(ge,2),fe=Ke[0],ta=Ke[1],_a=(0,l.useState)(!1),rt=j()(_a,2),Nt=rt[0],na=rt[1],Dt=l.useRef(null),ot=(0,l.useState)(!1),lt=j()(ot,2),Ht=lt[0],on=lt[1],Ya=l.useRef(null),Qa=l.useRef(null),ln=(0,l.useState)(!1),ke=j()(ln,2),Ie=ke[0],Be=ke[1],Qe=(0,l.useState)([0]),pa=j()(Qe,2),Ha=pa[0],St=pa[1],oa=function(){var ie=he()(ee()().mark(function ne(le,ve){var te;return ee()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:te=h()(h()({},n.executeSqlParams||{}),{},{sql:S.sql,originalSql:S.originalSql,exportType:le,exportSize:ve}),Oi(window._BaseURL+"/api/rdb/dml/export",te);case 2:case"end":return me.stop()}},ne)}));return function(le,ve){return ie.apply(this,arguments)}}();(0,l.useEffect)(function(){var ie=S.fuzzyTotal;if(Ye().isNumber(p.total)&&p.total!==0&&(ie=p.total),!Ye().isNumber(p.total)){var ne=Number(p.total.split("+")[0]),le=Number(S.fuzzyTotal.split("+")[0]);ne>le&&(ie=p.total)}v(h()(h()({},p),{},{total:ie,hasNextPage:S.hasNextPage}))},[S]),(0,l.useEffect)(function(){var ie;if(!(ut!=null&&ut.length))g([]);else{var ne=Jo(S.dataList);g(ne),w(ne),on(!0)}(ie=S.dataList)!==null&&ie!==void 0&&ie.length&&Q(S.dataList)},[S.dataList]);var sn=(0,l.useMemo)(function(){return[{label:(0,s.ZP)("workspace.table.export.all.csv"),key:"1",onClick:function(){oa(gn.CSV,xn.ALL)}},{label:(0,s.ZP)("workspace.table.export.all.insert"),key:"2",onClick:function(){oa(gn.INSERT,xn.ALL)}},{label:(0,s.ZP)("workspace.table.export.cur.csv"),key:"3",onClick:function(){oa(gn.CSV,xn.CURRENT_PAGE)}},{label:(0,s.ZP)("workspace.table.export.cur.insert"),key:"4",onClick:function(){oa(gn.INSERT,xn.CURRENT_PAGE)}}]},[S]),Ta=(0,l.useMemo)(function(){return(S.headerList||[]).map(function(ie){return{code:ie.name,order:"none"}})},[S.headerList]);function Gt(){var ie,ne=Qa==null||(ie=Qa.current)===null||ie===void 0?void 0:ie.getAllContent(),le=E,ve=le.rowId,te=le.colId;P.forEach(function(ce){if(ce[qe]===ve){if(ce[te]!==ne){var me=Ye().cloneDeep(R),Le=[];me.forEach(function(Ue){Ue[qe]===ve&&(Ue[te]=ne,Le=Object.keys(Ue).map(function(ct){return Ue[ct]}))}),g(me),Ze([].concat(_e()(Pe),[{type:d.CRUD.UPDATE,oldDataList:Object.keys(ce).map(function(Ue){return ce[Ue]}),dataList:Le,rowId:ve}]))}return}}),O(null)}function it(){O(null)}var Ba=function(ne,le,ve,te){(y==null?void 0:y[0])===ne&&(y==null?void 0:y[1])===le&&y!==null&&y!==void 0&&y[2]||((0,to.r)(ve),ue(null),de(ve),S.canEdit?F([ne,le,te]):F([ne,le,!1]),te&&setTimeout(function(){var ce;Ya==null||(ce=Ya.current)===null||ce===void 0||ce.focus()},0))},un=function(ne){return ne===null?(0,e.jsx)("span",{className:Ne.cellValueNull,children:"<null>"}):ne===In.DEFAULT?(0,e.jsx)("span",{className:Ne.cellValueNull,children:"<default>"}):ne||(0,e.jsx)("span",{})},ha=function(ne,le,ve){var te=[Ne.tableItem];if((y==null?void 0:y[1])===le)return te.push(Ne.tableItemHighlight),(y==null?void 0:y[0])===ve&&!(y!=null&&y[2])&&te.push(Ne.tableItemFocus),$().apply(void 0,te);if(oe!=null&&oe.includes(le))return ve===qe?te.push(Ne.tableItemHighlight):te.push(Ne.tableItemFocus),$().apply(void 0,te);var ce=Pe.findIndex(function(Ue){return Ue.rowId===le&&Ue.type===d.CRUD.CREATE});if(ce!==-1)return te.push(Ne.tableItemSuccess),$().apply(void 0,te);var me=Pe.findIndex(function(Ue){return Ue.rowId===le&&Ue.type===d.CRUD.DELETE});if(me!==-1)return te.push(Ne.tableItemError),$().apply(void 0,te);var Le="";return P.forEach(function(Ue){Ue[qe]===le&&(Le=Ue[ve])}),ne!==Le&&ve!==qe&&te.push(Ne.tableItemEdit),$().apply(void 0,te)},Jo=function(ne){var le=(ne||[]).map(function(ve){var te={};return ve.map(function(ce,me){var Le="".concat(yn).concat(me).concat(ut[me].name);te[Le]=ce}),te});return le},Lt=function(ne){var le=h()(h()({},p),{},{pageNo:ne});v(le),Kt({pageNo:ne})},Bn=function(ne){var le=h()(h()({},p),{},{pageSize:ne,pageNo:1});v(le),Kt({pageSize:ne,pageNo:1})},st=function(){var ie=he()(ee()().mark(function ne(){var le;return ee()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,ye.Z.getDMLCount(h()({sql:S.originalSql},n.executeSqlParams||{}));case 2:return le=te.sent,v(h()(h()({},p),{},{total:le})),te.abrupt("return",le);case 5:case"end":return te.stop()}},ne)}));return function(){return ie.apply(this,arguments)}}(),Un=(0,l.useMemo)(function(){var ie=[d.CRUD.CREATE,d.CRUD.UPDATE,d.CRUD.DELETE];if(oe){var ne=Pe.some(function(te){return ie.includes(te.type)&&oe.includes(te.rowId)});if(ne)return!1}if(y&&y[2]===!1){var le=U.find(function(te){return te[0]===y[1]}),ve=le==null?void 0:le[y[0]];if(ve!==J)return!1}return!0},[oe,Pe,y]),cn=function(){if(!Un){if(oe!=null&&oe.length){var ne=Pe.filter(function(Le){return!(oe!=null&&oe.includes(Le.rowId))}),le=R.map(function(Le){var Ue=P.find(function(ct){return ct[qe]===Le[qe]});return oe.includes(Le[qe])?Ue:Le});le=le.filter(function(Le){return Le}),Ze(ne),g(le),ue(null);return}if(y&&y[2]===!1){var ve=P.find(function(Le){return Le[qe]===y[1]}),te=ve[y[0]],ce=R.map(function(Le){return Le[qe]===y[1]&&(Le[y[0]]=te||""),Le}),me=ce.find(function(Le){return Le[qe]===y[1]});Ye().isEqual(me,ve)&&Ze(Pe.filter(function(Le){return Le.rowId!==y[1]})),g(ce)}}},dn=function(){Pe.length&&Tt().then(function(ne){De(ne),na(!0)})},Fn=function(){!Pe.length||Ie||(Be(!0),Tt().then(function(ne){qt(ne)}).catch(function(){Be(!1)}))},Tt=function(ne){return new Promise(function(le){var ve,te,ce,me,Le={databaseName:(ve=n.executeSqlParams)===null||ve===void 0?void 0:ve.databaseName,dataSourceId:(te=n.executeSqlParams)===null||te===void 0?void 0:te.dataSourceId,schemaName:(ce=n.executeSqlParams)===null||ce===void 0?void 0:ce.schemaName,type:(me=n.executeSqlParams)===null||me===void 0?void 0:me.databaseType,tableName:S.tableName,headerList:S.headerList,operations:ne||Pe};ye.Z.getExecuteUpdateSql(Le).then(function(Ue){le(Ue||"")})})},qt=function(ne){var le,ve,te,ce={sql:ne,dataSourceId:(le=n.executeSqlParams)===null||le===void 0?void 0:le.dataSourceId,databaseName:(ve=n.executeSqlParams)===null||ve===void 0?void 0:ve.databaseName,schemaName:(te=n.executeSqlParams)===null||te===void 0?void 0:te.schemaName,tableName:S.tableName};ye.Z.executeUpdateDataSql(ce).then(function(me){me!=null&&me.success?Kt().then(function(){Ge.ZP.success((0,s.ZP)("common.text.successfulExecution")),Ze([])}):(De(me==null?void 0:me.sql),na(!0),ta(me.message))}).finally(function(){Be(!1)})},Kt=function(ne){var le,ve,te;Be(!0),ue(null),F(null);var ce=h()({sql:S.originalSql,dataSourceId:(le=n.executeSqlParams)===null||le===void 0?void 0:le.dataSourceId,databaseName:(ve=n.executeSqlParams)===null||ve===void 0?void 0:ve.databaseName,schemaName:(te=n.executeSqlParams)===null||te===void 0?void 0:te.schemaName,pageNo:p.pageNo,pageSize:p.pageSize},ne||{});return ye.Z.executeSql(ce).then(function(me){Be(!1),M(me==null?void 0:me[0]),Ze([])})},_d=function(){Kt().then(function(){na(!1),Ge.ZP.success((0,s.ZP)("common.text.successfulExecution"))})},pd=zi({setCurOperationRowNo:ue,tableData:R,colNoCode:qe,curOperationRowNo:oe,setFocusedContent:to.r}),hd=pd.multipleSelect,Xo=function(ne){hd(ne),F(null)},ut=(0,l.useMemo)(function(){return(S.headerList||[]).map(function(ie,ne){var le=ie.dataType,ve=ie.name,te=le===ao.n.NUMERIC,ce=le===ao.n.CHAT2DB_ROW_NUMBER,me="".concat(yn).concat(ne).concat(ve);return ce?{code:qe,name:"No.",title:(0,e.jsx)("div",{className:Ne.allSelectBox,onClick:function(){if(F(null),oe){ue(null);return}var Ue=R.map(function(ct){return ct[qe]});ue(Ue)}}),key:ve,lock:!0,render:function(Ue,ct,Rt){var Pt=ct[qe];return(0,e.jsx)("div",{"data-chat2db-general-can-copy-element":!0,"data-chat2db-edit-table-data-can-paste":!0,"data-chat2db-edit-table-data-can-right-click":!0,onClick:function(){Xo(Pt)},onContextMenu:function(){oe!=null&&oe.includes(Pt)||Xo(Pt)},className:ha(Ue,Pt,qe),children:(0,e.jsx)("div",{className:Ne.tableItemNo,children:Rt+1})})}}:{code:me,name:ve,key:ve,render:function(Ue,ct){var Rt=ct[qe],Pt=un(Ue);return(0,e.jsx)("div",{"data-chat2db-general-can-copy-element":!0,"data-chat2db-edit-table-data-can-paste":!0,"data-chat2db-edit-table-data-can-right-click":!0,className:ha(Ue,Rt,me),onClick:Ba.bind(null,me,Rt,Ue,!1),onDoubleClick:Ba.bind(null,me,Rt,Ue,!0),onContextMenu:Ba.bind(null,me,Rt,Ue,!1),children:(y==null?void 0:y[0])===me&&(y==null?void 0:y[1])===Rt&&y!==null&&y!==void 0&&y[2]?(0,e.jsx)(xe.Z,{ref:Ya,value:eo(J),onChange:function(yd){de(yd.target.value)},onBlur:function(){F([y[0],y[1],!1]),Vn("setCell",J)}}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:Ne.tableItemContent,children:Pt}),(0,e.jsx)("div",{className:Ne.previewTableItemContent,children:Pt})]})})},features:{sortable:te?Ai:!0}}})},[S.headerList,y,J,oe,U]),Nr=qi({tableData:R,setTableData:g,preCode:yn,editingCell:y,columns:ut,curOperationRowNo:oe,oldDataList:U,updateData:Pe,setUpdateData:Ze,queryResultData:S,setCurOperationRowNo:ue,setEditingCell:F,tableBoxRef:Dt,oldTableData:P,colNoCode:qe}),Vn=Nr.updateTableData,el=Nr.handleCreateData,al=Nr.handleDeleteData;Qi({updateTableData:Vn,curOperationRowNo:oe,editingCell:y});var bd=(0,$r.u)().input({dataSource:R,columns:ut}).use(Jr.R2.sort({mode:"single",defaultSorts:Ta,highlightColumnWhenActive:!0})).use(Jr.R2.columnResize({fallbackSize:150,handleHoverBackground:"var(--color-primary-bg-hover)",handleActiveBackground:"var(--color-primary-bg-hover)",minSize:60,maxSize:1080,sizes:Ha,onChangeSizes:function(ne){ne[0]=0,St(ne)}})),Nd=function(){if(!oe&&!y)return[[]];var ne=oe||[y==null?void 0:y[1]],le=R.filter(function(te){return ne.includes(te[qe])}),ve=le.map(function(te){var ce=Ye().cloneDeep(te);return delete ce[qe],Object.keys(ce).map(function(me){return ce[me]})});return ve},tl={key:We.CopyRow,children:[{callback:function(){var ne=oe||[y[1]],le=R.filter(function(ce){return ne.includes(ce[qe])}),ve=le.map(function(ce){var me=Ye().cloneDeep(ce);return Object.keys(me).map(function(Le){return me[Le]})}),te=ve.map(function(ce,me){return{type:d.CRUD.CREATE,dataList:ce,rowId:(R.length+me+1).toString()}});Tt(te).then(function(ce){(0,fa.JG)(ce)})},hide:!S.canEdit},{callback:function(){var ne=oe||[y[1]],le=R.filter(function(ce){return ne.includes(ce[qe])}),ve=le.map(function(ce){var me=Ye().cloneDeep(ce);return Object.keys(me).map(function(Le){return me[Le]})}),te=ve.map(function(ce,me){return{type:d.CRUD.UPDATE_COPY,dataList:ce,rowId:(R.length+me+1).toString()}});Tt(te).then(function(ce){(0,fa.JG)(ce)})},hide:!S.canEdit},{callback:function(){var ne=Nd();(0,fa.UY)(ne)}},{callback:function(){var ne=S.headerList.map(function(le){return le.name});ne.splice(0,1),(0,fa.UY)([ne])}},{callback:function(){var ne=oe||[y[1]],le=R.filter(function(ce){return ne.includes(ce[qe])}),ve=le.map(function(ce){var me=Ye().cloneDeep(ce);return delete me[qe],Object.keys(me).map(function(Le){return me[Le]})}),te=S.headerList.map(function(ce){return ce.name});te.splice(0,1),(0,fa.UY)([te].concat(_e()(ve)))}}]},nl={key:We.CloneRow,callback:function(){var ne=Ye().cloneDeep(R),le=oe||[y[1]],ve=ne.filter(function(te){return le.includes(te[qe])});ve.map(function(te,ce){te[qe]=(ne.length+ce+1).toString()}),el(ve)}},rl={key:We.DeleteRow,callback:al},Sd={key:We.CopyCell,callback:function(){(0,fa.JG)(J)}},Td={key:We.SetDefault,callback:function(){Vn("setCell",In.DEFAULT)}},Ed={key:We.SetNull,callback:function(){Vn("setCell",null)}},Cd={key:We.ViewData,callback:function(){O({name:ut.find(function(ne){return ne.code===y[0]}).name,value:J,colId:y[0],rowId:y[1]})}},gd=(0,l.useMemo)(function(){var ie=[];if(oe&&(ie=[tl,nl,rl],S.canEdit||(ie=ie.filter(function(te){return te.key!==We.CloneRow&&te.key!==We.DeleteRow}))),y){var ne;ie=[Cd,Sd,tl,nl,Ed,Td,rl];var le=y[0],ve=((ne=S.headerList.find(function(te){var ce;return te.name===((ce=ut.find(function(me){return me.code===le}))===null||ce===void 0?void 0:ce.name)}))===null||ne===void 0?void 0:ne.defaultValue)!==null;ve||(ie=ie.filter(function(te){return te.key!==We.SetDefault})),S.canEdit||(ie=ie.filter(function(te){return te.key!==We.CloneRow&&te.key!==We.DeleteRow&&te.key!==We.SetNull}))}return!oe&&!y?null:ie},[oe,y,S]),xd=function(){var ne=(0,e.jsxs)("div",{className:Ne.statusBar,children:[(0,e.jsx)("span",{children:"\u3010".concat((0,s.ZP)("common.text.result"),"\u3011").concat(S.description,".")}),(0,e.jsx)("span",{children:"\u3010".concat((0,s.ZP)("common.text.timeConsuming"),"\u3011").concat(S.duration,"ms.")}),(0,e.jsx)("span",{children:"\u3010".concat((0,s.ZP)("common.text.searchRow"),"\u3011").concat(R.length," ").concat((0,s.ZP)("common.text.row"),".")})]});return ut.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:Ne.toolBar,children:[(0,e.jsx)("div",{className:Ne.toolBarItem,children:(0,e.jsx)(Ui,{paginationConfig:p,onPageNoChange:Lt,onPageSizeChange:Bn,onClickTotalBtn:st})}),(0,e.jsx)("div",{className:$()(Ne.toolBarItem,Ne.refreshBar),children:(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("common.button.refresh"),trigger:"hover",children:(0,e.jsx)("div",{onClick:function(){Kt()},className:$()(Ne.refreshIconBox),children:(0,e.jsx)(X.Z,{code:"\uE62D"})})})}),S.canEdit&&(0,e.jsxs)("div",{className:$()(Ne.toolBarItem,Ne.editTableDataBar),children:[(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("editTableData.tips.addRow"),trigger:"hover",children:(0,e.jsx)("div",{onClick:function(){el()},className:$()(Ne.createDataBar,Ne.editTableDataBarItem),children:(0,e.jsx)(X.Z,{code:"\uE61B"})})}),(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("editTableData.tips.deleteRow"),trigger:"hover",children:(0,e.jsx)("div",{onClick:function(){al()},className:$()(Ne.deleteDataBar,Ne.editTableDataBarItem,W()({},Ne.disableBar,oe===null)),children:(0,e.jsx)(X.Z,{code:"\uE644"})})}),(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("editTableData.tips.revert"),trigger:"hover",children:(0,e.jsx)("div",{onClick:cn,className:$()(Ne.revokeBar,Ne.editTableDataBarItem,W()({},Ne.disableBar,Un)),children:(0,e.jsx)(X.Z,{code:"\uE6E2"})})}),(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("editTableData.tips.previewPendingChanges"),trigger:"hover",children:(0,e.jsx)("div",{onClick:dn,className:$()(Ne.viewSqlBar,Ne.editTableDataBarItem,W()({},Ne.disableBar,!Pe.length)),children:(0,e.jsx)(X.Z,{code:"\uE654"})})}),(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:(0,s.ZP)("editTableData.tips.submit"),trigger:"hover",children:(0,e.jsx)("div",{onClick:Fn,className:$()(Ne.updateSubmitBar,Ne.editTableDataBarItem,W()({},Ne.disableBar,!Pe.length)),children:(0,e.jsx)(X.Z,{code:"\uE687"})})})]}),(0,e.jsx)("div",{className:Ne.toolBarRight,children:(0,e.jsx)(Ae.Z,{menu:{items:sn},trigger:["click"],children:(0,e.jsxs)(Qr.Z,{className:Ne.exportBar,children:[(0,s.ZP)("common.text.export"),(0,e.jsx)(ki.Z,{})]})})})]}),m&&(0,e.jsx)(Pi,{getTableData:Kt,promptWord:S.headerList}),c?(0,e.jsx)(Hi,{menuList:gd,children:(0,e.jsx)("div",{ref:Dt,className:$()(Ne.supportBaseTableBox,W()({},Ne.supportBaseTableBoxHidden,Ie)),children:Ht&&(0,e.jsxs)(e.Fragment,{children:[Ie&&(0,e.jsx)(mt.Z,{className:Ne.supportBaseTableSpin}),(0,e.jsx)($i,h()({className:$()("supportBaseTable",n.className,Ne.table),components:{EmptyContent:function(){return(0,e.jsx)("h2",{children:(0,s.ZP)("common.text.noData")})}},isStickyHead:!0,stickyTop:31},bd.getProps()))]})})}):(0,e.jsx)("div",{className:Ne.supportBaseTableBox}),(0,e.jsx)(lo,{description:S.description,duration:S.duration,dataLength:R.length})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(en,{state:"success",text:(0,s.ZP)("common.text.successfulExecution")}),(0,e.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0},children:ne})]})},Id=(0,l.useMemo)(function(){return(0,e.jsx)("div",{className:Ne.monacoEditor,children:(0,e.jsx)(gt,{ref:Qa,id:"view_table-Cell_data-".concat((0,Ce.Z)()),appendValue:{text:eo(E==null?void 0:E.value),range:"reset"},language:"plaintext",options:{lineNumbers:"off",readOnly:!S.canEdit}})})},[S,E]);return(0,e.jsxs)("div",{className:$()(i,Ne.tableBox,W()({},Ne.noDataTableBox,!R.length)),children:[xd(),(0,e.jsx)(Aa.Z,{title:E==null?void 0:E.name,open:!!(E!=null&&E.name),onCancel:it,width:"60vw",maskClosable:!1,destroyOnClose:!0,footer:S.canEdit&&[(0,e.jsx)(Oe.ZP,{type:"primary",onClick:Gt,children:(0,s.ZP)("common.button.modify")},"1")],children:Id}),(0,e.jsx)(Aa.Z,{width:"60vw",maskClosable:!1,title:fe?(0,s.ZP)("common.button.executionError"):(0,s.ZP)("editTable.title.sqlPreview"),open:Nt,footer:!1,destroyOnClose:!0,onCancel:function(){na(!1),De(""),ta(null)},children:(0,e.jsx)(ro,{initError:fe,initSql:be,databaseName:(a=n.executeSqlParams)===null||a===void 0?void 0:a.databaseName,dataSourceId:(t=n.executeSqlParams)===null||t===void 0?void 0:t.dataSourceId,tableName:S.tableName,schemaName:(r=n.executeSqlParams)===null||r===void 0?void 0:r.schemaName,databaseType:(o=n.executeSqlParams)===null||o===void 0?void 0:o.databaseType,executeSuccessCallBack:_d,executeSqlApi:"executeUpdateDataSql"})}),_]})}var Za={"f-icon-button":"f-icon-button___HhRrh","f-fill-absolute":"f-fill-absolute___w46Dk","f-button":"f-button___YzTtO","f-doc-en-break":"f-doc-en-break___LhvyQ",searchResult:"searchResult____uel6",tabs:"tabs___lYrkB",recordIcon:"recordIcon___mTREY",statusIcon:"statusIcon___TbujV",successIcon:"successIcon___pJyvT",failIcon:"failIcon___ZZLop",tableIndex:"tableIndex___P8fxN",monacoEditor:"monacoEditor____QrbX",cursorStateIndicator:"cursorStateIndicator___zroiL",noData:"noData___ObOP2",outputPrefixIcon:"outputPrefixIcon___PrkKu",stateIndicator:"stateIndicator___lRL1r",updateCountBox:"updateCountBox___ALTCv",successResult:"successResult___NDhDw",successResultContent:"successResultContent___iPtDv",updateCount:"updateCount___SJCdG",tableLoading:"tableLoading___r0M8G",stopExecuteSql:"stopExecuteSql___Ko_Iz","loading-animation":"loading-animation___HtnjN"},es=Object.defineProperty,so=Object.getOwnPropertySymbols,as=Object.prototype.hasOwnProperty,ts=Object.prototype.propertyIsEnumerable,uo=(n,a,t)=>a in n?es(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,ns=(n,a)=>{for(var t in a||(a={}))as.call(a,t)&&uo(n,t,a[t]);if(so)for(var t of so(a))ts.call(a,t)&&uo(n,t,a[t]);return n};const Qd=n=>React.createElement("svg",ns({width:80,height:80,xmlns:"http://www.w3.org/2000/svg"},n),React.createElement("title",null,"\u7F16\u7EC4 27\u5907\u4EFD"),React.createElement("g",{fill:"none",fillRule:"evenodd"},React.createElement("path",{d:"M0 0h80v80H0z"}),React.createElement("path",{d:"m30.564 38.568-7.86-4.302c-.301-.21-.689-.255-1.03-.117-.306.125-.578.32-.793.57a1.186 1.186 0 0 0 .456 1.698l7.86 4.302c.301.21.688.255 1.029.118.308-.121.581-.318.793-.571a.86.86 0 0 0 .118-.907 1.009 1.009 0 0 0-.573-.79Zm33.72-5.546a1.22 1.22 0 0 0-1.264 0c-.398.228-.62.673-.558 1.127v15.877L40.819 62.275V39.71c0-.234-.117-.351-.117-.571l22.436-12.468c.427-.22.694-.661.69-1.141a1.358 1.358 0 0 0-.808-1.127L40.011 13.165a1.054 1.054 0 0 0-1.131 0L15.753 24.403a1.41 1.41 0 0 0-.793 1.127v.234a.224.224 0 0 1-.118.22V50.48c.172.465.492.861.911 1.127L38.645 65.45c.248.135.525.21.808.22.242-.008.476-.084.676-.22l24.155-13.61a1.42 1.42 0 0 0 .558-1.14V34.148c.008-.443-.2-.863-.558-1.127ZM38.086 39.71v22.33L17.693 49.792V27.681l20.511 11.458a.98.98 0 0 0-.118.57Zm1.25-2.956-20.16-11.107 20.16-9.98 20.158 9.863-20.159 11.224Z",fill:"#666",fillRule:"nonzero"}),React.createElement("path",{stroke:"#DCDCDC",strokeWidth:2,strokeLinecap:"round",d:"M17.386 69.431h35.491M17.386 74.431h16.209"}),React.createElement("path",{d:"M58.535 13.477a1.255 1.255 0 0 1-1.134-.299 1.071 1.071 0 0 1-.353-.798c0-.3.126-.59.353-.798l3.123-3.102c.21-.224.496-.35.806-.35.311 0 .597.126.807.35.226.208.352.49.352.798 0 .3-.126.59-.352.799l-3.124 3.101c-.193.191-.285.283-.478.283M65.537 20.711a.937.937 0 0 1-.479.1l-3.971-.465a1.133 1.133 0 0 1-1.041-1.223c.05-.623.604-1.08 1.234-1.03l3.972.373c.63.059 1.091.599 1.04 1.223 0 .465-.302.881-.755 1.022M51.81 11.98c-.286.1-.605.067-.874-.074a1.12 1.12 0 0 1-.546-.674l-1.327-3.758a1.118 1.118 0 0 1 .664-1.414c.285-.1.604-.074.873.067.269.141.47.382.554.673l1.327 3.759a1.03 1.03 0 0 1-.009.848c-.126.274-.37.474-.663.574",fill:"#DCDCDC"})));var rs="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMCAwaDgwdjgwSDB6Ii8+PHBhdGggZD0ibTMwLjU2NCAzOC41NjgtNy44Ni00LjMwMmMtLjMwMS0uMjEtLjY4OS0uMjU1LTEuMDMtLjExNy0uMzA2LjEyNS0uNTc4LjMyLS43OTMuNTdhMS4xODYgMS4xODYgMCAwIDAgLjQ1NiAxLjY5OGw3Ljg2IDQuMzAyYy4zMDEuMjEuNjg4LjI1NSAxLjAyOS4xMTguMzA4LS4xMjEuNTgxLS4zMTguNzkzLS41NzFhLjg2Ljg2IDAgMCAwIC4xMTgtLjkwNyAxLjAwOSAxLjAwOSAwIDAgMC0uNTczLS43OVptMzMuNzItNS41NDZhMS4yMiAxLjIyIDAgMCAwLTEuMjY0IDBjLS4zOTguMjI4LS42Mi42NzMtLjU1OCAxLjEyN3YxNS44NzdMNDAuODE5IDYyLjI3NVYzOS43MWMwLS4yMzQtLjExNy0uMzUxLS4xMTctLjU3MWwyMi40MzYtMTIuNDY4Yy40MjctLjIyLjY5NC0uNjYxLjY5LTEuMTQxYTEuMzU4IDEuMzU4IDAgMCAwLS44MDgtMS4xMjdMNDAuMDExIDEzLjE2NWExLjA1NCAxLjA1NCAwIDAgMC0xLjEzMSAwTDE1Ljc1MyAyNC40MDNhMS40MSAxLjQxIDAgMCAwLS43OTMgMS4xMjd2LjIzNGEuMjI0LjIyNCAwIDAgMS0uMTE4LjIyVjUwLjQ4Yy4xNzIuNDY1LjQ5Mi44NjEuOTExIDEuMTI3TDM4LjY0NSA2NS40NWMuMjQ4LjEzNS41MjUuMjEuODA4LjIyLjI0Mi0uMDA4LjQ3Ni0uMDg0LjY3Ni0uMjJsMjQuMTU1LTEzLjYxYTEuNDIgMS40MiAwIDAgMCAuNTU4LTEuMTRWMzQuMTQ4Yy4wMDgtLjQ0My0uMi0uODYzLS41NTgtMS4xMjdaTTM4LjA4NiAzOS43MXYyMi4zM0wxNy42OTMgNDkuNzkyVjI3LjY4MWwyMC41MTEgMTEuNDU4YS45OC45OCAwIDAgMC0uMTE4LjU3Wm0xLjI1LTIuOTU2LTIwLjE2LTExLjEwNyAyMC4xNi05Ljk4IDIwLjE1OCA5Ljg2My0yMC4xNTkgMTEuMjI0WiIgZmlsbD0iIzY2NiIgZmlsbC1ydWxlPSJub256ZXJvIi8+PHBhdGggc3Ryb2tlPSIjRENEQ0RDIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTE3LjM4NiA2OS40MzFoMzUuNDkxTTE3LjM4NiA3NC40MzFoMTYuMjA5Ii8+PHBhdGggZD0iTTU4LjUzNSAxMy40NzdhMS4yNTUgMS4yNTUgMCAwIDEtMS4xMzQtLjI5OSAxLjA3MSAxLjA3MSAwIDAgMS0uMzUzLS43OThjMC0uMy4xMjYtLjU5LjM1My0uNzk4bDMuMTIzLTMuMTAyYy4yMS0uMjI0LjQ5Ni0uMzUuODA2LS4zNS4zMTEgMCAuNTk3LjEyNi44MDcuMzUuMjI2LjIwOC4zNTIuNDkuMzUyLjc5OCAwIC4zLS4xMjYuNTktLjM1Mi43OTlsLTMuMTI0IDMuMTAxYy0uMTkzLjE5MS0uMjg1LjI4My0uNDc4LjI4M002NS41MzcgMjAuNzExYS45MzcuOTM3IDAgMCAxLS40NzkuMWwtMy45NzEtLjQ2NWExLjEzMyAxLjEzMyAwIDAgMS0xLjA0MS0xLjIyM2MuMDUtLjYyMy42MDQtMS4wOCAxLjIzNC0xLjAzbDMuOTcyLjM3M2MuNjMuMDU5IDEuMDkxLjU5OSAxLjA0IDEuMjIzIDAgLjQ2NS0uMzAyLjg4MS0uNzU1IDEuMDIyTTUxLjgxIDExLjk4Yy0uMjg2LjEtLjYwNS4wNjctLjg3NC0uMDc0YTEuMTIgMS4xMiAwIDAgMS0uNTQ2LS42NzRsLTEuMzI3LTMuNzU4YTEuMTE4IDEuMTE4IDAgMCAxIC42NjQtMS40MTRjLjI4NS0uMS42MDQtLjA3NC44NzMuMDY3LjI2OS4xNDEuNDcuMzgyLjU1NC42NzNsMS4zMjcgMy43NTlhMS4wMyAxLjAzIDAgMCAxLS4wMDkuODQ4Yy0uMTI2LjI3NC0uMzcuNDc0LS42NjMuNTc0IiBmaWxsPSIjRENEQ0RDIi8+PC9nPjwvc3ZnPg==",os={pageNo:1,pageSize:200,total:0,hasNextPage:!0},co=(0,l.createContext)({}),mo=(0,l.forwardRef)(function(n,a){var t=n.className,r=n.sql,o=n.executeSqlParams,i=n.concealTabHeader,u=n.viewTable,c=n.isActive,m=(0,l.useState)(),f=j()(m,2),b=f[0],E=f[1],O=(0,l.useState)(!1),T=j()(O,2),x=T[0],_=T[1],N=(0,l.useRef)(),C=(0,l.useState)(""),p=j()(C,2),v=p[0],k=p[1],D=(0,l.useState)(""),S=j()(D,2),M=S[0],I=S[1];(0,l.useEffect)(function(){r&&L(r)},[r]),(0,l.useImperativeHandle)(a,function(){return{handleExecuteSQL:L}});var L=function(A){_(!0);var V=u?ye.Z.viewTable:ye.Z.executeSql,U=h()(h()(h()({sql:A,tableName:o==null?void 0:o.tableName},os),o),{},{type:o.databaseType});N.current=new AbortController,V(U,{signal:N.current.signal}).then(function(Q){var G=Q.map(function(z){return h()(h()({},z),{},{uuid:(0,Ce.Z)()})});E(G),M||I(A)}).finally(function(){_(!1)})},P=(0,l.useCallback)(function(g){k(g)},[]),w=function(A){function V(){var U,Q,G=(A==null||(U=A.headerList)===null||U===void 0?void 0:U.length)>1;return(0,e.jsx)("div",{className:Za.successResult,children:(0,e.jsx)("div",{className:Za.successResultContent,children:G?(0,e.jsx)(Xi,{isActive:c,tableBoxId:A.uuid,outerQueryResultData:A,executeSqlParams:n.executeSqlParams,concealTabHeader:i},A.uuid):(0,e.jsxs)("div",{className:Za.updateCountBox,children:[(0,e.jsx)("div",{className:Za.updateCount,children:(0,s.ZP)("common.text.affectedRows",A.updateCount)}),(0,e.jsx)(lo,{dataLength:A==null||(Q=A.dataList)===null||Q===void 0?void 0:Q.length,duration:A.duration,description:A.description})]})})})}return(0,e.jsx)(l.Fragment,{children:A.success?V():(0,e.jsx)(en,{className:Za.stateIndicator,state:"error",text:A.message},A.uuid)},A.uuid)},Z=(0,l.useMemo)(function(){return b==null?void 0:b.map(function(g,A){return{prefixIcon:(0,e.jsx)(X.Z,{className:$()(Za[g.success?"successIcon":"failIcon"],Za.statusIcon),code:g.success?"\uE605":"\uE87C"},A),popover:g.originalSql,label:(0,s.ZP)("common.text.executionResult",A+1),key:g.uuid,children:w(g)}})},[b,c]),B=(0,l.useCallback)(function(g,A){if(g==="remove"){var V=b==null?void 0:b.filter(function(U){return A.findIndex(function(Q){return Q.key===U.uuid})===-1});E(V)}},[b]),R=function(){N.current&&N.current.abort(),E([]),_(!1)};return(0,e.jsx)(co.Provider,{value:{activeTabId:v,notChangedSql:M},children:(0,e.jsx)("div",{className:$()(t,Za.searchResult),children:x?(0,e.jsxs)("div",{className:Za.tableLoading,children:[(0,e.jsx)(mt.Z,{}),(0,e.jsx)("div",{className:Za.stopExecuteSql,onClick:R,children:(0,s.ZP)("common.button.cancelRequest")})]}):(0,e.jsx)(e.Fragment,{children:Z!=null&&Z.length?(0,e.jsx)(Yr,{hideAdd:!0,className:Za.tabs,onChange:P,onEdit:B,items:Z,concealTabHeader:i,destroyInactiveTabPane:!0}):(0,e.jsxs)("div",{className:Za.noData,children:[(0,e.jsx)("img",{src:rs}),(0,e.jsx)("p",{children:(0,s.ZP)("common.text.noData")})]})})})})}),Xa={"f-icon-button":"f-icon-button___cIiVt","f-fill-absolute":"f-fill-absolute___ylxf5","f-button":"f-button___JPJ3K","f-doc-en-break":"f-doc-en-break___hGpXJ",box:"box___P8OuR",header:"header___D03RB",tabList:"tabList___RjVRE",tabItem:"tabItem___JOi2Q",currentTab:"currentTab___B2lt5",main:"main___U9Adb",tab:"tab___hR_H3",hidden:"hidden___cX_jN",monacoEditorModal:"monacoEditorModal___BYH8D",monacoEditorHeader:"monacoEditorHeader___m6Uyp",formatButton:"formatButton___OqkS6",executeButton:"executeButton___PtB_t",monacoEditorContent:"monacoEditorContent___GfDPB",monacoEditor:"monacoEditor___V8hU0",result:"result___KUeZ6",resultHeader:"resultHeader___M0jod",resultContent:"resultContent___P8zO_",errorTitle:"errorTitle___L0voz",errorMessage:"errorMessage___UKbzu","loading-animation":"loading-animation___MdycB"},ka={"f-icon-button":"f-icon-button___PcVZ1","f-fill-absolute":"f-fill-absolute___YyCSx","f-button":"f-button___Sm3lW","f-doc-en-break":"f-doc-en-break___LiMRy",indexList:"indexList___F5Tvj",indexListHeader:"indexListHeader___ySyyT",formBox:"formBox___FJqp6",tableBox:"tableBox___IC9MG",addColumnButton:"addColumnButton___pJpNk",editableCell:"editableCell___Te3By",columnListCell:"columnListCell___Iqq5f",operationBar:"operationBar___V2oD5",deleteIconBox:"deleteIconBox___vyW0B","loading-animation":"loading-animation___ijXrA"},fo=K(60532),vo=K(60887),_o=K(32339),vt=K(45587),po=K(24285),et=K(51805),_t={"f-icon-button":"f-icon-button___g0hZM","f-fill-absolute":"f-fill-absolute___blNO7","f-button":"f-button___oEgLK","f-doc-en-break":"f-doc-en-break___w7QJN",includeCol:"includeCol___Fopyg","ant-input-number":"ant-input-number___Gw80Q",formBox:"formBox___AYaxP",indexListHeader:"indexListHeader___hGbPX",editableCell:"editableCell___MqrSn",operationBar:"operationBar___B_jhN",deleteIconBox:"deleteIconBox___jThye","loading-animation":"loading-animation___KUMCG"},ho=function(){return{key:(0,Ce.Z)(),ascOrDesc:null,cardinality:null,collation:null,columnName:null,comment:null,filterCondition:null,indexName:null,indexQualifier:null,nonUnique:null,ordinalPosition:null,schemaName:null,type:null,pages:null,databaseName:null,tableName:null}},ls=(0,l.forwardRef)(function(n,a){var t=n.includedColumnList,r=(0,l.useContext)(nn),o=r.columnListRef,i=r.databaseType,u=(0,l.useState)([ho()]),c=j()(u,2),m=c[0],f=c[1],b=re.Z.useForm(),E=j()(b,1),O=E[0],T=(0,l.useState)(null),x=j()(T,2),_=x[0],N=x[1],C=function(w){return w.key===_},p=(0,l.useRef)(null);(0,l.useEffect)(function(){t.length&&f(t.map(function(P){return h()(h()({},P),{},{key:(0,Ce.Z)()})}))},[t]);var v=(0,l.useMemo)(function(){var P,w=(P=o.current)===null||P===void 0||(P=P.getColumnListInfo())===null||P===void 0?void 0:P.filter(function(Z){return Z.name!==null});return w||[]},[]),k=function(w){O.setFieldsValue(h()({},w)),N(w.key||null)},D=function(){var w=ho();f([].concat(_e()(m),[w])),k(w),setTimeout(function(){var Z,B;(Z=p.current)===null||Z===void 0||Z.scrollTo(0,((B=p.current)===null||B===void 0?void 0:B.scrollHeight)+100)},0)},S=function(w){f(m.filter(function(Z){return Z.key!==w.key}))},M=[{title:(0,s.ZP)("editTable.label.index"),dataIndex:"index",width:"50px",align:"center",render:function(w,Z){return m.findIndex(function(B){return B.key===Z.key})+1}},{title:(0,s.ZP)("editTable.label.columnName"),dataIndex:"columnName",render:function(w,Z){var B=C(Z);return B?(0,e.jsx)(re.Z.Item,{name:"columnName",style:{margin:0},children:(0,e.jsx)(aa.Z,{options:v.map(function(R){return{label:R.name,value:R.name}})})}):(0,e.jsx)("div",{className:_t.editableCell,onClick:function(){return k(Z)},children:w})}},{title:(0,s.ZP)("editTable.label.order"),dataIndex:"ascOrDesc",render:function(w,Z){var B=C(Z);return B?(0,e.jsx)(re.Z.Item,{name:"ascOrDesc",style:{margin:0},children:(0,e.jsx)(aa.Z,{options:[{label:"ASC",value:"ASC"},{label:"DESC",value:"DESC"}]})}):(0,e.jsx)("div",{className:_t.editableCell,onClick:function(){return k(Z)},children:w})}},{width:"40px",render:function(w,Z){return(0,e.jsx)("div",{className:_t.operationBar,onClick:function(){S(Z)},children:(0,e.jsx)("div",{className:_t.deleteIconBox,children:(0,e.jsx)(X.Z,{code:"\uE64E"})})})}}];i===d.DatabaseTypeCode.SQLITE&&M.splice(2,0,{title:(0,s.ZP)("editTable.label.collation"),dataIndex:"collation",render:function(w,Z){var B=C(Z);return B?(0,e.jsx)(re.Z.Item,{name:"collation",style:{margin:0},children:(0,e.jsx)(aa.Z,{options:[{label:"BINARY",value:"BINARY"},{label:"NOCASE",value:"NOCASE"},{label:"RTRIM",value:"RTRIM"}]})}):(0,e.jsx)("div",{className:_t.editableCell,onClick:function(){return k(Z)},children:w})}});var I=function(w){var Z=w[0].value,B=w[0].name,R=B[0],g=m.map(function(A){return A.key===_?h()(h()({},A),{},W()({},R,Z)):A});f(g)},L=function(){return m.map(function(w){return Ye().omit(w,"key")}).filter(function(w){return w.columnName})};return(0,l.useImperativeHandle)(a,function(){return{getIncludeColInfo:L}}),(0,e.jsxs)("div",{className:$()(_t.includeCol),children:[(0,e.jsx)("div",{className:_t.indexListHeader,children:(0,e.jsx)(Oe.ZP,{onClick:D,children:(0,s.ZP)("editTable.button.add")})}),(0,e.jsx)(re.Z,{className:_t.formBox,form:O,onFieldsChange:I,children:(0,e.jsx)(et.Z,{ref:p,style:{maxHeight:"100%",overflow:"auto"},sticky:!0,pagination:!1,rowKey:"key",columns:M,dataSource:m})})]})}),is=ls,ss=["children"],bo=function(){return{key:(0,Ce.Z)(),columnList:[],name:"",type:null,comment:null,editStatus:d.EditColumnOperationType.Add}},us=function(a){var t=a.children,r=ir()(a,ss),o=(0,vt.nB)({id:r["data-row-key"]}),i=o.attributes,u=o.listeners,c=o.setNodeRef,m=o.setActivatorNodeRef,f=o.transform,b=o.transition,E=o.isDragging,O=h()(h()({},r.style),{},{transform:po.ux.Transform.toString(f&&h()(h()({},f),{},{scaleY:1})),transition:b},E?{position:"relative",zIndex:9999}:{});return(0,e.jsx)("tr",h()(h()(h()({},r),{},{ref:c,style:O},i),{},{children:l.Children.map(t,function(T){return T.key==="sort"?l.cloneElement(T,{children:(0,e.jsx)(fo.Z,h()({ref:m,style:{touchAction:"none",cursor:"move"}},u))}):T})}))},cs=(0,l.forwardRef)(function(n,a){var t=(0,l.useContext)(nn),r=t.databaseSupportField,o=t.tableDetails,i=t.databaseType,u=(0,l.useState)([bo()]),c=j()(u,2),m=c[0],f=c[1],b=(0,l.useState)([]),E=j()(b,2),O=E[0],T=E[1],x=re.Z.useForm(),_=j()(x,1),N=_[0],C=(0,l.useState)(null),p=j()(C,2),v=p[0],k=p[1],D=(0,l.useState)(!1),S=j()(D,2),M=S[0],I=S[1],L=(0,l.useRef)(null),P=(0,l.useRef)(null),w=function(F){return F.key===(v==null?void 0:v.key)},Z=function(F){N.setFieldsValue(h()({},F)),F.key!==(v==null?void 0:v.key)&&k(F||null)};(0,l.useEffect)(function(){var y,F=(y=o.indexList)===null||y===void 0?void 0:y.map(function(q){var Y=(0,Ce.Z)();return h()(h()({},q),{},{oldName:q.name,key:Y})});T(Ye().cloneDeep(F)||[]),f(Ye().cloneDeep(F)||[])},[o]);var B=function(){var F=bo();f([].concat(_e()(m),[F])),Z(F),setTimeout(function(){var q,Y;(q=P.current)===null||q===void 0||q.scrollTo(0,((Y=P.current)===null||Y===void 0?void 0:Y.scrollHeight)+100)},0)},R=function(F){var q,Y=m==null||(q=m.map(function(J){return J.key===(F==null?void 0:F.key)?(k(null),J.editStatus===d.EditColumnOperationType.Add?null:h()(h()({},J),{},{editStatus:d.EditColumnOperationType.Delete})):J}))===null||q===void 0?void 0:q.filter(function(J){return J});f(Y||[])},g=function(F){var q=F[0].value,Y=F[0].name,J=Y[0];J==="nullable"&&(q=q?1:0);var de=m.map(function(se){if(se.key===(v==null?void 0:v.key)){var Me,oe=se.editStatus;return oe!==d.EditColumnOperationType.Add&&(oe=d.EditColumnOperationType.Modify),h()(h()({},se),{},(Me={},W()(Me,J,q),W()(Me,"editStatus",oe),Me))}return se});f(de)},A=function(F){var q=F.active,Y=F.over;q.id!==(Y==null?void 0:Y.id)&&f(function(J){var de=J.findIndex(function(Me){return Me.key===q.id}),se=J.findIndex(function(Me){return Me.key===(Y==null?void 0:Y.id)});return(0,vt.Rp)(J,de,se)})};function V(){return m.map(function(y){return Ye().omit(y,"key")})}(0,l.useImperativeHandle)(a,function(){return{getIndexListInfo:V}});var U=(0,l.useMemo)(function(){var y=[{key:"sort",width:"40px",align:"center",fixed:"left"},{title:(0,s.ZP)("editTable.label.indexName"),dataIndex:"name",width:"180px",fixed:"left",render:function(q,Y){var J=w(Y);return J?(0,e.jsx)(re.Z.Item,{name:"name",style:{margin:0},children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}):(0,e.jsx)("div",{className:ka.editableCell,children:q})}},{title:(0,s.ZP)("editTable.label.indexType"),dataIndex:"type",width:"100px",render:function(q,Y){var J,de=w(Y);return de?(0,e.jsx)(re.Z.Item,{name:"type",style:{margin:0},children:(0,e.jsx)(aa.Z,{style:{width:"100%"},children:r==null||(J=r.indexTypes)===null||J===void 0?void 0:J.map(function(se){return(0,e.jsx)(aa.Z.Option,{value:se.value,children:se.label},se.value)})})}):(0,e.jsx)("div",{className:ka.editableCell,children:q})}},{title:(0,s.ZP)("editTable.label.includeColumn"),dataIndex:"columnList",render:function(q,Y){var J=w(Y),de=q==null?void 0:q.map(function(se){return"".concat(se.columnName)}).join(",");return J?(0,e.jsxs)("div",{className:ka.columnListCell,children:[(0,e.jsx)("span",{onClick:function(){I(!0)},children:(0,s.ZP)("common.button.edit")}),de]}):(0,e.jsx)("div",{className:ka.editableCell,children:de})}},{title:(0,s.ZP)("editTable.label.comment"),dataIndex:"comment",render:function(q,Y){var J=w(Y);return J?(0,e.jsx)(re.Z.Item,{name:"comment",style:{margin:0},children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}):(0,e.jsx)("div",{className:ka.editableCell,onClick:function(){return Z(Y)},children:q})}},{width:"40px",render:function(q,Y){return(0,e.jsx)("div",{className:ka.operationBar,onClick:function(){R(Y)},children:(0,e.jsx)("div",{className:ka.deleteIconBox,children:(0,e.jsx)(X.Z,{code:"\uE64E"})})})}}];return i===d.DatabaseTypeCode.MYSQL&&y.splice(3,0,{title:(0,s.ZP)("editTable.label.indexMethod"),dataIndex:"method",width:"120px",render:function(q,Y){var J=w(Y);return J?(0,e.jsx)(re.Z.Item,{name:"method",style:{margin:0},children:(0,e.jsx)(aa.Z,{style:{width:"100%"},children:["HASH","BTREE"].map(function(de){return(0,e.jsx)(aa.Z.Option,{value:de,children:de},de)})})}):(0,e.jsx)("div",{className:ka.editableCell,children:q})}}),i===d.DatabaseTypeCode.ORACLE&&y.splice(-2,1),y},[w]),Q=function(){f(m.map(function(F){var q,Y=(q=L.current)===null||q===void 0?void 0:q.getIncludeColInfo();return F.key===(v==null?void 0:v.key)&&Y&&(F.columnList=Y,O.map(function(J){J.key===(v==null?void 0:v.key)&&(Ye().isEqual(J.columnList,Y)?F.editStatus=null:F.editStatus=d.EditColumnOperationType.Modify)})),F})),I(!1)},G=function(F){return{onClick:function(){(v==null?void 0:v.key)!==F.key&&Z(F)}}},z=(0,l.useMemo)(function(){var y=[];return m.forEach(function(F){F.key===(v==null?void 0:v.key)&&(y=F.columnList||[])}),y},[M]);return(0,e.jsxs)("div",{className:$()(ka.indexList),children:[(0,e.jsx)(re.Z,{className:ka.formBox,form:N,onFieldsChange:g,children:(0,e.jsxs)("div",{className:ka.tableBox,children:[(0,e.jsx)(vo.LB,{modifiers:[_o.DL],onDragEnd:A,children:(0,e.jsx)(vt.Fo,{items:m.map(function(y){return y.key}),strategy:vt.qw,children:(0,e.jsx)(et.Z,{ref:P,components:{body:{row:us}},style:{maxHeight:"100%",overflow:"auto"},sticky:!0,onRow:G,pagination:!1,rowKey:"key",columns:U,scroll:{x:"100%"},dataSource:m.filter(function(y){return y.editStatus!==d.EditColumnOperationType.Delete})})})}),(0,e.jsxs)("div",{onClick:B,className:ka.addColumnButton,children:[(0,e.jsx)(X.Z,{code:"\uE631"}),(0,s.ZP)("editTable.button.addIndex")]})]})}),(0,e.jsx)(Aa.Z,{className:ka.includeColModal,open:M,width:460,title:(0,s.ZP)("editTable.label.includeColumn"),onOk:Q,onCancel:function(){I(!1)},maskClosable:!1,destroyOnClose:!0,children:(0,e.jsx)(is,{includedColumnList:z,ref:L})})]})}),ds=cs,Na={"f-icon-button":"f-icon-button___RSPE1","f-fill-absolute":"f-fill-absolute___DgIsR","f-button":"f-button___kAnos","f-doc-en-break":"f-doc-en-break___hnv97",columnList:"columnList___FDLuf",columnListHeader:"columnListHeader___IrfPo",formBox:"formBox___jOhlf",tableBox:"tableBox___LzOtZ",addColumnButton:"addColumnButton___gv5iS",otherInfo:"otherInfo___CoBqd",otherInfoFormBox:"otherInfoFormBox___CrCWB",editableCell:"editableCell___vrXVe",keyBox:"keyBox___HMyQY",disabledKeyBox:"disabledKeyBox___ZZ57C",operationBar:"operationBar___GWn5M",deleteIconBox:"deleteIconBox___xcvTs","loading-animation":"loading-animation___YAMdf"},ms=(0,l.memo)(function(n){var a=n.options,t=n.onChange,r=n.value,o=(0,l.useState)([]),i=j()(o,2),u=i[0],c=i[1],m=(0,l.useState)(""),f=j()(m,2),b=f[0],E=f[1],O=(0,l.useState)(null),T=j()(O,2),x=T[0],_=T[1];(0,l.useEffect)(function(){c([].concat(_e()(a),[{label:"",value:null}]))},[a]),(0,l.useEffect)(function(){E(r)},[r]);var N=function(D){var S=_e()(D),M=S[S.length-1];return S.forEach(function(I,L){(M.value===I.value&&L!==D.length-1||!I.value)&&S.pop()}),S},C=function(D){_(D)},p=function(D){_(null),E(D),t==null||t(D)},v=function(){x&&(t==null||t(x)),_(null)};return(0,e.jsx)(aa.Z,{onBlur:v,allowClear:!0,onChange:p,value:b,showSearch:!0,onSearch:C,options:N(u),notFoundContent:!1})}),cr=ms,fs=["children"],vs=function(a){var t=a.children,r=ir()(a,fs),o=(0,vt.nB)({id:r["data-row-key"]}),i=o.attributes,u=o.listeners,c=o.setNodeRef,m=o.setActivatorNodeRef,f=o.transform,b=o.transition,E=o.isDragging,O=h()(h()({},r.style),{},{transform:po.ux.Transform.toString(f&&h()(h()({},f),{},{scaleY:1})),transition:b},E?{position:"relative",zIndex:9999}:{});return(0,e.jsx)("tr",h()(h()(h()({},r),{},{ref:c,style:O},i),{},{children:l.Children.map(t,function(T){return T.key==="sort"?l.cloneElement(T,{children:(0,e.jsx)(fo.Z,h()({ref:m,style:{touchAction:"none",cursor:"move"}},u))}):T})}))},No=function(){return{key:(0,Ce.Z)(),oldName:null,name:null,tableName:null,columnType:null,dataType:null,defaultValue:null,autoIncrement:null,comment:null,primaryKey:null,primaryKeyOrder:null,schemaName:null,databaseName:null,typeName:null,columnSize:null,bufferLength:null,decimalDigits:null,numPrecRadix:null,nullableInt:null,sqlDataType:null,sqlDatetimeSub:null,charOctetLength:null,ordinalPosition:null,nullable:null,generatedColumn:null,charSetName:null,collationName:null,value:null,editStatus:d.EditColumnOperationType.Add}},_s=(0,l.forwardRef)(function(n,a){var t=(0,l.useContext)(nn),r=t.databaseSupportField,o=t.databaseName,i=t.schemaName,u=t.tableDetails,c=t.databaseType,m=(0,l.useState)([No()]),f=j()(m,2),b=f[0],E=f[1],O=re.Z.useForm(),T=j()(O,1),x=T[0],_=(0,l.useState)(null),N=j()(_,2),C=N[0],p=N[1],v=(0,l.useState)(null),k=j()(v,2),D=k[0],S=k[1],M=(0,l.useRef)(null),I=function(z){return z.key===(C==null?void 0:C.key)},L=function(z){z.key&&(x.setFieldsValue(h()({},z)),p(z),r.columnTypes.forEach(function(y){y.typeName===z.columnType&&S(h()(h()({},y),{},{editKey:z.key}))}))};(0,l.useEffect)(function(){if(u){var G,z=(u==null||(G=u.columnList)===null||G===void 0?void 0:G.map(function(y){return h()(h()({},y),{},{oldName:y.name,key:(0,Ce.Z)()})}))||[];S(null),E(z)}},[u]);var P=[{key:"sort",width:"40px",align:"center",fixed:"left"},{title:(0,s.ZP)("editTable.label.columnName"),dataIndex:"name",width:"160px",fixed:"left",render:function(z,y){var F=I(y);return(0,e.jsx)("div",{className:Na.cellContent,children:F?(0,e.jsx)(re.Z.Item,{name:"name",style:{margin:0},children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}):(0,e.jsx)("div",{className:Na.editableCell,children:z})})}},{title:(0,s.ZP)("editTable.label.columnType"),dataIndex:"columnType",width:"200px",render:function(z,y){var F=I(y);return(0,e.jsx)("div",{children:F?(0,e.jsx)(re.Z.Item,{name:"columnType",style:{margin:0,maxWidth:"184px"},children:(0,e.jsx)(aa.Z,{showSearch:!0,options:r.columnTypes})}):(0,e.jsx)("div",{style:{maxWidth:"184px"},className:Na.editableCell,children:z})})}},{title:(0,s.ZP)("editTable.label.columnSize"),dataIndex:"columnSize",width:"120px",render:function(z,y){var F=I(y);return F?(0,e.jsx)(re.Z.Item,{name:"columnSize",style:{margin:0},children:(0,e.jsx)(oo.Z,{disabled:!(D!=null&&D.supportLength)})}):(0,e.jsx)("div",{className:Na.editableCell,children:z})}},{title:(0,s.ZP)("editTable.label.nullable"),dataIndex:"nullable",width:"100px",render:function(z,y){return(0,e.jsx)("div",{children:(0,e.jsx)(hn.Z,{onChange:function(){if(c===d.DatabaseTypeCode.SQLITE&&y.editStatus!==d.EditColumnOperationType.Add)return null;Z(y)},checked:z===d.NullableType.Null,disabled:(D==null?void 0:D.supportNullable)===!1||!!y.primaryKey||c===d.DatabaseTypeCode.SQLITE&&y.editStatus!==d.EditColumnOperationType.Add})})}},{title:(0,s.ZP)("editTable.label.primaryKey"),dataIndex:"primaryKey",width:"50px",render:function(z,y){return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:$()(Na.keyBox,W()({},Na.disabledKeyBox,c===d.DatabaseTypeCode.SQLITE&&y.editStatus!==d.EditColumnOperationType.Add)),onClick:function(){if(c===d.DatabaseTypeCode.SQLITE&&y.editStatus!==d.EditColumnOperationType.Add)return null;w(y)},children:[z&&(0,e.jsx)(X.Z,{code:"\uE775"}),z&&(0,e.jsx)("span",{children:y.primaryKeyOrder})]})})}},{title:(0,s.ZP)("editTable.label.comment"),dataIndex:"comment",render:function(z,y){var F=I(y);return F?(0,e.jsx)(re.Z.Item,{name:"comment",style:{margin:0},children:(0,e.jsx)(xe.Z,{autoComplete:"off",disabled:!(D!=null&&D.supportComments)})}):(0,e.jsx)("div",{className:Na.editableCell,children:z})}},{width:"40px",render:function(z,y){return c===d.DatabaseTypeCode.SQLITE&&y.editStatus!==d.EditColumnOperationType.Add?null:(0,e.jsx)("div",{className:Na.operationBar,onClick:function(){A(y)},children:(0,e.jsx)("div",{className:Na.deleteIconBox,children:(0,e.jsx)(X.Z,{code:"\uE64E"})})})}}],w=function(z){var y=b.map(function(F){var q=F.primaryKeyOrder;if(z.primaryKey?z.key===F.key?q=null:z.primaryKeyOrder&&F.primaryKeyOrder&&F.primaryKeyOrder>=z.primaryKeyOrder&&(q=F.primaryKeyOrder-1):z.key===F.key&&(q=Math.max.apply(Math,_e()(b.map(function(de){return de.primaryKeyOrder||0})))+1),F.key===(z==null?void 0:z.key)){var Y=F.editStatus;Y!==d.EditColumnOperationType.Add&&(Y=d.EditColumnOperationType.Modify);var J=h()(h()({},F),{},{primaryKey:!F.primaryKey,primaryKeyOrder:q,nullable:F.primaryKey?F.nullable:d.NullableType.NotNull,editStatus:Y});return J}return h()(h()({},F),{},{primaryKeyOrder:q})});E(y)},Z=function(z){var y=b.map(function(F){if(F.key===(z==null?void 0:z.key)){var q=F.editStatus;q!==d.EditColumnOperationType.Add&&(q=d.EditColumnOperationType.Modify);var Y=h()(h()({},F),{},{nullable:F.nullable?d.NullableType.NotNull:d.NullableType.Null,editStatus:q});return Y}return F});E(y)},B=function(z){var y=z.active,F=z.over;y.id!==(F==null?void 0:F.id)&&E(function(q){var Y=q.findIndex(function(de){return de.key===y.id}),J=q.findIndex(function(de){return de.key===(F==null?void 0:F.id)});return(0,vt.Rp)(q,Y,J)})},R=function(z){var y=z[0].value,F=z[0].name,q=F[0];q==="nullable"&&(y=y?d.NullableType.Null:d.NullableType.NotNull);var Y=b.map(function(J){if(J.key===(C==null?void 0:C.key)){var de,se=J.editStatus;se!==d.EditColumnOperationType.Add&&(se=d.EditColumnOperationType.Modify);var Me=h()(h()({},J),{},(de={},W()(de,q,y),W()(de,"editStatus",se),de));return q==="columnType"&&(r.columnTypes.forEach(function(oe){oe.typeName===y&&S(h()(h()({},D),oe))}),y==="VARCHAR"&&Me.columnSize===null&&(Me.columnSize=255,x.setFieldsValue({columnSize:255}))),Me}return J});E(Y)},g=function(){var z=h()({},No());E([].concat(_e()(b),[z])),L(z),setTimeout(function(){var y,F;(y=M.current)===null||y===void 0||y.scrollTo(0,((F=M.current)===null||F===void 0?void 0:F.scrollHeight)+100)},0)},A=function(z){var y=[];(z==null?void 0:z.editStatus)===d.EditColumnOperationType.Add?y=b.filter(function(F){return F.key!==(z==null?void 0:z.key)}):y=b.map(function(F){return F.key===(z==null?void 0:z.key)?(p(null),S(null),h()(h()({},F),{},{editStatus:d.EditColumnOperationType.Delete})):F}),E(y)};function V(){return b.map(function(G){var z=h()(h()({},G),{},{tableName:u==null?void 0:u.name,databaseName:o,schemaName:i||null});return delete z.key,z})}(0,l.useImperativeHandle)(a,function(){return{getColumnListInfo:V}});var U=function(){var z={style:{width:100}};return(0,e.jsxs)(e.Fragment,{children:[(D==null?void 0:D.supportAutoIncrement)&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.autoIncrement"),name:"autoIncrement",valuePropName:"checked",children:(0,e.jsx)(hn.Z,{})}),c===d.DatabaseTypeCode.SQLSERVER&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.sparse"),name:"sparse",valuePropName:"checked",children:(0,e.jsx)(hn.Z,{})}),(D==null?void 0:D.supportDefaultValue)&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.defaultValue"),name:"defaultValue",children:(0,e.jsx)(cr,{options:r.defaultValues})}),(D==null?void 0:D.supportCharset)&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.characterSet"),name:"charSetName",children:(0,e.jsx)(cr,{options:r.charsets})}),(D==null?void 0:D.supportCollation)&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.collation"),name:"collationName",children:(0,e.jsx)(cr,{options:r.collations})}),(D==null?void 0:D.supportScale)&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.decimalPoint"),name:"decimalDigits",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}),(D==null?void 0:D.supportUnit)&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.unit"),name:"unit",children:(0,e.jsx)(aa.Z,{style:{width:"100%"},children:["CHAR","BYTE"].map(function(y){return(0,e.jsx)(aa.Z.Option,{value:y,children:y},y)})})}),(D==null?void 0:D.supportValue)&&(0,e.jsx)(re.Z.Item,{labelCol:z,label:(0,s.ZP)("editTable.label.value"),name:"value",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})})]})},Q=function(z){return{onClick:function(){c===d.DatabaseTypeCode.SQLITE&&z.editStatus!==d.EditColumnOperationType.Add||(C==null?void 0:C.key)!==z.key&&L(z)}}};return(0,e.jsx)("div",{className:Na.columnList,children:(0,e.jsxs)(re.Z,{className:Na.formBox,form:x,onFieldsChange:R,children:[(0,e.jsxs)("div",{className:Na.tableBox,children:[(0,e.jsx)(vo.LB,{modifiers:[_o.DL],onDragEnd:B,children:(0,e.jsx)(vt.Fo,{items:b.map(function(G){return G.key}),strategy:vt.qw,children:(0,e.jsx)(et.Z,{ref:M,components:{body:{row:vs}},style:{maxHeight:"100%",overflow:"auto"},sticky:!0,onRow:Q,pagination:!1,rowKey:"key",columns:P,scroll:{x:"100%"},dataSource:b.filter(function(G){return G.editStatus!==d.EditColumnOperationType.Delete})})})}),(0,e.jsxs)("div",{onClick:g,className:Na.addColumnButton,children:[(0,e.jsx)(X.Z,{code:"\uE631"}),(0,s.ZP)("editTable.button.addColumn")]})]}),(0,e.jsx)("div",{className:Na.otherInfo,children:(0,e.jsx)("div",{className:Na.otherInfoFormBox,children:U()})})]})})}),ps=_s,dr={"f-icon-button":"f-icon-button___w_gRK","f-fill-absolute":"f-fill-absolute___q6OrQ","f-button":"f-button___lYew5","f-doc-en-break":"f-doc-en-break___GBYli",baseInfo:"baseInfo___WkhEA",formBox:"formBox___QspkC","loading-animation":"loading-animation___EL9Jd"},hs=(0,l.forwardRef)(function(n,a){var t=n.className,r=(0,l.useContext)(nn),o=r.tableDetails,i=r.databaseType,u=re.Z.useForm(),c=j()(u,1),m=c[0];(0,l.useEffect)(function(){m.setFieldsValue({name:o.name,comment:o.comment,charset:o.charset,engine:o.engine,incrementValue:o.incrementValue})},[o]);function f(){return m.getFieldsValue()}return(0,l.useImperativeHandle)(a,function(){return{getBaseInfo:f}}),(0,e.jsx)("div",{className:$()(t,dr.baseInfo),children:(0,e.jsx)("div",{className:dr.formBox,children:(0,e.jsxs)(re.Z,{layout:"vertical",form:m,initialValues:{remember:!0},autoComplete:"off",className:dr.form,children:[(0,e.jsx)(re.Z.Item,{label:"".concat((0,s.ZP)("editTable.label.tableName"),":"),name:"name",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}),(0,e.jsx)(re.Z.Item,{label:"".concat((0,s.ZP)("editTable.label.comment"),":"),name:"comment",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}),i===d.DatabaseTypeCode.MYSQL&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(re.Z.Item,{label:"".concat((0,s.ZP)("editTable.label.characterSet"),":"),name:"charset",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}),(0,e.jsx)(re.Z.Item,{label:"".concat((0,s.ZP)("editTable.label.engine"),":"),name:"engine",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}),(0,e.jsx)(re.Z.Item,{label:"".concat((0,s.ZP)("editTable.label.incrementValue"),":"),name:"incrementValue",children:(0,e.jsx)(xe.Z,{autoComplete:"off"})})]})]})})})}),bs=hs,nn=(0,l.createContext)({}),Ns=(0,l.memo)(function(n){var a=n.databaseName,t=n.dataSourceId,r=n.tableName,o=n.schemaName,i=n.changeTabDetails,u=n.tabDetails,c=n.databaseType,m=n.submitCallback,f=(0,l.useState)({}),b=j()(f,2),E=b[0],O=b[1],T=(0,l.useState)({}),x=j()(T,2),_=x[0],N=x[1],C=(0,l.useState)(!1),p=j()(C,2),v=p[0],k=p[1],D=(0,l.useRef)(null),S=(0,l.useRef)(null),M=(0,l.useRef)(null),I=(0,l.useState)(""),L=j()(I,2),P=L[0],w=L[1],Z=(0,l.useMemo)(function(){return[{index:0,title:(0,s.ZP)("editTable.tab.basicInfo"),key:"basic",component:(0,e.jsx)(bs,{ref:D})},{index:1,title:(0,s.ZP)("editTable.tab.columnInfo"),key:"column",component:(0,e.jsx)(ps,{ref:S})},{index:2,title:(0,s.ZP)("editTable.tab.indexInfo"),key:"index",component:(0,e.jsx)(ds,{ref:M})}]},[]),B=(0,l.useState)(Z[0]),R=j()(B,2),g=R[0],A=R[1],V=(0,l.useState)({columnTypes:[],charsets:[],collations:[],indexTypes:[],defaultValues:[]}),U=j()(V,2),Q=U[0],G=U[1],z=(0,l.useState)(!1),y=j()(z,2),F=y[0],q=y[1];function Y(oe){A(oe)}(0,l.useEffect)(function(){r&&de(),J()},[]);var J=function(){ye.Z.getDatabaseFieldTypeList({dataSourceId:t,databaseName:a}).then(function(ue){var Te,He,Pe,Ze,Ee,je=(ue==null||(Te=ue.columnTypes)===null||Te===void 0?void 0:Te.map(function(fe){return h()(h()({},fe),{},{value:fe.typeName,label:fe.typeName})}))||[],be=(ue==null||(He=ue.charsets)===null||He===void 0?void 0:He.map(function(fe){return{value:fe.charsetName,label:fe.charsetName}}))||[],De=(ue==null||(Pe=ue.collations)===null||Pe===void 0?void 0:Pe.map(function(fe){return{value:fe.collationName,label:fe.collationName}}))||[],ge=(ue==null||(Ze=ue.indexTypes)===null||Ze===void 0?void 0:Ze.map(function(fe){return{value:fe.typeName,label:fe.typeName}}))||[],Ke=(ue==null||(Ee=ue.defaultValues)===null||Ee===void 0?void 0:Ee.map(function(fe){return{value:fe.defaultValue,label:fe.defaultValue}}))||[];G({columnTypes:je,charsets:be,collations:De,indexTypes:ge,defaultValues:Ke})})},de=function(ue){var Te=ue||{},He=Te.tableNameProps,Pe=He||r;if(Pe){var Ze={databaseName:a,dataSourceId:t,tableName:Pe,schemaName:o,refresh:!0};q(!0),ye.Z.getTableDetails(Ze).then(function(Ee){var je=Ye().cloneDeep(Ee);O(je||{}),N(Ee)}).finally(function(){q(!1)})}};function se(){if(D.current&&S.current&&M.current){var oe=h()(h()(h()({},_),D.current.getBaseInfo()),{},{columnList:S.current.getColumnListInfo(),indexList:M.current.getIndexListInfo()}),ue={databaseName:a,dataSourceId:t,schemaName:o,refresh:!0,newTable:oe};r&&(ue.oldTable=_),ye.Z.getModifyTableSql(ue).then(function(Te){k(!0),w(Te==null?void 0:Te[0].sql)})}}var Me=function(){var ue;k(!1),Ge.ZP.success((0,s.ZP)("common.text.successfulExecution"));var Te=(ue=D.current)===null||ue===void 0?void 0:ue.getBaseInfo().name;de({tableNameProps:Te}),r||i(h()(h()({},u),{},{title:"".concat(Te),type:d.WorkspaceTabType.EditTable,uniqueData:h()(h()({},u.uniqueData||{}),{},{tableName:Te})})),m==null||m()};return(0,e.jsxs)(nn.Provider,{value:h()(h()({},n),{},{tableDetails:E,baseInfoRef:D,columnListRef:S,indexListRef:M,databaseSupportField:Q,databaseType:c}),children:[(0,e.jsxs)(Nn,{coverLoading:!0,isLoading:F,className:$()(Xa.box),children:[(0,e.jsxs)("div",{className:Xa.header,children:[(0,e.jsx)("div",{className:Xa.tabList,style:{"--i":g.index},children:Z.map(function(oe){return(0,e.jsx)("div",{onClick:Y.bind(null,oe),className:$()(Xa.tabItem,g.key==oe.key?Xa.currentTab:""),children:oe.title},oe.key)})}),(0,e.jsx)("div",{className:Xa.saveButton,children:(0,e.jsx)(Oe.ZP,{type:"primary",onClick:se,children:(0,s.ZP)("common.button.save")})})]}),(0,e.jsx)("div",{className:Xa.main,children:Z.map(function(oe){return(0,e.jsx)("div",{className:$()(Xa.tab,W()({},Xa.hidden,g.key!==oe.key)),children:oe.component},oe.key)})})]}),(0,e.jsx)(Aa.Z,{title:(0,s.ZP)("editTable.title.sqlPreview"),open:!!v,onCancel:function(){k(!1)},width:"60vw",maskClosable:!1,footer:!1,destroyOnClose:!0,children:(0,e.jsx)(ro,{initSql:P,databaseName:a,dataSourceId:t,tableName:r,schemaName:o,databaseType:c,executeSuccessCallBack:Me})})]})}),Dn={"f-icon-button":"f-icon-button___cRFLQ","f-fill-absolute":"f-fill-absolute___giX41","f-button":"f-button___CD5AD","f-doc-en-break":"f-doc-en-break___fc2Qv",sqlExecute:"sqlExecute___dbjm9",boxRightCenter:"boxRightCenter___Bfipd",boxRightConsole:"boxRightConsole___CM_2Q",boxRightResult:"boxRightResult___nnZBl","loading-animation":"loading-animation___I7y8n"};function $d(n){var a=window.location.href,t=a.split("?")[1];if(t!==void 0){for(var r=t.split("&"),o=0;o<r.length;o++){var i=r[o].split("=")[0];if(i===n)return r[o].split("=")[1]}return null}}function Jd(n,a){var t=window.location.href;if(!a)return t;var r=new RegExp("([?&])"+n+"=.*?(&|$)","i"),o=t.indexOf("?")!==-1?"&":"?";return t.match(r)?t.replace(r,"$1"+n+"="+a+"$2"):t+o+n+"="+a}function Ss(n){var a=new URLSearchParams;return Object.entries(n).forEach(function(t){var r=j()(t,2),o=r[0],i=r[1];i!=null&&(Array.isArray(i)?i.forEach(function(u){a.append(o,u)}):a.append(o,i))}),a.toString()}function Xd(n){return window.location.origin+"/"+n}var Ts=function(a){var t=a.url,r=a.uid,o=a.onOpen,i=a.onMessage,u=a.onError;if(!t||!i||!u)throw new Error("url, onMessage, and onError are required");var c=localStorage.getItem("DBHUB"),m={headers:{uid:r,DBHUB:c}},f=new Bl.EventSourcePolyfill("".concat(window._BaseURL).concat(t),m);return f.onopen=function(){o()},f.onmessage=function(b){i(b.data)},f.onerror=function(b){u(b),console.error("EventSourcePolyfill error:",b)},function(){f.close()}},Es=Ts,mr=K(58457),at={chatWrapper:"chatWrapper___qrQyU",chatShortcut:"chatShortcut___mRutA",chatAi:"chatAi___hQlKB",suffixBlock:"suffixBlock___auHbR",enter:"enter___fPUSR",enterIcon:"enterIcon___PFGMS",stop:"stop___GGJuG",tableSelectBlock:"tableSelectBlock___FRloM",remainBlock:"remainBlock___c6ZDD",aiSelectedTable:"aiSelectedTable___yytVl",aiSelectedTableTips:"aiSelectedTableTips___rlkIE"},Cs=Object.defineProperty,So=Object.getOwnPropertySymbols,gs=Object.prototype.hasOwnProperty,xs=Object.prototype.propertyIsEnumerable,To=(n,a,t)=>a in n?Cs(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,Is=(n,a)=>{for(var t in a||(a={}))gs.call(a,t)&&To(n,t,a[t]);if(So)for(var t of So(a))xs.call(a,t)&&To(n,t,a[t]);return n};const em=n=>React.createElement("svg",Is({width:16,height:16,xmlns:"http://www.w3.org/2000/svg"},n),React.createElement("title",null,"\u7F16\u7EC4\u5907\u4EFD 3"),React.createElement("defs",null,React.createElement("linearGradient",{x1:"103.409%",y1:"45.664%",x2:"0%",y2:"56.784%",id:"ai_svg__a"},React.createElement("stop",{stopColor:"#9254DE",offset:"0%"}),React.createElement("stop",{stopColor:"#597EF7",offset:"100%"})),React.createElement("linearGradient",{x1:"100%",y1:"78.876%",x2:"-16.737%",y2:"45.919%",id:"ai_svg__b"},React.createElement("stop",{stopColor:"#9254DE",offset:"0%"}),React.createElement("stop",{stopColor:"#597EF7",offset:"100%"})),React.createElement("linearGradient",{x1:"100%",y1:"60.526%",x2:"0%",y2:"8.041%",id:"ai_svg__c"},React.createElement("stop",{stopColor:"#9254DE",offset:"0%"}),React.createElement("stop",{stopColor:"#597EF7",offset:"100%"}))),React.createElement("g",{fill:"none",fillRule:"evenodd"},React.createElement("path",{d:"M0 0h16v16H0z"}),React.createElement("circle",{stroke:"url(#ai_svg__a)",strokeWidth:1.5,cx:8,cy:8,r:7.25}),React.createElement("circle",{stroke:"url(#ai_svg__b)",strokeWidth:1.5,cx:5.818,cy:8,r:5.068}),React.createElement("circle",{stroke:"url(#ai_svg__c)",strokeWidth:1.5,cx:8,cy:8,r:2.886})));var ys="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IHgxPSIxMDMuNDA5JSIgeTE9IjQ1LjY2NCUiIHgyPSIwJSIgeTI9IjU2Ljc4NCUiIGlkPSJhIj48c3RvcCBzdG9wLWNvbG9yPSIjOTI1NERFIiBvZmZzZXQ9IjAlIi8+PHN0b3Agc3RvcC1jb2xvcj0iIzU5N0VGNyIgb2Zmc2V0PSIxMDAlIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjEwMCUiIHkxPSI3OC44NzYlIiB4Mj0iLTE2LjczNyUiIHkyPSI0NS45MTklIiBpZD0iYiI+PHN0b3Agc3RvcC1jb2xvcj0iIzkyNTRERSIgb2Zmc2V0PSIwJSIvPjxzdG9wIHN0b3AtY29sb3I9IiM1OTdFRjciIG9mZnNldD0iMTAwJSIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IHgxPSIxMDAlIiB5MT0iNjAuNTI2JSIgeDI9IjAlIiB5Mj0iOC4wNDElIiBpZD0iYyI+PHN0b3Agc3RvcC1jb2xvcj0iIzkyNTRERSIgb2Zmc2V0PSIwJSIvPjxzdG9wIHN0b3AtY29sb3I9IiM1OTdFRjciIG9mZnNldD0iMTAwJSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTAgMGgxNnYxNkgweiIvPjxjaXJjbGUgc3Ryb2tlPSJ1cmwoI2EpIiBzdHJva2Utd2lkdGg9IjEuNSIgY3g9IjgiIGN5PSI4IiByPSI3LjI1Ii8+PGNpcmNsZSBzdHJva2U9InVybCgjYikiIHN0cm9rZS13aWR0aD0iMS41IiBjeD0iNS44MTgiIGN5PSI4IiByPSI1LjA2OCIvPjxjaXJjbGUgc3Ryb2tlPSJ1cmwoI2MpIiBzdHJva2Utd2lkdGg9IjEuNSIgY3g9IjgiIGN5PSI4IiByPSIyLjg4NiIvPjwvZz48L3N2Zz4=",Wa=K(78045),Ln={AUTO:0,MANUAL:1},Ds=function(a){var t=(0,l.useState)(a.value),r=j()(t,2),o=r[0],i=r[1],u=function(b){if(b.target.value){if(b.nativeEvent.isComposing&&b.key==="Enter"){b.preventDefault();return}a.onPressEnter&&a.onPressEnter(b.target.value)}},c=function(){var b=a.tables,E=a.onSelectTableSyncModel,O=a.selectedTables,T=a.onSelectTables,x=(b||[]).map(function(_){return{value:_,label:_}});return(0,e.jsxs)("div",{className:at.aiSelectedTable,children:[(0,e.jsx)(Wa.ZP.Group,{onChange:function(N){return E(N.target.value)},value:Ln.MANUAL,style:{marginBottom:"8px"},children:(0,e.jsx)(Qr.Z,{direction:"horizontal",children:(0,e.jsx)(Wa.ZP,{value:Ln.MANUAL,children:"\u624B\u52A8"})})}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:at.aiSelectedTableTips,children:(0,s.ZP)("chat.input.remain.tooltip")}),(0,e.jsx)(aa.Z,{showSearch:!0,mode:"multiple",allowClear:!0,options:x,placeholder:(0,s.ZP)("chat.input.tableSelect.placeholder"),value:O,onChange:function(N){T&&T(N)}})]})]})},m=function(){return(0,e.jsxs)("div",{className:at.suffixBlock,children:[a.isStream?(0,e.jsx)(X.Z,{onClick:function(){a.onCancelStream&&a.onCancelStream()},code:"\uE652",className:at.stop}):(0,e.jsx)(Oe.ZP,{type:"primary",className:at.enter,onClick:function(){o&&a.onPressEnter&&a.onPressEnter(o)},children:(0,e.jsx)(X.Z,{code:"\uE643",className:at.enterIcon})}),(0,e.jsx)("div",{className:at.tableSelectBlock,children:(0,e.jsx)(xa.Z,{content:c(),placement:"bottomLeft",children:(0,e.jsx)(X.Z,{code:"\uE618"})})})]})};return(0,e.jsxs)("div",{className:at.chatWrapper,children:[(0,e.jsx)("img",{className:at.chatAi,src:ys}),(0,e.jsx)(xe.Z,{disabled:a.disabled,value:o,onChange:function(b){return i(b.target.value)},bordered:!1,placeholder:(0,s.ZP)("workspace.ai.input.placeholder"),onPressEnter:u,suffix:m()})]})},Ls=Ds,Eo=K(98267),fr={"f-icon-button":"f-icon-button___ePyGj","f-fill-absolute":"f-fill-absolute___HTQ9t","f-button":"f-button____6UZ1","f-doc-en-break":"f-doc-en-break____joXG",box:"box___vn0D6",title:"title___DKfiC",text:"text___jo2V5",wechatImg:"wechatImg___ngGel","loading-animation":"loading-animation___te7bH"},Rs="http://oss.sqlgpt.cn/static/chat2db-wechat.jpg?x-oss-process=image/auto-orient,1/resize,m_lfit,w_256/quality,Q_80/format,webp",Ps=(0,l.memo)(function(a){var t=a.className,r=function(){if(a.tip)return(0,e.jsx)("p",{children:a.tip});var u;return a.source==="setting"?u=(0,e.jsx)("p",{children:"\u5173\u6CE8\u516C\u4F17\u53F7\u83B7\u53D6AI Key"}):u=(0,e.jsx)("p",{children:(0,s.ZP)("common.text.wechatPopularizeAi")}),u},o=function(){return!a.source&&!a.imageUrl?null:(0,e.jsx)("img",{className:fr.wechatImg,src:a.source?Rs:a.imageUrl})};return(0,e.jsxs)("div",{className:$()(fr.box,t),children:[o(),(0,e.jsx)("div",{className:fr.text,children:r()})]})}),Rn={consoleOptionsWrapper:"consoleOptionsWrapper___OWVVw",consoleOptionsLeft:"consoleOptionsLeft___l55lf",runButton:"runButton___QC85x",saveButton:"saveButton___zNgjn"},As=K(50574),pt={"f-icon-button":"f-icon-button___bltJc","f-fill-absolute":"f-fill-absolute___Rqv96","f-button":"f-button___HA7Pe","f-doc-en-break":"f-doc-en-break___pZel3",consoleOptionsRight:"consoleOptionsRight___rPKDc",boundInfoBoxSpacer:"boundInfoBoxSpacer___Q98KC",boundInfoBox:"boundInfoBox___BBxfN",boundInfoName:"boundInfoName___qvJNk","loading-animation":"loading-animation___Nsy60"},Os={type:ma.Z.MYSQL,keywords:["ACCESSIBLE","ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BIGINT","BINARY","BLOB","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHAR","CHARACTER","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CUBE","CUME_DIST","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DEC","DECIMAL","DECLARE","DEFAULT","DELAYED","DELETE","DENSE_RANK","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DOUBLE","DROP","DUAL","EACH","ELSE","ELSEIF","EMPTY","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FIRST_VALUE","FLOAT","FLOAT4","FLOAT8","FOR","FORCE","FOREIGN","FROM","FULLTEXT","FUNCTION","GENERATED","GET","GRANT","GROUP","GROUPING","GROUPS","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","INTERVAL","INTO","IO_AFTER_GTIDS","IO_BEFORE_GTIDS","IS","ITERATE","JOIN","JSON_TABLE","KEY","KEYS","KILL","LAG","LAST_VALUE","LATERAL","LEAD","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LONGBLOB","LONGTEXT","LOOP","LOW_PRIORITY","MASTER_BIND","MASTER_SSL_VERIFY_SERVER_CERT","MATCH","MAXVALUE","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NTH_VALUE","NTILE","NULL","NUMERIC","OF","ON","OPTIMIZE","OPTIMIZER_COSTS","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PARTITION","PERCENT_RANK","PRECISION","PRIMARY","PROCEDURE","PURGE","RANGE","RANK","READ","READS","READ_WRITE","REAL","RECURSIVE","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESIGNAL","RESTRICT","RETURN","REVOKE","RIGHT","RLIKE","ROW","ROWS","ROW_NUMBER","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SMALLINT","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SQL_NO_CACHE","SSL","STARTING","STORED","STRAIGHT_JOIN","SYSTEM","TABLE","TERMINATED","THEN","TINYBLOB","TINYINT","TINYTEXT","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VARBINARY","VARCHAR","VARCHARACTER","VARYING","VIRTUAL","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"],functions:["ABS","ACOS","ADDDATE","ADDTIME","AES_DECRYPT","AES_ENCRYPT","ANY_VALUE","Area","AsBinary","AsWKB","ASCII","ASIN","AsText","AsWKT","ASYMMETRIC_DECRYPT","ASYMMETRIC_DERIVE","ASYMMETRIC_ENCRYPT","ASYMMETRIC_SIGN","ASYMMETRIC_VERIFY","ATAN","ATAN2","ATAN","AVG","BENCHMARK","BIN","BIT_AND","BIT_COUNT","BIT_LENGTH","BIT_OR","BIT_XOR","Buffer","CAST","CEIL","CEILING","Centroid","CHAR","CHAR_LENGTH","CHARACTER_LENGTH","CHARSET","COALESCE","COERCIBILITY","COLLATION","COMPRESS","CONCAT","CONCAT_WS","CONNECTION_ID","Contains","CONV","CONVERT","CONVERT_TZ","ConvexHull","COS","COT","COUNT","CRC32","CREATE_ASYMMETRIC_PRIV_KEY","CREATE_ASYMMETRIC_PUB_KEY","CREATE_DH_PARAMETERS","CREATE_DIGEST","Crosses","CUME_DIST","CURDATE","CURRENT_DATE","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURTIME","DATABASE","DATE","DATE_ADD","DATE_FORMAT","DATE_SUB","DATEDIFF","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DAYOFYEAR","DECODE","DEFAULT","DEGREES","DES_DECRYPT","DES_ENCRYPT","DENSE_RANK","Dimension","Disjoint","Distance","ELT","ENCODE","ENCRYPT","EndPoint","Envelope","Equals","EXP","EXPORT_SET","ExteriorRing","EXTRACT","ExtractValue","FIELD","FIND_IN_SET","FIRST_VALUE","FLOOR","FORMAT","FORMAT_BYTES","FORMAT_PICO_TIME","FOUND_ROWS","FROM_BASE64","FROM_DAYS","FROM_UNIXTIME","GEN_RANGE","GEN_RND_EMAIL","GEN_RND_PAN","GEN_RND_SSN","GEN_RND_US_PHONE","GeomCollection","GeomCollFromText","GeometryCollectionFromText","GeomCollFromWKB","GeometryCollectionFromWKB","GeometryCollection","GeometryN","GeometryType","GeomFromText","GeometryFromText","GeomFromWKB","GeometryFromWKB","GET_FORMAT","GET_LOCK","GLength","GREATEST","GROUP_CONCAT","GROUPING","GTID_SUBSET","GTID_SUBTRACT","HEX","HOUR","ICU_VERSION","IF","IFNULL","INET_ATON","INET_NTOA","INET6_ATON","INET6_NTOA","INSERT","INSTR","InteriorRingN","Intersects","INTERVAL","IS_FREE_LOCK","IS_IPV4","IS_IPV4_COMPAT","IS_IPV4_MAPPED","IS_IPV6","IS_USED_LOCK","IS_UUID","IsClosed","IsEmpty","ISNULL","IsSimple","JSON_APPEND","JSON_ARRAY","JSON_ARRAY_APPEND","JSON_ARRAY_INSERT","JSON_ARRAYAGG","JSON_CONTAINS","JSON_CONTAINS_PATH","JSON_DEPTH","JSON_EXTRACT","JSON_INSERT","JSON_KEYS","JSON_LENGTH","JSON_MERGE","JSON_MERGE_PATCH","JSON_MERGE_PRESERVE","JSON_OBJECT","JSON_OBJECTAGG","JSON_OVERLAPS","JSON_PRETTY","JSON_QUOTE","JSON_REMOVE","JSON_REPLACE","JSON_SCHEMA_VALID","JSON_SCHEMA_VALIDATION_REPORT","JSON_SEARCH","JSON_SET","JSON_STORAGE_FREE","JSON_STORAGE_SIZE","JSON_TABLE","JSON_TYPE","JSON_UNQUOTE","JSON_VALID","LAG","LAST_DAY","LAST_INSERT_ID","LAST_VALUE","LCASE","LEAD","LEAST","LEFT","LENGTH","LineFromText","LineStringFromText","LineFromWKB","LineStringFromWKB","LineString","LN","LOAD_FILE","LOCALTIME","LOCALTIMESTAMP","LOCATE","LOG","LOG10","LOG2","LOWER","LPAD","LTRIM","MAKE_SET","MAKEDATE","MAKETIME","MASK_INNER","MASK_OUTER","MASK_PAN","MASK_PAN_RELAXED","MASK_SSN","MASTER_POS_WAIT","MAX","MBRContains","MBRCoveredBy","MBRCovers","MBRDisjoint","MBREqual","MBREquals","MBRIntersects","MBROverlaps","MBRTouches","MBRWithin","MD5","MEMBER OF","MICROSECOND","MID","MIN","MINUTE","MLineFromText","MultiLineStringFromText","MLineFromWKB","MultiLineStringFromWKB","MOD","MONTH","MONTHNAME","MPointFromText","MultiPointFromText","MPointFromWKB","MultiPointFromWKB","MPolyFromText","MultiPolygonFromText","MPolyFromWKB","MultiPolygonFromWKB","MultiLineString","MultiPoint","MultiPolygon","NAME_CONST","NOT IN","NOW","NTH_VALUE","NTILE","NULLIF","NumGeometries","NumInteriorRings","NumPoints","OCT","OCTET_LENGTH","OLD_PASSWORD","ORD","Overlaps","PASSWORD","PERCENT_RANK","PERIOD_ADD","PERIOD_DIFF","PI","Point","PointFromText","PointFromWKB","PointN","PolyFromText","PolygonFromText","PolyFromWKB","PolygonFromWKB","Polygon","POSITION","POW","POWER","PS_CURRENT_THREAD_ID","PS_THREAD_ID","PROCEDURE ANALYSE","QUARTER","QUOTE","RADIANS","RAND","RANDOM_BYTES","RANK","REGEXP_INSTR","REGEXP_LIKE","REGEXP_REPLACE","REGEXP_REPLACE","RELEASE_ALL_LOCKS","RELEASE_LOCK","REPEAT","REPLACE","REVERSE","RIGHT","ROLES_GRAPHML","ROUND","ROW_COUNT","ROW_NUMBER","RPAD","RTRIM","SEC_TO_TIME","SECOND","SESSION_USER","SHA1","SHA","SHA2","SIGN","SIN","SLEEP","SOUNDEX","SOURCE_POS_WAIT","SPACE","SQRT","SRID","ST_Area","ST_AsBinary","ST_AsWKB","ST_AsGeoJSON","ST_AsText","ST_AsWKT","ST_Buffer","ST_Buffer_Strategy","ST_Centroid","ST_Collect","ST_Contains","ST_ConvexHull","ST_Crosses","ST_Difference","ST_Dimension","ST_Disjoint","ST_Distance","ST_Distance_Sphere","ST_EndPoint","ST_Envelope","ST_Equals","ST_ExteriorRing","ST_FrechetDistance","ST_GeoHash","ST_GeomCollFromText","ST_GeometryCollectionFromText","ST_GeomCollFromTxt","ST_GeomCollFromWKB","ST_GeometryCollectionFromWKB","ST_GeometryN","ST_GeometryType","ST_GeomFromGeoJSON","ST_GeomFromText","ST_GeometryFromText","ST_GeomFromWKB","ST_GeometryFromWKB","ST_HausdorffDistance","ST_InteriorRingN","ST_Intersection","ST_Intersects","ST_IsClosed","ST_IsEmpty","ST_IsSimple","ST_IsValid","ST_LatFromGeoHash","ST_Length","ST_LineFromText","ST_LineStringFromText","ST_LineFromWKB","ST_LineStringFromWKB","ST_LineInterpolatePoint","ST_LineInterpolatePoints","ST_LongFromGeoHash","ST_Longitude","ST_MakeEnvelope","ST_MLineFromText","ST_MultiLineStringFromText","ST_MLineFromWKB","ST_MultiLineStringFromWKB","ST_MPointFromText","ST_MultiPointFromText","ST_MPointFromWKB","ST_MultiPointFromWKB","ST_MPolyFromText","ST_MultiPolygonFromText","ST_MPolyFromWKB","ST_MultiPolygonFromWKB","ST_NumGeometries","ST_NumInteriorRing","ST_NumInteriorRings","ST_NumPoints","ST_Overlaps","ST_PointAtDistance","ST_PointFromGeoHash","ST_PointFromText","ST_PointFromWKB","ST_PointN","ST_PolyFromText","ST_PolygonFromText","ST_PolyFromWKB","ST_PolygonFromWKB","ST_Simplify","ST_SRID","ST_StartPoint","ST_SwapXY","ST_SymDifference","ST_Touches","ST_Transform","ST_Union","ST_Validate","ST_Within","ST_X","ST_Y","StartPoint","STATEMENT_DIGEST","STATEMENT_DIGEST_TEXT","STD","STDDEV","STDDEV_POP","STDDEV_SAMP","STR_TO_DATE","STRCMP","SUBDATE","SUBSTR","SUBSTRING","SUBSTRING_INDEX","SUBTIME","SUM","SYSDATE","SYSTEM_USER","TAN","TIME","TIME_FORMAT","TIME_TO_SEC","TIMEDIFF","TIMESTAMP","TIMESTAMPADD","TIMESTAMPDIFF","TO_BASE64","TO_DAYS","TO_SECONDS","Touches","TRIM","TRUNCATE","UCASE","UNCOMPRESS","UNCOMPRESSED_LENGTH","UNHEX","UNIX_TIMESTAMP","UpdateXML","UPPER","USER","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","UUID","UUID_SHORT","UUID_TO_BIN","VALIDATE_PASSWORD_STRENGTH","VALUES","VAR_POP","VAR_SAMP","VARIANCE","VERSION","WAIT_FOR_EXECUTED_GTID_SET","WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS","WEEK","WEEKDAY","WEEKOFYEAR","WEIGHT_STRING","Within","X","Y","YEAR","YEARWEEK"]},js={type:ma.Z.ORACLE,keywords:["ACCESS","ADD","ALL","ALTER","AND","ANY","AS","ASC","AUDIT","BETWEEN","BY","CHAR","CHECK","CLUSTER","COLUMN","COMMENT","COMPRESS","CONNECT","CREATE","CURRENT","DATE","DECIMAL","DEFAULT","DELETE","DESC","DISTINCT","DROP","ELSE","EXCLUSIVE","EXISTS","FILE","FLOAT","FOR","FROM","GRANT","GROUP","HAVING","IDENTIFIED","IMMEDIATE","IN","INCREMENT","INDEX","INITIAL","INSERT","INTEGER","INTERSECT","INTO","IS","LEVEL","LIKE","LOCK","LONG","MAXEXTENTS","MINUS","MLSLABEL","MODE","MODIFY","NOAUDIT","NOCOMPRESS","NOT","NOWAIT","NULL","NUMBER","OF","OFFLINE","ON","ONLINE","OPTION","OR","ORDER","PCTFREE","PRIOR","PRIVILEGES","PUBLIC","RAW","RENAME","RESOURCE","REVOKE","ROW","ROWID","ROWNUM","ROWS","SELECT","SESSION","SET","SHARE","SIZE","SMALLINT","START","SUCCESSFUL","SYNONYM","SYSDATE","TABLE","THEN","TO","TRIGGER","UID","UNION","UNIQUE","UPDATE","USER","VALIDATE","VALUES","VARCHAR","VARCHAR2","VIEW","WHENEVER","WHERE","WITH"],functions:["CONNECT BY","START WITH","ORDER SIBLINGS BY","SIBLINGS","PRIOR","NOCYCLE","LEVEL","GROUP BY","GROUPING SETS","CUBE","ROLLUP","PIVOT","UNPIVOT","MODEL","DIMENSION","MEASURES","RULES","ITERATE","INCREMENT","PRESENTV","ABSENTV","SQLQUERY","ARRAY","VARRAY","ASSOCIATIVE ARRAY","RECORD","OBJECT","TABLE","VIEW","MATERIALIZED VIEW","CONTEXT","DIRECTORY","EDITION","Profile","ROLE","SEQUENCE","SYNONYM","INDEXTYPE","LIBRARY","OPERATOR","PROCEDURE","FUNCTION","PACKAGE","TYPE","TRIGGER","LINK","VIEW LOG","CONSTRAINT","CLUSTER","COMMENT","AUDIT","NOAUDIT","GRANT","REVOKE","FLASHBACK","PURGE","MERGE","ALTER SESSION","COMMIT","ROLLBACK","SAVEPOINT","SET TRANSACTION","LOCK","ROW SHARE","ROW EXCLUSIVE","SHARE UPDATE","SHARE","EXCLUSIVE","NOWAIT","SKIP LOCKED","PL/SQL","AUTONOMOUS_TRANSACTION","PRAGMA","EXCEPTION","SERIALLY_REUSABLE"]},ks={type:ma.Z.POSTGRESQL,keywords:["ALL","ANALYSE","ANALYZE","AND","ANY","ARRAY","AS","ASC","ASYMMETRIC","AUTHORIZATION","BINARY","BOTH","CASE","CAST","CHECK","COLLATE","COLLATION","COLUMN","CONCURRENTLY","CONSTRAINT","CREATE","CROSS","CURRENT_CATALOG","CURRENT_DATE","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","DEFAULT","DEFERRABLE","DESC","DISTINCT","DO","ELSE","END","EXCEPT","FALSE","FETCH","FOR","FOREIGN","FREEZE","FROM","FULL","GRANT","GROUP","HAVING","ILIKE","IN","INITIALLY","INNER","INTERSECT","INTO","IS","ISNULL","JOIN","LATERAL","LEADING","LEFT","LIKE","LIMIT","LOCALTIME","LOCALTIMESTAMP","NATURAL","NOT","NOTNULL","NULL","OFFSET","ON","ONLY","OR","ORDER","OUTER","OVERLAPS","PLACING","PRIMARY","REFERENCES","RETURNING","RIGHT","SELECT","SESSION_USER","SIMILAR","SOME","SYMMETRIC","TABLE","TABLESAMPLE","THEN","TO","TRAILING","TRUE","UNION","UNIQUE","USER","USING","VARIADIC","VERBOSE","WHEN","WHERE","WINDOW","WITH"],functions:["abbrev","abs","acldefault","aclexplode","acos","acosd","acosh","age","any","area","array_agg","array_append","array_cat","array_dims","array_fill","array_length","array_lower","array_ndims","array_position","array_positions","array_prepend","array_remove","array_replace","array_to_json","array_to_string","array_to_tsvector","array_upper","ascii","asin","asind","asinh","atan","atan2","atan2d","atand","atanh","avg","bit","bit_and","bit_count","bit_length","bit_or","bit_xor","bool_and","bool_or","bound_box","box","brin_desummarize_range","brin_summarize_new_values","brin_summarize_range","broadcast","btrim","cardinality","cbrt","ceil","ceiling","center","char_length","character_length","chr","circle","clock_timestamp","coalesce","col_description","concat","concat_ws","convert","convert_from","convert_to","corr","cos","cosd","cosh","cot","cotd","count","covar_pop","covar_samp","cume_dist","current_catalog","current_database","current_date","current_query","current_role","current_schema","current_schemas","current_setting","current_time","current_timestamp","current_user","currval","cursor_to_xml","cursor_to_xmlschema","date_bin","date_part","date_trunc","database_to_xml","database_to_xml_and_xmlschema","database_to_xmlschema","decode","degrees","dense_rank","diagonal","diameter","div","encode","enum_first","enum_last","enum_range","every","exp","extract","factorial","family","first_value","floor","format","format_type","gcd","gen_random_uuid","generate_series","generate_subscripts","get_bit","get_byte","get_current_ts_config","gin_clean_pending_list","greatest","grouping","has_any_column_privilege","has_column_privilege","has_database_privilege","has_foreign_data_wrapper_privilege","has_function_privilege","has_language_privilege","has_schema_privilege","has_sequence_privilege","has_server_privilege","has_table_privilege","has_tablespace_privilege","has_type_privilege","height","host","hostmask","inet_client_addr","inet_client_port","inet_merge","inet_same_family","inet_server_addr","inet_server_port","initcap","isclosed","isempty","isfinite","isopen","json_agg","json_array_elements","json_array_elements_text","json_array_length","json_build_array","json_build_object","json_each","json_each_text","json_extract_path","json_extract_path_text","json_object","json_object_agg","json_object_keys","json_populate_record","json_populate_recordset","json_strip_nulls","json_to_record","json_to_recordset","json_to_tsvector","json_typeof","jsonb_agg","jsonb_array_elements","jsonb_array_elements_text","jsonb_array_length","jsonb_build_array","jsonb_build_object","jsonb_each","jsonb_each_text","jsonb_extract_path","jsonb_extract_path_text","jsonb_insert","jsonb_object","jsonb_object_agg","jsonb_object_keys","jsonb_path_exists","jsonb_path_match","jsonb_path_query","jsonb_path_query_array","jsonb_path_exists_tz","jsonb_path_query_first","jsonb_path_query_array_tz","jsonb_path_query_first_tz","jsonb_path_query_tz","jsonb_path_match_tz","jsonb_populate_record","jsonb_populate_recordset","jsonb_pretty","jsonb_set","jsonb_set_lax","jsonb_strip_nulls","jsonb_to_record","jsonb_to_recordset","jsonb_to_tsvector","jsonb_typeof","justify_days","justify_hours","justify_interval","lag","last_value","lastval","lcm","lead","least","left","length","line","ln","localtime","localtimestamp","log","log10","lower","lower_inc","lower_inf","lpad","lseg","ltrim","macaddr8_set7bit","make_date","make_interval","make_time","make_timestamp","make_timestamptz","makeaclitem","masklen","max","md5","min","min_scale","mod","mode","multirange","netmask","network","nextval","normalize","now","npoints","nth_value","ntile","nullif","num_nonnulls","num_nulls","numnode","obj_description","octet_length","overlay","parse_ident","path","pclose","percent_rank","percentile_cont","percentile_disc","pg_advisory_lock","pg_advisory_lock_shared","pg_advisory_unlock","pg_advisory_unlock_all","pg_advisory_unlock_shared","pg_advisory_xact_lock","pg_advisory_xact_lock_shared","pg_backend_pid","pg_backup_start_time","pg_blocking_pids","pg_cancel_backend","pg_client_encoding","pg_collation_actual_version","pg_collation_is_visible","pg_column_compression","pg_column_size","pg_conf_load_time","pg_control_checkpoint","pg_control_init","pg_control_recovery","pg_control_system","pg_conversion_is_visible","pg_copy_logical_replication_slot","pg_copy_physical_replication_slot","pg_create_logical_replication_slot","pg_create_physical_replication_slot","pg_create_restore_point","pg_current_logfile","pg_current_snapshot","pg_current_wal_flush_lsn","pg_current_wal_insert_lsn","pg_current_wal_lsn","pg_current_xact_id","pg_current_xact_id_if_assigned","pg_current_xlog_flush_location","pg_current_xlog_insert_location","pg_current_xlog_location","pg_database_size","pg_describe_object","pg_drop_replication_slot","pg_event_trigger_ddl_commands","pg_event_trigger_dropped_objects","pg_event_trigger_table_rewrite_oid","pg_event_trigger_table_rewrite_reason","pg_export_snapshot","pg_filenode_relation","pg_function_is_visible","pg_get_catalog_foreign_keys","pg_get_constraintdef","pg_get_expr","pg_get_function_arguments","pg_get_function_identity_arguments","pg_get_function_result","pg_get_functiondef","pg_get_indexdef","pg_get_keywords","pg_get_object_address","pg_get_owned_sequence","pg_get_ruledef","pg_get_serial_sequence","pg_get_statisticsobjdef","pg_get_triggerdef","pg_get_userbyid","pg_get_viewdef","pg_get_wal_replay_pause_state","pg_has_role","pg_identify_object","pg_identify_object_as_address","pg_import_system_collations","pg_index_column_has_property","pg_index_has_property","pg_indexam_has_property","pg_indexes_size","pg_is_in_backup","pg_is_in_recovery","pg_is_other_temp_schema","pg_is_wal_replay_paused","pg_is_xlog_replay_paused","pg_jit_available","pg_last_committed_xact","pg_last_wal_receive_lsn","pg_last_wal_replay_lsn","pg_last_xact_replay_timestamp","pg_last_xlog_receive_location","pg_last_xlog_replay_location","pg_listening_channels","pg_log_backend_memory_contexts","pg_logical_emit_message","pg_logical_slot_get_binary_changes","pg_logical_slot_get_changes","pg_logical_slot_peek_binary_changes","pg_logical_slot_peek_changes","pg_ls_archive_statusdir","pg_ls_dir","pg_ls_logdir","pg_ls_tmpdir","pg_ls_waldir","pg_mcv_list_items","pg_my_temp_schema","pg_notification_queue_usage","pg_opclass_is_visible","pg_operator_is_visible","pg_opfamily_is_visible","pg_options_to_table","pg_partition_ancestors","pg_partition_root","pg_partition_tree","pg_postmaster_start_time","pg_promote","pg_read_binary_file","pg_read_file","pg_relation_filenode","pg_relation_filepath","pg_relation_size","pg_reload_conf","pg_replication_origin_advance","pg_replication_origin_create","pg_replication_origin_drop","pg_replication_origin_oid","pg_replication_origin_progress","pg_replication_origin_session_is_setup","pg_replication_origin_session_progress","pg_replication_origin_session_reset","pg_replication_origin_session_setup","pg_replication_origin_xact_reset","pg_replication_origin_xact_setup","pg_replication_slot_advance","pg_rotate_logfile","pg_safe_snapshot_blocking_pids","pg_size_bytes","pg_size_pretty","pg_sleep","pg_sleep_for","pg_sleep_until","pg_snapshot_xip","pg_snapshot_xmax","pg_snapshot_xmin","pg_start_backup","pg_stat_file","pg_statistics_obj_is_visible","pg_stop_backup","pg_switch_wal","pg_switch_xlog","pg_table_is_visible","pg_table_size","pg_tablespace_databases","pg_tablespace_location","pg_tablespace_size","pg_terminate_backend","pg_total_relation_size","pg_trigger_depth","pg_try_advisory_lock","pg_try_advisory_lock_shared","pg_try_advisory_xact_lock","pg_try_advisory_xact_lock_shared","pg_ts_config_is_visible","pg_ts_dict_is_visible","pg_ts_parser_is_visible","pg_ts_template_is_visible","pg_type_is_visible","pg_typeof","pg_visible_in_snapshot","pg_wal_lsn_diff","pg_wal_replay_pause","pg_wal_replay_resume","pg_walfile_name","pg_walfile_name_offset","pg_xact_commit_timestamp","pg_xact_commit_timestamp_origin","pg_xact_status","pg_xlog_location_diff","pg_xlog_replay_pause","pg_xlog_replay_resume","pg_xlogfile_name","pg_xlogfile_name_offset","phraseto_tsquery","pi","plainto_tsquery","point","polygon","popen","position","power","pqserverversion","query_to_xml","query_to_xml_and_xmlschema","query_to_xmlschema","querytree","quote_ident","quote_literal","quote_nullable","radians","radius","random","range_agg","range_intersect_agg","range_merge","rank","regexp_match","regexp_matches","regexp_replace","regexp_split_to_array","regexp_split_to_table","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","repeat","replace","reverse","right","round","row_number","row_security_active","row_to_json","rpad","rtrim","scale","schema_to_xml","schema_to_xml_and_xmlschema","schema_to_xmlschema","session_user","set_bit","set_byte","set_config","set_masklen","setseed","setval","setweight","sha224","sha256","sha384","sha512","shobj_description","sign","sin","sind","sinh","slope","split_part","sprintf","sqrt","starts_with","statement_timestamp","stddev","stddev_pop","stddev_samp","string_agg","string_to_array","string_to_table","strip","strpos","substr","substring","sum","suppress_redundant_updates_trigger","table_to_xml","table_to_xml_and_xmlschema","table_to_xmlschema","tan","tand","tanh","text","timeofday","timezone","to_ascii","to_char","to_date","to_hex","to_json","to_number","to_regclass","to_regcollation","to_regnamespace","to_regoper","to_regoperator","to_regproc","to_regprocedure","to_regrole","to_regtype","to_timestamp","to_tsquery","to_tsvector","transaction_timestamp","translate","trim","trim_array","trim_scale","trunc","ts_debug","ts_delete","ts_filter","ts_headline","ts_lexize","ts_parse","ts_rank","ts_rank_cd","ts_rewrite","ts_stat","ts_token_type","tsquery_phrase","tsvector_to_array","tsvector_update_trigger","tsvector_update_trigger_column","txid_current","txid_current_if_assigned","txid_current_snapshot","txid_snapshot_xip","txid_snapshot_xmax","txid_snapshot_xmin","txid_status","txid_visible_in_snapshot","unistr","unnest","upper","upper_inc","upper_inf","user","var_pop","var_samp","variance","version","websearch_to_tsquery","width","width_bucket","xml_is_well_formed","xml_is_well_formed_content","xml_is_well_formed_document","xmlagg","xmlcomment","xmlconcat","xmlelement","xmlexists","xmlforest","xmlparse","xmlpi","xmlroot","xmlserialize","xpath","xpath_exists"]},ws={type:ma.Z.REDIS,keywords:["APPEND","AUTH","BGREWRITEAOF","BGSAVE","BITCOUNT","BITFIELD","BITOP","BITPOS","BLPOP","BRPOP","BRPOPLPUSH","CLIENT","KILL","LIST","GETNAME","PAUSE","REPLY","SETNAME","CLUSTER","ADDSLOTS","COUNT-FAILURE-REPORTS","COUNTKEYSINSLOT","DELSLOTS","FAILOVER","FORGET","GETKEYSINSLOT","INFO","KEYSLOT","MEET","NODES","REPLICATE","RESET","SAVECONFIG","SET-CONFIG-EPOCH","SETSLOT","SLAVES","SLOTS","COMMAND","COUNT","GETKEYS","CONFIG","GET","REWRITE","SET","RESETSTAT","DBSIZE","DEBUG","OBJECT","SEGFAULT","DECR","DECRBY","DEL","DISCARD","DUMP","ECHO","EVAL","EVALSHA","EXEC","EXISTS","EXPIRE","EXPIREAT","FLUSHALL","FLUSHDB","GEOADD","GEOHASH","GEOPOS","GEODIST","GEORADIUS","GEORADIUSBYMEMBER","GETBIT","GETRANGE","GETSET","HDEL","HEXISTS","HGET","HGETALL","HINCRBY","HINCRBYFLOAT","HKEYS","HLEN","HMGET","HMSET","HSET","HSETNX","HSTRLEN","HVALS","INCR","INCRBY","INCRBYFLOAT","KEYS","LASTSAVE","LINDEX","LINSERT","LLEN","LPOP","LPUSH","LPUSHX","LRANGE","LREM","LSET","LTRIM","MGET","MIGRATE","MONITOR","MOVE","MSET","MSETNX","MULTI","PERSIST","PEXPIRE","PEXPIREAT","PFADD","PFCOUNT","PFMERGE","PING","PSETEX","PSUBSCRIBE","PUBSUB","PTTL","PUBLISH","PUNSUBSCRIBE","QUIT","RANDOMKEY","READONLY","READWRITE","RENAME","RENAMENX","RESTORE","ROLE","RPOP","RPOPLPUSH","RPUSH","RPUSHX","SADD","SAVE","SCARD","SCRIPT","FLUSH","LOAD","SDIFF","SDIFFSTORE","SELECT","SETBIT","SETEX","SETNX","SETRANGE","SHUTDOWN","SINTER","SINTERSTORE","SISMEMBER","SLAVEOF","SLOWLOG","SMEMBERS","SMOVE","SORT","SPOP","SRANDMEMBER","SREM","STRLEN","SUBSCRIBE","SUNION","SUNIONSTORE","SWAPDB","SYNC","TIME","TOUCH","TTL","TYPE","UNSUBSCRIBE","UNLINK","UNWATCH","WAIT","WATCH","ZADD","ZCARD","ZCOUNT","ZINCRBY","ZINTERSTORE","ZLEXCOUNT","ZRANGE","ZRANGEBYLEX","ZREVRANGEBYLEX","ZRANGEBYSCORE","ZRANK","ZREM","ZREMRANGEBYLEX","ZREMRANGEBYRANK","ZREMRANGEBYSCORE","ZREVRANGE","ZREVRANGEBYSCORE","ZREVRANK","ZSCORE","ZUNIONSTORE","SCAN","SSCAN","HSCAN","ZSCAN"],functions:[]},Ms={type:ma.Z.SQLSERVER,keywords:["ABSOLUTE","ACTION","ADD","AFTER","ALL","ALTER","ALWAYS","AND","ANY","APPLY","AS","ASC","AUTHORIZATION","BACKUP","BEGIN","BETWEEN","BINARY","BREAK","BROWSE","BULK","BY","CASCADE","CASE","CAST","CATCH","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COALESCE","COLLATE","COLUMN","COMMIT","COMPUTE","CONSTRAINT","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CORRESPONDING","CREATE","CROSS","CURRENT","CURSOR","CYCLE","DATA","DATABASE","DBCC","DEALLOCATE","DECLARE","DEFAULT","DELETE","DENY","DESC","DESCRIPTION","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DISTRIBUTED","DOUBLE","DROP","DUMP","ELSE","ENABLE","END","ERRLVL","ESCAPE","EXCEPT","EXEC","EXECUTE","EXISTS","EXIT","EXTERNAL","FETCH","FILE","FILLFACTOR","FOLLOWING","FOR","FOREIGN","FROM","FULL","FUNCTION","GOTO","GRANT","GROUP","HAVING","HOLDLOCK","IDENTITY","IF","IN","INDEX","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","JOIN","KEY","KILL","LAST","LEFT","LIKE","LIMIT","LINENO","LOAD","LOCAL","MERGE","NATIONAL","NOCHECK","NONCLUSTERED","NOT","NULL","NULLIF","OF","OFF","OFFSETS","ON","ONLY","OPEN","OPTION","OR","ORDER","OUTER","OUTPUT","OVER","PARTITION","PERCENT","PLAN","PRECEDING","PRECISION","PRIMARY","PRINT","PROC","PROCEDURE","PUBLIC","RAISERROR","READ","READONLY","READTEXT","RECONFIGURE","REFERENCES","REPLICATION","RESTORE","RESTRICT","RETURN","REVOKE","RIGHT","ROLLBACK","ROWCOUNT","ROWGUIDCOL","RULE","SAVE","SCHEMA","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SESSION_USER","SET","SETUSER","SHUTDOWN","SOME","STATISTICS","SYSTEM_USER","TABLE","TABLESAMPLE","TEXTSIZE","THEN","THROW","TO","TOP","TRAN","TRANSACTION","TRIGGER","TRUNCATE","TRY","TSEQUAL","UNION","UNIQUE","UNPIVOT","UPDATE","UPDATETEXT","USE","USER","VALUES","VARYING","VIEW","WAITFOR","WHEN","WHERE","WHILE","WITH","WITHIN","WRITETEXT","XML"],functions:["ABS","ACOS","APP_NAME","ASCII","ASIN","ATAN","ATN2","AVG","BIGCOUNT","BINARY_CHECKSUM","CAST","CEILING","CHAR","CHARINDEX","CHECKSUM","CHECKSUM_AGG","COALESCE","COL_LENGTH","COL_NAME","CONCAT","CONCAT_WS","CONNECTIONPROPERTY","CONTEXT_INFO","CONVERT","COS","COT","COUNT","COUNT_BIG","CRYPT_GEN_RANDOM","CRYPT_PROPERTY","CURSOR_STATUS","DATABASEPROPERTYEX","DATEADD","DATEDIFF","DATENAME","DATEPART","DAY","DB_ID","DB_NAME","DEGREES","DIFFERENCE","EXP","FILE_ID","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FLOOR","FORMAT","GETANSINULL","GETDATE","GETUTCDATE","HASHBYTES","HOST_ID","HOST_NAME","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IIF","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","ISDATE","ISNULL","ISNUMERIC","IS_MEMBER","IS_OBJECTSIGNED","IS_SRVROLEMEMBER","ISNULL","LEFT","LEN","LOG","LOG10","LOWER","LTRIM","MAX","MIN","MONTH","NEWID","NULLIF","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","PARSE","PATINDEX","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","PI","POWER","RADIANS","RANK","REPLACE","REPLICATE","REVERSE","RIGHT","ROUND","ROW_NUMBER","RTRIM","SCOPE_IDENTITY","SERVERPROPERTY","SESSIONPROPERTY","SIGN","SIN","SOUNDEX","SPACE","SQRT","SQUARE","STATS_DATE","STDEV","STDEVP","STUFF","SUBSTRING","SUM","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","TAN","TEXTPTR","TEXTVALID","TRY_CAST","TRY_CONVERT","TRY_PARSE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","UNICODE","UPPER","USER_ID","USER_NAME","YEAR","GET_FILESTREAM_TRANSACTION_CONTEXT","CURRENT_TRANSACTION_ID","XACT_STATE","STRING_AGG","STRING_ESCAPE","STRING_SPLIT","FORMATMESSAGE","XML_SCHEMA_NAMESPACE","ISJSON","JSON_VALUE","JSON_QUERY","JSON_MODIFY","JSON_EXISTS","JSON_TEXTCONTAINS","CHOOSE","IIF","FORMAT","PARSE","SEQUENCE_SCHEMA","SEQUENCE_NAME","SPATIAL_ST_GEOMETRYTYPE","SPATIAL_ST_DIMENSION","SPATIAL_ST_SRID","SPATIAL_ST_ISVALID","SPATIAL_ST_ASTEXT","SPATIAL_ST_ASBINARY","SPATIAL_ST_AREA","SPATIAL_ST_LENGTH","SPATIAL_ST_ISCLOSED","SPATIAL_ST_NUMPOINTS","SPATIAL_ST_X","SPATIAL_ST_Y","SPATIAL_ST_NUMGEOMETRIES","SPATIAL_ST_BOUNDARY","SPATIAL_ST_BUFFER","SPATIAL_ST_CENTROID","SPATIAL_ST_CONTAINS","SPATIAL_ST_CONVEXHULL","SPATIAL_ST_CROSSES","SPATIAL_ST_DIFFERENCE","SPATIAL_ST_DISJOINT","SPATIAL_ST_DISTANCE","SPATIAL_ST_ENVELOPE","SPATIAL_ST_EQUALS","SPATIAL_ST_INTERSECTION","SPATIAL_ST_INTERSECTS","SPATIAL_ST_ISRING","SPATIAL_ST_ISSIMPLE","SPATIAL_ST_OVERLAPS","SPATIAL_ST_SYMDIFFERENCE","SPATIAL_ST_TOUCHES","SPATIAL_ST_UNION","SPATIAL_ST_WITHIN"]},Co={mysql:Os,oracle:js,postgresql:ks,redis:ws,sqlserver:Ms},go=function(a){return a.map(function(t){return{label:{label:t,detail:"",description:(0,s.ZP)("sqlEditor.text.keyword")},kind:we.languages.CompletionItemKind.Text,insertText:t,sortText:"08"}})},xo=function(a){return a.map(function(t){return{label:{label:t,detail:"",description:(0,s.ZP)("sqlEditor.text.function"),sortText:"09"},kind:we.languages.CompletionItemKind.Function,insertText:t}})},Io=function(){yo.dispose()},yo=we.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){return{suggestions:[]}}}),Zs=function(a){Io(),yo=we.languages.registerCompletionItemProvider("sql",{triggerCharacters:[" ","("],provideCompletionItems:function(r,o){var i=Object.values(Co).find(function(c){return c.type===a});if(i)return{suggestions:[].concat(_e()(go(i==null?void 0:i.keywords)),_e()(xo(i==null?void 0:i.functions)))};var u=Object.values(Co).find(function(c){return c.type===d.DatabaseTypeCode.MYSQL});return u?{suggestions:[].concat(_e()(go(u==null?void 0:u.keywords)),_e()(xo(u==null?void 0:u.functions)))}:{suggestions:[]}}})},Do=function(){Lo.dispose()},Lo=we.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){return{suggestions:[]}}}),Bs=function(a){for(var t=a.trim().toUpperCase(),r=["FROM","JOIN","INNER JOIN","LEFT JOIN","RIGHT JOIN","UPDATE"],o=0,i=r;o<i.length;o++){var u=i[o];if(t.endsWith(u))return!0}return!1},Us=function(a){Do(),Lo=we.languages.registerCompletionItemProvider("sql",{triggerCharacters:[" ","."],provideCompletionItems:function(r,o){var i=r.getValueInRange({startLineNumber:o.lineNumber,startColumn:1,endLineNumber:o.lineNumber,endColumn:o.column}),u=Bs(i);return{suggestions:(a||[]).map(function(c){var m=c.name,f=c.dataSourceName;return{label:{label:m,detail:f?"(".concat(f,")"):null,description:(0,s.ZP)("sqlEditor.text.databaseName")},insertText:m,sortText:u?"01":"08",kind:we.languages.CompletionItemKind.Property}})}}})},xt={},Ro=we.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){return{suggestions:[]}}}),Po=function(){Ro.dispose()},Fs=function(){var n=he()(ee()().mark(function a(t){var r,o,i,u,c;return ee()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(r=t.tableName,o=t.dataSourceId,i=t.databaseName,u=t.schemaName,xt[r]){f.next=6;break}return f.next=4,ye.Z.getAllFieldByTable({dataSourceId:o,databaseName:i,schemaName:u,tableName:r});case 4:c=f.sent,xt[r]=c;case 6:case"end":return f.stop()}},a)}));return function(t){return n.apply(this,arguments)}}();function Vs(n){for(var a=n.trim().toUpperCase(),t=["SELECT","WHERE","AND","OR","GROUP BY","ORDER BY","SET"],r=0,o=t;r<o.length;r++){var i=o[r];if(a.endsWith(i))return!0}return!1}var Ws=function(a,t,r,o){Po(),xt={},Ro=we.languages.registerCompletionItemProvider("sql",{triggerCharacters:[" ",",",".","("],provideCompletionItems:function(){var i=he()(ee()().mark(function c(m,f){var b,E,O,T,x,_;return ee()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(b=m.getValueInRange({startLineNumber:f.lineNumber,startColumn:1,endLineNumber:f.lineNumber,endColumn:f.column}),E=Vs(b),O=b.match(/(\b\w+\b)[^\w]*$/),O&&(T=O[1]),T){C.next=6;break}return C.abrupt("return");case 6:if(!(T&&a.includes(T)&&!xt[T])){C.next=11;break}return C.next=9,ye.Z.getAllFieldByTable({dataSourceId:t,databaseName:r,schemaName:o,tableName:T});case 9:x=C.sent,xt[T]=x;case 11:return _=Object.keys(xt).reduce(function(p,v){var k=xt[v].map(function(D){return{label:{label:D.name,detail:"(".concat(D.tableName,")"),description:(0,s.ZP)("sqlEditor.text.fieldName")},kind:we.languages.CompletionItemKind.Field,insertText:D.name,sortText:E?"01":"08"}});return[].concat(_e()(p),_e()(k))},[]),C.abrupt("return",{suggestions:_});case 13:case"end":return C.stop()}},c)}));function u(c,m){return i.apply(this,arguments)}return u}()})},Ao=function(){Oo.dispose()},Oo=we.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){return{suggestions:[]}}}),Hs=function(a){for(var t=a.trim().toUpperCase(),r=["FROM","JOIN","INNER JOIN","LEFT JOIN","RIGHT JOIN","UPDATE"],o=0,i=r;o<i.length;o++){var u=i[o];if(t.endsWith(u))return!0}return!1},Gs=function(a,t,r){return/^[\"\`\[]/.test(a)?t:lr(t,r)},qs=function(a,t,r,o,i){we.editor.registerCommand("addFieldList",function(u){Fs(arguments.length<=1?void 0:arguments[1])}),Ao(),Oo=we.languages.registerCompletionItemProvider("sql",{triggerCharacters:[" ","."],provideCompletionItems:function(c,m){var f=c.getValueInRange({startLineNumber:m.lineNumber,startColumn:1,endLineNumber:m.lineNumber,endColumn:m.column}),b=Hs(f),E=f.match(/\S+$/),O=E?E[0]:"";return{suggestions:(a||[]).map(function(T){return{label:{label:T.name,detail:o?"(".concat(o,")"):null,description:(0,s.ZP)("sqlEditor.text.tableName")},kind:we.languages.CompletionItemKind.Folder,insertText:Gs(O,T.name,t),sortText:b?"01":"08",command:{id:"addFieldList",title:"addFieldList",arguments:[{tableName:T.name,dataSourceId:r,databaseName:o,schemaName:i}]}}})}}})},Ks=function(){jo.dispose()},jo=we.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){return{suggestions:[]}}}),zs=function(a){for(var t=a.trim().toUpperCase(),r=["FROM","JOIN","INNER JOIN","LEFT JOIN","RIGHT JOIN","UPDATE"],o=0,i=r;o<i.length;o++){var u=i[o];if(t.endsWith(u))return!0}return!1},am=function(a,t){Ks(),jo=monaco.languages.registerCompletionItemProvider("sql",{triggerCharacters:[" "],provideCompletionItems:function(o,i){var u=o.getValueInRange({startLineNumber:i.lineNumber,startColumn:1,endLineNumber:i.lineNumber,endColumn:i.column}),c=zs(u);return{suggestions:(a||[]).map(function(m){return{label:{label:m,detail:t?"(".concat(t,")"):null,description:i18n("sqlEditor.text.viewName")},kind:monaco.languages.CompletionItemKind.Unit,insertText:m,sortText:c?"01":"08"}})}}})},Pn={key:"",label:"",value:""},Ys=(0,l.memo)(function(n){var a,t=n.boundInfo,r=n.setBoundInfo,o=(0,l.useContext)(Mo),i=o.setSelectedTables,u=o.setTableNameList,c=o.isActive,m=Ga(function(R){return R.connectionList}),f=(0,l.useState)([Pn]),b=j()(f,2),E=b[0],O=b[1],T=(0,l.useState)([Pn]),x=j()(T,2),_=x[0],N=x[1],C=(0,l.useState)([]),p=j()(C,2),v=p[0],k=p[1];(0,l.useEffect)(function(){c||(Io(),Ao(),Do(),Po())},[c]);var D=(0,l.useMemo)(function(){return(m==null?void 0:m.map(function(R){return{key:R.id.toString(),label:R.alias,value:R.id,type:R.type}}))||[]},[m]),S=(0,l.useMemo)(function(){var R;return m==null||(R=m.find(function(g){return g.id===t.dataSourceId}))===null||R===void 0?void 0:R.supportDatabase},[t.dataSourceId,m]),M=(0,l.useMemo)(function(){var R;return m==null||(R=m.find(function(g){return g.id===t.dataSourceId}))===null||R===void 0?void 0:R.supportSchema},[t.dataSourceId,m]);(0,l.useEffect)(function(){c&&Zs(t.databaseType)},[t.dataSourceId,c]),(0,l.useEffect)(function(){!c||t.connectable===!1||S&&(N([]),O([]),I())},[t.dataSourceId,c]),(0,l.useEffect)(function(){!c||t.connectable===!1||(M&&(N([]),L()),!M&&t.databaseName&&B(t.dataSourceId,t.databaseName))},[t.databaseName,c,M]),(0,l.useEffect)(function(){!c||t.connectable===!1||M&&t.schemaName&&B(t.dataSourceId,t.databaseName,t.schemaName)},[t.schemaName,c,M]);var I=function(){t.dataSourceId===void 0||t.dataSourceId===null||ra.getDatabaseList({dataSourceId:t.dataSourceId}).then(function(g){var A=[],V=g.map(function(U){return A.push({name:U.name,dataSourceName:t.dataSourceName}),{key:U.name,label:U.name,value:U.name}});V.length||L(),O([Pn].concat(_e()(V)))})},L=function(){t.dataSourceId===void 0||t.dataSourceId===null||ra.getSchemaList({dataSourceId:t.dataSourceId,databaseName:t==null?void 0:t.databaseName}).then(function(g){var A=g.map(function(V){return{key:V.name,label:V.name,value:V.name}});N([Pn].concat(_e()(A)))})};(0,l.useEffect)(function(){if(c){var R=v.map(function(g){return g.name});u(R),qs(v,t.databaseType,t.dataSourceId,t.databaseName,t.schemaName),Ws(R,t.dataSourceId,t.databaseName,t.schemaName),i(R.slice(0,1))}},[v,c]),(0,l.useEffect)(function(){var R=E.map(function(g){return{name:g.value,dataSourceName:t.dataSourceName}});Us(R)},[E]);var P=function(g){var A=D.find(function(V){return V.key===g.key});r(h()(h()({},t),{},{dataSourceId:A.value,dataSourceName:A.label,databaseType:A.type,databaseName:void 0,schemaName:void 0})),t.consoleId&&Pa.updateSavedConsole({id:t.consoleId,dataSourceId:A.value,dataSourceName:A.label,type:A.type})},w=function(g){var A,V=E==null||(A=E.find(function(U){return U.key===g.key}))===null||A===void 0?void 0:A.value;r(h()(h()({},t),{},{databaseName:V,schemaName:void 0})),t.consoleId&&Pa.updateSavedConsole({id:t.consoleId,databaseName:V})},Z=function(g){var A,V=_==null||(A=_.find(function(U){return U.key===g.key}))===null||A===void 0?void 0:A.value;r(h()(h()({},t),{},{schemaName:V})),t.consoleId&&Pa.updateSavedConsole({id:t.consoleId,schemaName:V})},B=function(g,A,V){ye.Z.getAllTableList({dataSourceId:g,databaseName:A,schemaName:V}).then(function(U){k(U)})};return(0,e.jsxs)("div",{className:pt.consoleOptionsRight,children:[(0,e.jsx)("div",{className:pt.boundInfoBoxSpacer}),(0,e.jsx)(Ae.Z,{menu:{items:D,onClick:P},trigger:["click"],children:(0,e.jsxs)("div",{className:pt.boundInfoBox,children:[(0,e.jsx)(X.Z,{code:(a=As.dt[t.databaseType])===null||a===void 0?void 0:a.icon}),(0,e.jsx)("div",{className:pt.boundInfoName,children:t.dataSourceName||"<".concat("dataSource",">")}),(0,e.jsx)(X.Z,{code:"\u{100BE}"})]})}),S&&(0,e.jsx)(Ae.Z,{menu:{items:E,onClick:w},trigger:["click"],children:(0,e.jsxs)("div",{className:pt.boundInfoBox,children:[(0,e.jsx)(X.Z,{code:"\uE669"}),(0,e.jsx)("div",{className:pt.boundInfoName,children:t.databaseName||"<".concat("database",">")}),(0,e.jsx)(X.Z,{code:"\u{100BE}"})]})}),M&&(0,e.jsx)(Ae.Z,{menu:{items:_,onClick:Z},trigger:["click"],children:(0,e.jsxs)("div",{className:pt.boundInfoBox,children:[(0,e.jsx)(X.Z,{code:"\uE663"}),(0,e.jsx)("div",{className:pt.boundInfoName,children:t.schemaName||"<".concat("schema",">")}),(0,e.jsx)(X.Z,{code:"\u{100BE}"})]})})]})}),Qs=Ys,ko=function(){return(0,fa.bP)().isMac?{command:"Cmd",Shift:"Shift"}:{command:"Ctrl",Shift:"Shift"}}(),$s=function(a){var t=a.boundInfo,r=a.saveConsole,o=a.editorRef,i=a.hasSaveBtn,u=a.executeSQL,c=a.setBoundInfo,m=function(){var b,E="select",O=o==null||(b=o.current)===null||b===void 0?void 0:b.getCurrentSelectContent();if(!O){var T;O=(o==null||(T=o.current)===null||T===void 0?void 0:T.getAllContent())||"",E="cover"}no(O,t.databaseType).then(function(x){var _;o==null||(_=o.current)===null||_===void 0||_.setValue(x,E)})};return(0,e.jsxs)("div",{className:Rn.consoleOptionsWrapper,children:[(0,e.jsxs)("div",{className:Rn.consoleOptionsLeft,children:[(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:[ko.command,"R"].join("+"),trigger:"hover",children:(0,e.jsxs)(Oe.ZP,{type:"primary",className:Rn.runButton,onClick:function(){return u()},children:[(0,e.jsx)(X.Z,{code:"\uE637"}),(0,s.ZP)("common.button.execute")]})}),i&&(0,e.jsx)(xa.Z,{mouseEnterDelay:.8,content:[ko.command,"S"].join("+"),trigger:"hover",children:(0,e.jsx)(Oe.ZP,{type:"default",className:Rn.saveButton,onClick:function(){var b;return r(o==null||(b=o.current)===null||b===void 0?void 0:b.getAllContent())},children:(0,s.ZP)("common.button.save")})}),(0,e.jsx)(Oe.ZP,{type:"default",onClick:m,children:(0,s.ZP)("common.button.format")})]}),(0,e.jsx)(Qs,{setBoundInfo:c,boundInfo:t})]})},Js=$s,Xs={CHAT2DB_KEY_INVALID:"apikey \u4E0D\u5728\u6211\u4EEC\u7684\u6570\u636E\u5E93\u4E2D\u9700\u8981\u626B\u7801\u767B\u5F55",CHAT2DB_KEY_LIMIT:"\u6B21\u6570\u7528\u5B8C\u4E86\uFF0C\u9700\u8981\u53D1\u8D77\u63A8\u5E7F",CHAT2DB_KEY_EXPIRED:"\u5230\u8FC7\u671F\u65F6\u95F4\u4E86",CHAT2DB_SERVICE_BUSY:"\u8FD9\u4E2A\u5F02\u5E38\u5C31\u7A0D\u540E\u91CD\u8BD5\u5C31\u884C\u4E86",CHAT2DB_AUTH_HEADER_MISSING:"\u8FD9\u4E2A\u662F http \u8BF7\u6C42 header \u6CA1\u4F20 Authorization \u5B57\u6BB5\uFF0C\u8FD9\u4E2A\u4F60\u770B\u8981\u600E\u4E48\u5904\u7406",CHAT2DB_AUTH_TOKEN_MISSING:"\u8FD9\u4E2A\u662F http \u8BF7\u6C42 header \u4E2D Authorization \u540E\u9762\u6CA1\u6709\u4EE5 Bearer \u5F00\u5934\uFF0C\u4E5F\u662F\u4F20\u7684\u8BA4\u8BC1\u4FE1\u606F\u6709\u95EE\u9898\uFF0C\u4F60\u770B\u8981\u600E\u4E48\u5904\u7406",CHAT2DB_SERVICE_ERROR:"\u8FD9\u4E2A\u662F\u51FA\u4E86\u610F\u6599\u4E4B\u5916\u7684\u5F02\u5E38\u8981\u8054\u7CFB\u7BA1\u7406\u5458",CHAT2DB_BAD_JSON_FORMAT:"\u8FD9\u4E2A\u662F\u4F20\u7684\u8BF7\u6C42\u4E0D\u662F json \u683C\u5F0F",CHAT2DB_HTTP_METHOD_INVALID:"\u8FD9\u4E2A\u662F\u4F20\u7684\u8BF7\u6C42\u4E0D\u662F post \u8BF7\u6C42\uFF0C\u76EE\u524D\u7ED9 openai \u7684\u8BF7\u6C42\u5FC5\u987B\u662F post"},tm=Object.keys(Xs),eu=["CHAT2DB_KEY_INVALID","CHAT2DB_AUTH_HEADER_MISSING","CHAT2DB_AUTH_TOKEN_MISSING"],au=["CHAT2DB_KEY_LIMIT","CHAT2DB_KEY_EXPIRED"],tu=K(45718),nu=K(64098),An={console:"console___zbFbP",consoleEditor:"consoleEditor___lCJpl",consoleEditorWithChat:"consoleEditorWithChat___oYKu9",aiBlock:"aiBlock___jdERv"},rn=K(67381),ru=function(a){var t=a.isActive,r=a.source,o=a.editorRef,i=a.boundInfo,u=a.defaultValue,c=(0,l.useRef)(),m=(0,l.useRef)(u),f=(0,l.useState)(i.status||d.ConsoleStatus.DRAFT),b=j()(f,2),E=b[0],O=b[1],T=function(N,C){var p={id:i.consoleId,status:d.ConsoleStatus.RELEASE,ddl:N};Pa.updateSavedConsole(p).then(function(){mn(),rn.ZP.deleteData("chat2db","workspaceConsoleDDL",i.consoleId),m.current=N,O(d.ConsoleStatus.RELEASE),!C&&(Ge.ZP.success((0,s.ZP)("common.tips.saveSuccessfully")),x(d.ConsoleStatus.RELEASE))})};function x(_){c.current&&clearInterval(c.current),c.current=setInterval(function(){var N,C=o==null||(N=o.current)===null||N===void 0?void 0:N.getAllContent();C!==m.current&&(E===d.ConsoleStatus.RELEASE||_===d.ConsoleStatus.RELEASE?T(C,!0):rn.ZP.updateData("chat2db","workspaceConsoleDDL",{consoleId:i.consoleId,ddl:C,userId:(0,fa.ej)("CHAT2DB.USER_ID")}).then(function(){m.current=C}))},5e3)}return(0,l.useEffect)(function(){if(r==="workspace"){if(t)x();else{var _;c.current&&clearInterval(c.current);var N=o==null||(_=o.current)===null||_===void 0?void 0:_.getAllContent();if(N===m.current)return;E===d.ConsoleStatus.RELEASE?T(N,!0):rn.ZP.updateData("chat2db","workspaceConsoleDDL",{consoleId:i.consoleId,ddl:N,userId:(0,fa.ej)("CHAT2DB.USER_ID")}).then(function(){m.current=N})}return function(){c.current&&clearInterval(c.current)}}},[t]),(0,l.useEffect)(function(){if(E===d.ConsoleStatus.RELEASE){var _;o==null||(_=o.current)===null||_===void 0||_.setValue(u,"cover")}else rn.ZP.getDataByCursor("chat2db","workspaceConsoleDDL",{consoleId:i.consoleId,userId:(0,fa.ej)("CHAT2DB.USER_ID")}).then(function(N){var C,p=o==null||(C=o.current)===null||C===void 0?void 0:C.getAllContent();if(!p){var v,k;o==null||(v=o.current)===null||v===void 0||v.setValue((N==null||(k=N[0])===null||k===void 0?void 0:k.ddl)||"","cover")}})},[]),{saveConsole:T,saveStatus:E}},Ut=K(59170),wo=function(){var a=Re.getState().currentConnectionDetails;a&&$a({dataSourceId:a.id,dataSourceName:a.alias,databaseType:a.type})},ou=function(){var a=function(r){(r.metaKey&&r.shiftKey&&r.code==="KeyL"||r.ctrlKey&&r.shiftKey&&r.key==="KeyL")&&wo()};return window.addEventListener("keydown",a),function(){window.removeEventListener("keydown",a)}},lu=ou,Ft=function(n){return n.NL_2_SQL="NL_2_SQL",n.SQL_EXPLAIN="SQL_EXPLAIN",n.SQL_OPTIMIZER="SQL_OPTIMIZER",n.SQL_2_SQL="SQL_2_SQL",n.ChatRobot="ChatRobot",n}(Ft||{}),Mo=(0,l.createContext)({});function iu(n,a){var t=n.hasAiChat,r=t===void 0?!0:t,o=n.boundInfo,i=n.setBoundInfo,u=n.appendValue,c=n.hasSaveBtn,m=c===void 0?!0:c,f=n.source,b=n.defaultValue,E=n.isActive,O=(0,l.useMemo)(function(){return(0,Ce.Z)()},[]),T=(0,l.useRef)(""),x=(0,l.useRef)(),_=(0,l.useState)([]),N=j()(_,2),C=N[0],p=N[1],v=(0,l.useState)([]),k=j()(v,2),D=k[0],S=k[1],M=(0,l.useState)(0),I=j()(M,2),L=I[0],P=I[1],w=(0,l.useState)(!1),Z=j()(w,2),B=Z[0],R=Z[1],g=(0,l.useState)(""),A=j()(g,2),V=A[0],U=A[1],Q=(0,l.useState)(!1),G=j()(Q,2),z=G[0],y=G[1],F=(0,l.useState)(!1),q=j()(F,2),Y=q[0],J=q[1],de=(0,l.useState)(!1),se=j()(de,2),Me=se[0],oe=se[1],ue=(0,l.useState)({}),Te=j()(ue,2),He=Te[0],Pe=Te[1],Ze=(0,l.useState)(!1),Ee=j()(Ze,2),je=Ee[0],be=Ee[1],De=(0,l.useRef)(),ge=(0,l.useRef)(),Ke=(0,Ut.VF)(function(ke){return{aiConfig:ke.aiConfig,hasWhite:ke.hasWhite,remainingUse:ke.remainingUse}}),fe=Ke.aiConfig,ta=Ke.hasWhite,_a=Ke.remainingUse,rt=ru({editorRef:x,isActive:E,boundInfo:n.boundInfo,source:f,defaultValue:b}),Nt=rt.saveConsole,na=(0,l.useMemo)(function(){return(fe==null?void 0:fe.aiSqlSource)===tu.k.CHAT2DBAI},[fe==null?void 0:fe.aiSqlSource]);(0,l.useEffect)(function(){Qa()},[ta,localStorage.getItem("syncTableModel")]),(0,l.useEffect)(function(){if(u){var ke;x==null||(ke=x.current)===null||ke===void 0||ke.setValue(u.text,u.range)}},[u]),(0,l.useImperativeHandle)(a,function(){return{editorRef:x==null?void 0:x.current}},[x==null?void 0:x.current]);var Dt=function(){var ke=he()(ee()().mark(function Ie(Be){var Qe,pa,Ha,St,oa;return ee()().wrap(function(Ta){for(;;)switch(Ta.prev=Ta.next){case 0:return R(!0),Ta.prev=1,Ta.next=4,Eo.Z.getLoginQrCode({});case 4:Qe=Ta.sent,pa=Qe.wechatQrCodeUrl,Ha=Qe.token,St=Qe.tip,R(!1),oe(!0),Pe({imageUrl:pa,token:Ha,tip:St}),Be&&(oa=0,De.current=setInterval(he()(ee()().mark(function Gt(){var it,Ba;return ee()().wrap(function(ha){for(;;)switch(ha.prev=ha.next){case 0:return ha.next=2,Eo.Z.getLoginStatus({token:Ha});case 2:if(ha.t0=ha.sent,ha.t0){ha.next=5;break}ha.t0={};case 5:it=ha.t0,Ba=it.apiKey,oa++,(Ba||oa>=60)&&clearInterval(De.current),Ba&&(oe(!1),(0,Ut.zB)(h()(h()({},fe||{}),{},{apiKey:Ba})),(0,Ut.bv)(Ba));case 10:case"end":return ha.stop()}},Gt)})),3e3)),Ta.next=17;break;case 14:Ta.prev=14,Ta.t0=Ta.catch(1),R(!1);case 17:case"end":return Ta.stop()}},Ie,null,[[1,14]])}));return function(Be){return ke.apply(this,arguments)}}(),ot=function(){var ke=he()(ee()().mark(function Ie(Be,Qe,pa){var Ha;return ee()().wrap(function(oa){for(;;)switch(oa.prev=oa.next){case 0:return oa.next=2,nu.Z.getAiSystemConfig({});case 2:Ha=oa.sent,lt(Be,Qe,Ha,pa);case 4:case"end":return oa.stop()}},Ie)}));return function(Be,Qe,pa){return ke.apply(this,arguments)}}(),lt=function(){var ke=he()(ee()().mark(function Ie(Be,Qe,pa,Ha){var St,oa,sn,Ta,Gt,it,Ba,un,ha;return ee()().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(St=pa||fe||{},oa=St.apiKey,!(!oa&&na)){Lt.next=4;break}return Dt(!0),Lt.abrupt("return");case 4:sn=o.dataSourceId,Ta=o.databaseName,Gt=o.schemaName,it=Qe===Ft.NL_2_SQL,it?R(!0):(U(""),y(!0),J(!0)),Ba=Ss({message:Be,promptType:Qe,dataSourceId:sn,databaseName:Ta,schemaName:Gt,tableNames:L?C:null,ext:Ha}),un=function(st){R(!1),J(!1);try{var Un=st==="[DONE]";if(Un){if(ge.current(),be(!1),na&&(0,Ut.bv)(oa),it){var cn;x==null||(cn=x.current)===null||cn===void 0||cn.setValue(`
`)}else J(!1),T.current+=`
`,U(T.current),T.current="";return}var dn=!1;eu.forEach(function(qt){st.includes(qt)&&(dn=!0)});var Fn=!1;if(au.forEach(function(qt){st.includes(qt)&&(Fn=!0)}),Fn){ge.current(),R(!1),Ya();return}if(dn){ge.current(),R(!1),dn&&Dt(!0),(0,Ut.bv)(oa);return}if(it){var Tt;x==null||(Tt=x.current)===null||Tt===void 0||Tt.setValue(JSON.parse(st).content)}else T.current+=JSON.parse(st).content,U(T.current)}catch(qt){R(!1),be(!1),J(!1),ge.current()}},ha=function(st){console.error("Error:",st),R(!1),J(!1),be(!1),ge.current()},ge.current=Es({url:"/api/ai/chat?".concat(Ba),uid:O,onOpen:function(){be(!0)},onMessage:un,onError:ha});case 11:case"end":return Lt.stop()}},Ie)}));return function(Be,Qe,pa,Ha){return ke.apply(this,arguments)}}(),Ht=function(Ie){var Be,Qe,pa=Ie||(x==null||(Be=x.current)===null||Be===void 0?void 0:Be.getCurrentSelectContent())||(x==null||(Qe=x.current)===null||Qe===void 0?void 0:Qe.getAllContent());pa&&n.onExecuteSQL&&n.onExecuteSQL(pa)},on=[{id:"explainSQL",label:(0,s.ZP)("common.text.explainSQL"),action:function(Ie){return ot(Ie,Ft.SQL_EXPLAIN)}},{id:"optimizeSQL",label:(0,s.ZP)("common.text.optimizeSQL"),action:function(Ie){return ot(Ie,Ft.SQL_OPTIMIZER)}},{id:"changeSQL",label:(0,s.ZP)("common.text.conversionSQL"),action:function(Ie,Be){ot(Ie,Ft.SQL_2_SQL,Be)}}],Ya=function(){Pe({imageUrl:"http://oss.sqlgpt.cn/static/chat2db-wechat.jpg?x-oss-process=image/auto-orient,1/resize,m_lfit,w_256/quality,Q_80/format,webp",tip:(0,e.jsxs)(e.Fragment,{children:[(_a==null?void 0:_a.remainingUses)===0&&(0,e.jsx)("p",{children:"Key\u6B21\u6570\u7528\u5B8C\u6216\u8005\u8FC7\u671F"}),(0,e.jsx)("p",{children:"\u5FAE\u4FE1\u626B\u63CF\u4E8C\u7EF4\u7801\u5E76\u5173\u6CE8\u516C\u4F17\u53F7\u83B7\u5F97 AI \u4F7F\u7528\u673A\u4F1A\u3002"})]})}),oe(!0)},Qa=function(){var Ie=localStorage.getItem("syncTableModel"),Be=ta;if(Ie!==null){P(Number(Ie));return}P(Be?Ln.AUTO:Ln.MANUAL)},ln=function(Ie,Be){Ie.addCommand(Be.KeyMod.CtrlCmd|Be.KeyCode.KeyS,function(){var Qe=Ie==null?void 0:Ie.getValue();Nt(Qe||"")}),Ie.addCommand(Be.KeyMod.CtrlCmd|Be.KeyCode.KeyR,function(){var Qe,pa=(Qe=x.current)===null||Qe===void 0?void 0:Qe.getCurrentSelectContent();Ht(pa)}),Ie.addCommand(Be.KeyMod.CtrlCmd|Be.KeyMod.Shift|Be.KeyCode.KeyL,function(){wo()})};return(0,e.jsx)(Mo.Provider,{value:{isActive:E,tableNameList:D,setTableNameList:S,selectedTables:C,setSelectedTables:p},children:(0,e.jsxs)("div",{className:An.console,ref:a,children:[(0,e.jsxs)(mt.Z,{spinning:B,style:{height:"100%"},children:[r&&(0,e.jsx)(Ls,{isStream:je,disabled:B,aiType:fe==null?void 0:fe.aiSqlSource,tables:D,onPressEnter:function(Ie){lt(Ie,Ft.NL_2_SQL)},selectedTables:C,onSelectTables:function(Ie){p(Ie)},syncTableModel:L,onSelectTableSyncModel:function(Ie){P(Ie),localStorage.setItem("syncTableModel",String(Ie))},onCancelStream:function(){ge.current(),be(!1),R(!1)}}),(0,e.jsx)(gt,{id:O,defaultValue:b,ref:x,className:r?An.consoleEditorWithChat:An.consoleEditor,addAction:on,options:n.editorOptions,shortcutKey:ln,isActive:E}),(0,e.jsx)(mr.Z,{open:z,getContainer:!1,mask:!1,onClose:function(){try{y(!1),J(!1),be(!1),ge.current&&ge.current()}catch(Ie){}},children:(0,e.jsx)(mt.Z,{spinning:Y,style:{height:"100%"},children:(0,e.jsx)("div",{className:An.aiBlock,children:V})})})]}),(0,e.jsx)(Js,{boundInfo:o,saveConsole:Nt,executeSQL:Ht,editorRef:x,setBoundInfo:i,hasSaveBtn:m}),(0,e.jsx)(Aa.Z,{open:Me,footer:!1,onCancel:function(){De.current&&clearInterval(De.current),oe(!1)},children:(0,e.jsx)(Ps,h()({},He))})]})})}var Zo=(0,l.forwardRef)(iu),su=(0,l.memo)(function(n){var a=n.boundInfo,t=n.initDDL,r=n.loadSQL,o=(0,l.useRef)(),i=(0,l.useRef)(null),u=(0,l.useRef)(null),c=(0,l.useState)(a),m=j()(c,2),f=m[0],b=m[1],E=Re(function(O){return O.activeConsoleId});return(0,l.useEffect)(function(){r&&r().then(function(O){var T;(T=u.current)===null||T===void 0||(T=T.editorRef)===null||T===void 0||T.setValue(O,"cover")})},[]),(0,e.jsx)("div",{className:$()(Dn.sqlExecute),children:(0,e.jsxs)(vn,{layout:"column",className:Dn.boxRightCenter,children:[(0,e.jsx)("div",{ref:o,className:Dn.boxRightConsole,children:(0,e.jsx)(Zo,{ref:u,source:"workspace",defaultValue:t,boundInfo:f,setBoundInfo:b,hasAiChat:!0,hasAi2Lang:!0,isActive:E===f.consoleId,onExecuteSQL:function(T){var x;(x=i.current)===null||x===void 0||x.handleExecuteSQL(T)}})}),(0,e.jsx)("div",{className:Dn.boxRightResult,children:(0,e.jsx)(mo,{isActive:E===f.consoleId,ref:i,executeSqlParams:f})})]})})}),uu=su,tt={"f-icon-button":"f-icon-button___xED4O","f-fill-absolute":"f-fill-absolute___W2uY5","f-button":"f-button___yTJqi","f-doc-en-break":"f-doc-en-break___TortO",allTable:"allTable___omCPb",contentCenter:"contentCenter___uKcMR",tableBox:"tableBox___WdSmt",viewDDLBox:"viewDDLBox___ImFVK",viewDDLHeader:"viewDDLHeader___wJGJq",viewDDL:"viewDDL___a3RY2",headerBox:"headerBox___fkoeh",headerBoxLeft:"headerBoxLeft___SgKrY",pagingBox:"pagingBox___sQYX6",tableCell:"tableCell___p5b0F",activeTableCell:"activeTableCell___E_q_U","loading-animation":"loading-animation___WZoif"},cu=K(22401),du=xe.Z.Search,mu=(0,l.memo)(function(n){var a=n.className,t=n.uniqueData,r=l.useState(null),o=j()(r,2),i=o[0],u=o[1],c=l.useState(!1),m=j()(c,2),f=m[0],b=m[1],E=l.useRef(null),O=l.useState(0),T=j()(O,2),x=T[0],_=T[1],N=l.useState(0),C=j()(N,2),p=C[0],v=C[1],k=l.useState(""),D=j()(k,2),S=D[0],M=D[1],I=l.useState(0),L=j()(I,2),P=L[0],w=L[1],Z=l.useState(1),B=j()(Z,2),R=B[0],g=B[1],A=l.useState(void 0),V=j()(A,2),U=V[0],Q=V[1],G=l.useState([]),z=j()(G,2),y=z[0],F=z[1];(0,l.useEffect)(function(){q({pageNo:1,pageSize:1e3})},[]),(0,l.useEffect)(function(){U===!1&&Q(void 0)},[U]);var q=function(Te){g(Te.pageNo),b(!0),ye.Z.getTableList(h()(h()({},n.uniqueData),Te||{})).then(function(He){w(He.total);var Pe=He.data.map(function(Ze){var Ee=(0,Ce.Z)();return{uuid:Ee,name:Ze.name,treeNodeType:d.TreeNodeType.TABLE,key:Ze.name,pinned:Ze.pinned,comment:Ze.comment,extraParams:h()(h()({},t),{},{tableName:Ze.name})}});u(Pe)}).finally(function(){b(!1)})},Y=function(Te){q({pageNo:Te,pageSize:1e3})},J=function(){ia({id:(0,Ce.Z)(),title:(0,s.ZP)("editTable.button.createTable"),type:d.WorkspaceTabType.CreateTable,uniqueData:h()({},n.uniqueData)})},de=function(Te){var He=Yl({treeNodeData:Te,loadData:function(){}}),Pe=He.map(function(Ee){return{key:Ee.key,type:Ee.type,onClick:function(){Q(!1),Ee.onClick(Te)},label:(0,e.jsx)(ba,{icon:Ee.labelProps.icon,label:Ee.labelProps.label})}}),Ze=[d.OperationColumn.OpenTable,d.OperationColumn.CreateConsole,d.OperationColumn.ViewDDL,d.OperationColumn.EditTable,d.OperationColumn.CopyName];return Pe.filter(function(Ee){return Ze.includes(Ee.type)})},se=function(Te,He){return(0,e.jsx)("div",{className:$()(tt.tableCell,W()({},tt.activeTableCell,S===He.key)),children:Te})},Me=[{title:"Table name",dataIndex:"name",key:"name",render:se},{title:"Comment",dataIndex:"comment",key:"comment",render:se}];(0,l.useEffect)(function(){var ue=new ResizeObserver(function(Te){var He=Te[0].contentRect,Pe=He.width,Ze=He.height;_(Pe),v(Ze)});ue.observe(E.current)},[]),(0,l.useEffect)(function(){var ue=new ResizeObserver(function(Te){var He=Te[0].contentRect,Pe=He.width,Ze=He.height;_(Pe),v(Ze)});ue.observe(E.current)},[]);var oe=function(Te){q({pageNo:1,pageSize:1e3,searchKey:Te})};return(0,e.jsxs)("div",{className:$()(tt.allTable,a),children:[(0,e.jsxs)("div",{className:tt.headerBox,children:[(0,e.jsxs)("div",{className:tt.headerBoxLeft,children:[(0,e.jsx)(X.Z,{code:"\uE726",box:!0,boxSize:24,onClick:J}),(0,e.jsx)(X.Z,{onClick:function(){q({pageNo:1,pageSize:1e3,refresh:!0})},code:"\uE668",box:!0,boxSize:24})]}),(0,e.jsx)("div",{className:tt.headerBoxRight,children:(0,e.jsx)(du,{size:"small",placeholder:(0,s.ZP)("common.text.search"),onSearch:oe,style:{width:150}})})]}),(0,e.jsx)("div",{className:tt.contentCenter,children:(0,e.jsx)(Ae.Z,{open:U,menu:{items:y},trigger:["contextMenu"],onOpenChange:function(Te){Q(Te)},children:(0,e.jsx)("div",{ref:E,className:tt.tableBox,children:(0,e.jsx)(et.Z,{loading:f,onRow:function(Te){return{onClick:function(){M(Te.key),Cr({code:"viewDDL",uniqueData:h()(h()({},t),{},{tableName:Te.name})})},onContextMenu:function(Pe){Pe.preventDefault(),M(Te.key),Q(!0),F(de(i==null?void 0:i.find(function(Ze){return Ze.key===Te.key})))}}},virtual:!0,scroll:{x:x-10,y:p-25},columns:Me,pagination:!1,dataSource:i||[]})})})}),(0,e.jsx)("div",{className:tt.pagingBox,children:(0,e.jsx)(cu.Z,{onChange:Y,showSizeChanger:!1,current:R,pageSize:1e3,total:P})})]})}),It={"f-icon-button":"f-icon-button___Pa9AF","f-fill-absolute":"f-fill-absolute___b9t4A","f-button":"f-button___bQzq7","f-doc-en-break":"f-doc-en-break___cG5ht",box:"box___Om4_e",letterpress:"letterpress___ewLb2",shortcutsItem:"shortcutsItem___DAPrq",title:"title___CVodl",plusSignBox:"plusSignBox___FDUqj",plusSign:"plusSign___qFChU","loading-animation":"loading-animation___bPN5X"},On=function(){return(0,fa.bP)().isMac?{command:"Cmd",Shift:"Shift"}:{command:"Ctrl",Shift:"Shift"}}(),fu=[{title:(0,s.ZP)("common.text.textToSQL"),keys:["Enter"]},{title:(0,s.ZP)("common.text.optimizeSQL"),keys:[(0,s.ZP)("common.text.editorRightClick")]},{title:(0,s.ZP)("common.text.executeSelectedSQL"),keys:[On.command,"R"]},{title:(0,s.ZP)("common.text.saveConsole"),keys:[On.command,"S"]},{title:(0,s.ZP)("common.button.createConsole"),keys:[On.command,On.Shift,"L"]}],vu=(0,l.memo)(function(n){var a=n.className,t=n.slot;return(0,e.jsxs)("div",{className:$()(It.box,a),children:[(0,e.jsx)("div",{className:It.letterpress,children:"Chat2DB"}),(0,e.jsx)("div",{className:It.shortcuts,children:fu.map(function(r,o){return(0,e.jsxs)("div",{className:It.shortcutsItem,children:[(0,e.jsx)("div",{className:It.title,children:r.title}),(0,e.jsx)("div",{className:It.plusSignBox,children:r.keys.map(function(i,u){return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)("span",{children:i}),u+1<r.keys.length&&(0,e.jsx)("span",{className:It.plusSign,children:"+"})]},u)})})]},o)})}),t()]})}),_u=(0,l.memo)(function(){var n=Re(function(p){return{consoleList:p.consoleList,activeConsoleId:p.activeConsoleId,workspaceTabList:p.workspaceTabList}}),a=n.activeConsoleId,t=n.consoleList,r=n.workspaceTabList,o=Re(function(p){return p.currentConnectionDetails});(0,l.useEffect)(function(){Tr()},[]),(0,l.useEffect)(function(){var p=(t==null?void 0:t.map(function(v){return{id:v.id,type:v.operationType,title:v.name,uniqueData:{dataSourceId:v.dataSourceId,dataSourceName:v.dataSourceName,databaseType:v.type,databaseName:v.databaseName,schemaName:v.schemaName,status:v.status,ddl:v.ddl,connectable:v.connectable}}}))||[];wt(p)},[t]);var i=function(v){var k={id:v,tabOpened:"n"};Pa.updateSavedConsole(k).then(function(){rn.ZP.deleteData("chat2db","workspaceConsoleDDL",v)})},u=function(){var v=$t.getState().focusTreeNode||{},k=v.databaseName,D=v.schemaName;o&&$a({dataSourceId:o.id,dataSourceName:o.alias,databaseType:o.type,databaseName:k,schemaName:D})},c=function(v,k){v==="remove"&&(wt((r==null?void 0:r.filter(function(D){return k.findIndex(function(S){return S.key===D.id})===-1}))||[]),k.forEach(function(D){var S=r==null?void 0:r.find(function(M){return M.id===D.key});((S==null?void 0:S.type)===d.WorkspaceTabType.CONSOLE||(S==null?void 0:S.type)===d.WorkspaceTabType.FUNCTION||(S==null?void 0:S.type)===d.WorkspaceTabType.PROCEDURE||(S==null?void 0:S.type)===d.WorkspaceTabType.TRIGGER||(S==null?void 0:S.type)===d.WorkspaceTabType.VIEW||(S==null?void 0:S.type)==="table"||!(S!=null&&S.type))&&i(D.key)})),v==="add"&&u()},m=function(v){fn(v)},f=function(v){var k={id:v.key,name:v.label};Pa.updateSavedConsole(k);var D=(r==null?void 0:r.map(function(S){return S.id===v.key?h()(h()({},S),{},{title:v.label}):S}))||[];wt(D)},b=function(v){var k=(r==null?void 0:r.map(function(D){return D.id===v.id?v:D}))||[];wt(k)},E=function(v){var k=v.uniqueData;return(0,e.jsx)(uu,{boundInfo:{dataSourceId:k.dataSourceId,dataSourceName:k.dataSourceName,databaseName:k==null?void 0:k.databaseName,databaseType:k.databaseType,schemaName:k==null?void 0:k.schemaName,consoleId:v.id,status:k.status,connectable:k.connectable,supportDatabase:k.supportDatabase,supportSchema:k.supportSchema},initDDL:k.ddl,loadSQL:k.loadSQL})},O=function(v){var k=v.uniqueData;return(0,e.jsx)(Ns,{tabDetails:v,changeTabDetails:b,dataSourceId:k.dataSourceId,databaseName:k.databaseName,databaseType:k==null?void 0:k.databaseType,schemaName:k==null?void 0:k.schemaName,tableName:k.tableName,submitCallback:k.submitCallback})},T=function(v){var k=v.uniqueData;return(0,e.jsx)(mo,{isActive:a===v.id,sql:k.sql,executeSqlParams:k,viewTable:!0,concealTabHeader:!0})},x=function(v){var k=v.uniqueData;return(0,e.jsx)(mu,{uniqueData:k})},_=function(v){switch(v.type){case"table":case null:case d.WorkspaceTabType.CONSOLE:case d.WorkspaceTabType.FUNCTION:case d.WorkspaceTabType.PROCEDURE:case d.WorkspaceTabType.TRIGGER:case d.WorkspaceTabType.VIEW:return E(v);case d.WorkspaceTabType.EditTable:case d.WorkspaceTabType.CreateTable:return O(v);case d.WorkspaceTabType.EditTableData:return T(v);case d.WorkspaceTabType.ViewAllTable:return x(v);default:return(0,e.jsx)("div",{children:"Unknown"})}},N=(0,l.useMemo)(function(){return r==null?void 0:r.map(function(p){var v;return{prefixIcon:(v=d.workspaceTabConfig[p.type])===null||v===void 0?void 0:v.icon,label:p.title,key:p.id,editableName:p.type===d.WorkspaceTabType.CONSOLE,children:(0,e.jsx)(l.Fragment,{children:_(p)},p.id)}})},[r,a]);function C(){return(0,e.jsx)("div",{className:En.createButtonBox,children:(0,e.jsxs)(Oe.ZP,{className:En.createButton,type:"primary",onClick:function(){u()},children:[(0,e.jsx)(X.Z,{code:"\uE63A"}),(0,s.ZP)("common.button.createConsole")]})})}return N!=null&&N.length?(0,e.jsx)(Yr,{className:En.tabBox,onChange:m,onEdit:c,activeKey:a,editableNameOnBlur:f,items:N}):(0,e.jsx)("div",{className:En.ears,children:(0,e.jsx)(vu,{slot:C})})}),pu=_u,hu=(0,l.memo)(function(){var n=(0,l.useRef)(),a=Re(function(u){return{currentWorkspaceExtend:u.currentWorkspaceExtend,panelRight:u.layout.panelRight,panelRightWidth:u.layout.panelRightWidth}}),t=a.currentWorkspaceExtend,r=a.panelRight,o=a.panelRightWidth,i=(0,l.useCallback)(function(u){cl(u)},[]);return(0,e.jsxs)("div",{className:Sn.workspaceRight,children:[(0,e.jsxs)(vn,{onResize:i,showLine:!!t,min:200,className:Sn.draggableContainer,children:[(0,e.jsx)(pu,{}),(0,e.jsx)("div",{ref:n,className:Sn.workspaceExtendBody,style:{display:t&&r?"block":"none",width:"".concat(o||0,"px")},children:(0,e.jsx)(Ni,{})})]}),r&&(0,e.jsx)(Si,{className:Sn.workspaceExtendNav})]})}),bu=hu;function Nu(){var n=(0,jr.F)(),a=j()(n,1),t=a[0];(0,l.useEffect)(function(){var r=window._AppThemePack||{},o=r.colorPrimary,i=r.colorBgBase,u=r.colorTextBase,c={"editor.lineHighlightBackground":o+"14","editor.selectionBackground":o+"50","editorLineNumber.activeForeground":o,"editorRuler.foreground":o+"15","editor.foreground":u,"editor.background":i};we.editor.defineTheme(t.backgroundColor,{base:t.backgroundColor.includes(d.ThemeType.Dark)?"vs-dark":"vs",inherit:!0,rules:[{background:"#15161a"}],colors:c}),we.editor.setTheme(t.backgroundColor)},[t.backgroundColor])}var Su=Nu,jn={"f-icon-button":"f-icon-button___o1vIj","f-fill-absolute":"f-fill-absolute___jnQHQ","f-button":"f-button___sEQyI","f-doc-en-break":"f-doc-en-break___U2rmy",workspace:"workspace___x8lJj",workspaceMain:"workspaceMain___ZLmSa",loadingContent:"loadingContent___Pgx__",boxLeft:"boxLeft___K82Hp",boxRight:"boxRight___e766R",box_right_center:"box_right_center___yZlur",box_right_console:"box_right_console___niDKa",box_right_result:"box_right_result___BjgmX",select_database_box:"select_database_box___lD_Wc",current_database:"current_database___qlfKP",name:"name___i3EP7",other_operations:"other_operations___r7nbp",icon_box:"icon_box___dRyt3",cascade_popup:"cascade_popup___MEdAO",hiddenPanelLeft:"hiddenPanelLeft___OncN6","loading-animation":"loading-animation___u3e8f"},Tu=(0,l.memo)(function(){var n=(0,l.useRef)(),a=Re(function(i){return{panelLeft:i.layout.panelLeft,panelLeftWidth:i.layout.panelLeftWidth}}),t=a.panelLeft,r=a.panelLeftWidth;Su(),(0,l.useEffect)(function(){lu()},[]);var o=(0,l.useCallback)(function(i){ul(i)},[]);return(0,e.jsx)("div",{className:jn.workspace,children:(0,e.jsxs)(vn,{className:jn.workspaceMain,onResize:o,children:[(0,e.jsx)("div",{ref:n,style:{"--panel-left-width":"".concat(r,"px")},className:$()(W()({},jn.hiddenPanelLeft,!t),jn.boxLeft),children:(0,e.jsx)(ci,{})}),(0,e.jsx)(bu,{})]})})}),Eu=Tu,Cu=K(96695),gu=K.n(Cu),nm=K(94902),yt=function(n){return n.Pie="Pie",n.Column="Column",n.Line="Line",n}({}),xu=function(n){return n.DATASOURCE="DATASOURCE",n.TEAM="TEAM",n.USER="USER",n}({}),Sa=function(n){return n.USER_TEAM="USER_TEAM",n.USER_DATASOURCE="USER_DATASOURCE",n.TEAM_USER="TEAM_USER",n.TEAM_DATASOURCE="TEAM_DATASOURCE",n["DATASOURCE_USER/TEAM"]="DATASOURCE_USER/TEAM",n}({}),Ka=function(n){return n.DATASOURCE="DATASOURCE",n.TEAM="TEAM",n.USER="USER",n["USER/TEAM"]="USER/TEAM",n}({}),ht=function(n){return n.INVALID="INVALID",n.VALID="VALID",n}({}),vr=function(n){return n.ADMIN="ADMIN",n.USER="USER",n}({}),rm=function(n){return n.TEAM="TEAM",n.USER="USER",n}({}),Fe={container:"container___FL6zG",titleBar:"titleBar___QdGXT",edit:"edit___wvbek",left_overlay_add:"left_overlay_add___d_N_g",right_overlay_add:"right_overlay_add___FmDV8",top_overlay_add:"top_overlay_add___PJJfJ",bottom_overlay_add:"bottom_overlay_add___lhLkl",add_chart_icon:"add_chart_icon___Oa8I5",add_chart_icon_y:"add_chart_icon_y___k6YZm",add_chart_plus_icon:"add_chart_plus_icon___dMwWd",emptyChartBlock:"emptyChartBlock___UuLOK",emptyDataImage:"emptyDataImage___HcRfJ",emptyDataText:"emptyDataText___bOFTU",editBlock:"editBlock___eF0ww",editorBlock:"editorBlock___zOzcd",editor:"editor___hyfMu",dataSourceSelect:"dataSourceSelect___K5Mtl",chartParamsForm:"chartParamsForm___wmekN",chartParamsFormTitle:"chartParamsFormTitle___OPenV",editorOptionBlock:"editorOptionBlock___gUl1K"},Iu=Object.defineProperty,Bo=Object.getOwnPropertySymbols,yu=Object.prototype.hasOwnProperty,Du=Object.prototype.propertyIsEnumerable,Uo=(n,a,t)=>a in n?Iu(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,Lu=(n,a)=>{for(var t in a||(a={}))yu.call(a,t)&&Uo(n,t,a[t]);if(Bo)for(var t of Bo(a))Du.call(a,t)&&Uo(n,t,a[t]);return n};const om=n=>React.createElement("svg",Lu({width:16,height:16,xmlns:"http://www.w3.org/2000/svg"},n),React.createElement("title",null,"\u7F16\u7EC4"),React.createElement("g",{fill:"none",fillRule:"evenodd"},React.createElement("path",{d:"M0 0h16v16H0z"}),React.createElement("g",{fillRule:"nonzero"},React.createElement("path",{d:"M8 15.074c-3.867 0-7-3.15-7-7.037S4.133 1 8 1c3.866 0 7 3.15 7 7.037s-3.133 7.037-7 7.037Z",fill:"#597EF7"}),React.createElement("path",{d:"M11.222 8.447H8.475l-.012 3.144c0 .117.025.616-.514.616-.513 0-.461-.33-.461-.578V8.448H4.472c-.197 0-.431.001-.431-.601 0-.448.548-.397.548-.397h2.9V4.416c0-.199.154-.375.493-.355.34.02.493.157.493.355V7.45h2.747s.626-.082.62.475c-.007.558-.493.522-.62.522Z",fill:"#FFF"}))));var kn="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMCAwaDE2djE2SDB6Ii8+PGcgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOCAxNS4wNzRjLTMuODY3IDAtNy0zLjE1LTctNy4wMzdTNC4xMzMgMSA4IDFjMy44NjYgMCA3IDMuMTUgNyA3LjAzN3MtMy4xMzMgNy4wMzctNyA3LjAzN1oiIGZpbGw9IiM1OTdFRjciLz48cGF0aCBkPSJNMTEuMjIyIDguNDQ3SDguNDc1bC0uMDEyIDMuMTQ0YzAgLjExNy4wMjUuNjE2LS41MTQuNjE2LS41MTMgMC0uNDYxLS4zMy0uNDYxLS41NzhWOC40NDhINC40NzJjLS4xOTcgMC0uNDMxLjAwMS0uNDMxLS42MDEgMC0uNDQ4LjU0OC0uMzk3LjU0OC0uMzk3aDIuOVY0LjQxNmMwLS4xOTkuMTU0LS4zNzUuNDkzLS4zNTUuMzQuMDIuNDkzLjE1Ny40OTMuMzU1VjcuNDVoMi43NDdzLjYyNi0uMDgyLjYyLjQ3NWMtLjAwNy41NTgtLjQ5My41MjItLjYyLjUyMloiIGZpbGw9IiNGRkYiLz48L2c+PC9nPjwvc3ZnPg==",_r=K(84031),Ru=function(a,t){var r=(0,l.useRef)(null),o=(0,l.useMemo)(function(){var i,u,c,m;return{xAxis:{type:"category",data:(i=a==null||(u=a.data)===null||u===void 0?void 0:u.xAxis)!==null&&i!==void 0?i:[]},yAxis:{type:"value"},series:[{data:(c=a==null||(m=a.data)===null||m===void 0?void 0:m.yAxis)!==null&&c!==void 0?c:[],type:"line"}],tooltip:{trigger:"axis"}}},[a.data]);return(0,l.useImperativeHandle)(t,function(){return{getEchartsInstance:function(){return r.current.getEchartsInstance()}}}),(0,e.jsx)(_r.Z,{ref:r,option:o,opts:{renderer:"svg"}})},Pu=(0,l.forwardRef)(Ru),Au=function(a,t){var r=(0,l.useRef)(null),o=(0,l.useMemo)(function(){return{tooltip:{trigger:"item"},legend:{orient:"horizontal",align:"auto",type:"scroll"},series:[{type:"pie",radius:["40%","70%"],data:a.data,emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}}}]}},[a.data]);return(0,l.useImperativeHandle)(t,function(){return{getEchartsInstance:function(){return r.current.getEchartsInstance()}}}),(0,e.jsx)(_r.Z,{ref:r,option:o,opts:{renderer:"svg"}})},Ou=(0,l.forwardRef)(Au),ju=function(a,t){var r=(0,l.useRef)(null),o=(0,l.useMemo)(function(){var i,u,c,m;return{xAxis:{type:"category",data:(i=a==null||(u=a.data)===null||u===void 0?void 0:u.xAxis)!==null&&i!==void 0?i:[]},yAxis:{type:"value"},series:[{data:(c=a==null||(m=a.data)===null||m===void 0?void 0:m.yAxis)!==null&&c!==void 0?c:[],type:"bar"}]}},[a.data]);return(0,l.useImperativeHandle)(t,function(){return{getEchartsInstance:function(){return r.current.getEchartsInstance()}}}),(0,e.jsx)(_r.Z,{ref:r,option:o,opts:{renderer:"svg"}})},ku=(0,l.forwardRef)(ju),wu=K(37446),Mu=(0,ae.Z)("/api/dashboard/list",{method:"get"}),Fo=(0,ae.Z)("/api/dashboard/:id",{method:"get"}),Zu=(0,ae.Z)("/api/dashboard/create",{method:"post"}),wn=(0,ae.Z)("/api/dashboard/update",{method:"post"}),Bu=(0,ae.Z)("/api/dashboard/:id",{method:"delete"}),Uu=(0,ae.Z)("/api/chart/:id",{method:"get"}),Vo=(0,ae.Z)("/api/chart/create",{method:"post"}),Fu=(0,ae.Z)("/api/chart/update",{method:"post"}),Vu=(0,ae.Z)("/api/chart/:id",{method:"delete"}),Wu=function(a){var t=a.headerList,r=a.dataList,o=t==null?void 0:t.reduce(function(i,u,c){return i[u.name]=h()(h()({},u),{},{data:r==null?void 0:r.map(function(m){return m[c]})}),i},{});return o};function Hu(n){var a=new Map;n.forEach(function(m){a.has(m)?a.set(m,a.get(m)+1):a.set(m,1)});var t=[],r=gu()(a.entries()),o;try{for(r.s();!(o=r.n()).done;){var i=j()(o.value,2),u=i[0],c=i[1];t.push({name:u,value:c})}}catch(m){r.e(m)}finally{r.f()}return t}function Gu(n){var a,t=n.connectionList,r=n.id,o=(0,l.useState)([]),i=j()(o,2),u=i[0],c=i[1],m=(0,l.useState)(),f=j()(m,2),b=f[0],E=f[1],O=(0,l.useState)({}),T=j()(O,2),x=T[0],_=T[1],N=(0,l.useState)(),C=j()(N,2),p=C[0],v=C[1],k=(0,l.useState)([]),D=j()(k,2),S=D[1],M=(0,l.useState)((a=n.isEditing)!==null&&a!==void 0?a:!1),I=j()(M,2),L=I[0],P=I[1],w=(0,l.useState)(!1),Z=j()(w,2),B=Z[0],R=Z[1],g=(0,l.useState)(""),A=j()(g,2),V=A[0],U=A[1],Q=re.Z.useForm(),G=j()(Q,1),z=G[0],y=(0,l.useRef)();(0,l.useEffect)(function(){r!==void 0&&Y()},[r]),(0,l.useEffect)(function(){t&&t.length>0&&(E(t[0]),c((t||[]).map(function(Ee){return{value:Ee.id,label:Ee.alias,isLeaf:!1}})))},[t]),(0,l.useEffect)(function(){b&&(_(h()(h()({},x),{},{dataSourceId:b.id,type:b.type})),F(b.id))},[b]),(0,l.useEffect)(function(){Me()},[x.sqlData]);var F=function(){var Ee=he()(ee()().mark(function je(be){var De,ge;return ee()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return fe.next=2,ye.Z.getDatabaseSchemaList({dataSourceId:be});case 2:if(De=fe.sent,ge=(u||[]).find(function(ta){return ta.value===be}),ge){fe.next=6;break}return fe.abrupt("return");case 6:ge.children=Kl(De),c(_e()(u));case 8:case"end":return fe.stop()}},je)}));return function(be){return Ee.apply(this,arguments)}}(),q=function(){var Ee=he()(ee()().mark(function je(be,De){var ge,Ke,fe,ta,_a,rt;return ee()().wrap(function(na){for(;;)switch(na.prev=na.next){case 0:if(ge=De.dataSourceId,Ke=De.databaseName,fe=De.schemaName,Cn(ge)){na.next=4;break}return Ge.ZP.success((0,s.ZP)("dashboard.editor.execute.noDataSource")),na.abrupt("return");case 4:return R(!0),na.prev=5,ta={sql:be,dataSourceId:ge,databaseName:Ke,schemaName:fe},na.next=9,ye.Z.executeSql(ta);case 9:_a=na.sent,_a&&_a[0]&&(rt=Wu(_a[0])),_(h()(h()({},De),{},{ddl:be,sqlData:rt})),Ge.ZP.success((0,s.ZP)("dashboard.editor.execute.success"));case 13:return na.prev=13,R(!1),na.finish(13);case 16:case"end":return na.stop()}},je,null,[[5,,13,16]])}));return function(be,De){return Ee.apply(this,arguments)}}(),Y=function(){var Ee=he()(ee()().mark(function je(){var be,De,ge,Ke;return ee()().wrap(function(ta){for(;;)switch(ta.prev=ta.next){case 0:return R(!0),ta.next=3,Uu({id:n.id});case 3:be=ta.sent,be.dataSourceId||(be.connectable=void 0),_(be),De=["dataSourceId","databaseName","schemaName"],ge=De.map(function(_a){return be[_a]}).filter(function(_a){return!!_a}),S(ge),Ke=JSON.parse(be.schema||"{}"),z.setFieldsValue(Ke),be.ddl&&be.connectable&&(U(be.ddl),q(be.ddl,be)),R(!1);case 13:case"end":return ta.stop()}},je)}));return function(){return Ee.apply(this,arguments)}}(),J=function(){var je=y.current.getEchartsInstance(),be=new Image;be.src=je.getDataURL({type:"png",devicePixelRatio:4,backgroundColor:"#FFF"}),be.onload=function(){var De=document.createElement("canvas");De.width=be.width,De.height=be.height;var ge=De.getContext("2d");ge==null||ge.drawImage(be,0,0);var Ke=De.toDataURL("image/png"),fe=document.createElement("a"),ta=new MouseEvent("click");fe.download="image.png",fe.href=Ke,fe.dispatchEvent(ta)}},de=function(){Vu({id:n.id}),n.onDelete&&n.onDelete(n.id)},se=function(){var Ee=he()(ee()().mark(function je(){var be;return ee()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return be=h()(h()({id:n.id},x),{},{schema:JSON.stringify(z.getFieldsValue(!0))}),ge.next=3,Fu(be);case 3:P(!1),Ge.ZP.success((0,s.ZP)("common.tips.saveSuccessfully"));case 5:case"end":return ge.stop()}},je)}));return function(){return Ee.apply(this,arguments)}}(),Me=function(){var je=x||{},be=je.sqlData,De=be===void 0?{}:be,ge=z.getFieldsValue(!0),Ke=ge.chartType,fe=ge.xAxis,ta=ge.yAxis;if(Ke===yt.Pie){var _a=De[fe],rt=_a||{},Nt=rt.data,na=Nt===void 0?[]:Nt,Dt=Hu(na);v(Dt)}else if(Ke===yt.Line){var ot,lt,Ht=(ot=De[fe])===null||ot===void 0?void 0:ot.data,on=(lt=De[ta])===null||lt===void 0?void 0:lt.data;v({xAxis:Ht,yAxis:on})}else if(Ke===yt.Column){var Ya,Qa,ln=(Ya=De[fe])===null||Ya===void 0?void 0:Ya.data,ke=(Qa=De[ta])===null||Qa===void 0?void 0:Qa.data;v({xAxis:ln,yAxis:ke})}},oe=function(){return(0,e.jsxs)(e.Fragment,{children:[n.canAddRowItem&&(0,e.jsx)("div",{onClick:n.addChartLeft,className:Fe.left_overlay_add,children:(0,e.jsx)("div",{className:Fe.add_chart_icon,children:(0,e.jsx)("img",{className:Fe.add_chart_plus_icon,src:kn,alt:"Add chart"})})}),n.canAddRowItem&&(0,e.jsx)("div",{onClick:n.addChartRight,className:Fe.right_overlay_add,children:(0,e.jsx)("div",{className:Fe.add_chart_icon,children:(0,e.jsx)("img",{className:Fe.add_chart_plus_icon,src:kn,alt:"Add chart"})})}),(0,e.jsx)("div",{onClick:n.addChartTop,className:Fe.top_overlay_add,children:(0,e.jsx)("div",{className:$()(Fe.add_chart_icon,Fe.add_chart_icon_y),children:(0,e.jsx)("img",{className:Fe.add_chart_plus_icon,src:kn,alt:"Add chart"})})}),(0,e.jsx)("div",{onClick:n.addChartBottom,className:Fe.bottom_overlay_add,children:(0,e.jsx)("div",{className:$()(Fe.add_chart_icon,Fe.add_chart_icon_y),children:(0,e.jsx)("img",{className:Fe.add_chart_plus_icon,src:kn,alt:"Add chart"})})})]})},ue=function(){var je=z.getFieldsValue(!0),be=je.chartType;switch(be){case yt.Pie:return(0,e.jsx)(Ou,{ref:y,data:p});case yt.Line:return(0,e.jsx)(Pu,{ref:y,data:p});case yt.Column:return(0,e.jsx)(ku,{ref:y,data:p});default:return(0,e.jsx)("div",{style:{height:"120px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,e.jsx)(X.Z,{code:"\uE638",className:Fe.emptyDataImage})})}},Te=function(){return(0,e.jsxs)("div",{className:Fe.emptyChartBlock,children:[(0,e.jsx)(X.Z,{code:"\uE638",className:Fe.emptyDataImage}),(0,e.jsx)("div",{className:Fe.emptyDataText,children:"No date selected"}),(0,e.jsx)(Oe.ZP,{type:"primary",onClick:function(){P(!0)},children:"Add Data"})]})},He=(0,l.useMemo)(function(){return{text:V,range:"front"}},[V]),Pe=function(je){_(h()(h()({},x),je))},Ze=function(){var je=x||{},be=je.sqlData,De=be===void 0?{}:be,ge=Object.keys(De).map(function(Ke){return{label:Ke,value:Ke}});return(0,e.jsxs)("div",{className:Fe.editBlock,children:[(0,e.jsxs)("div",{className:Fe.editorBlock,children:[(0,e.jsx)("div",{className:Fe.editor,children:(0,e.jsx)(Zo,{defaultValue:He.text,boundInfo:x,setBoundInfo:Pe,hasAiChat:!0,hasAi2Lang:!1,hasSaveBtn:!1,value:x==null?void 0:x.ddl,onExecuteSQL:function(fe){return q(fe,x)},editorOptions:{lineNumbers:"off"},isActive:!0})}),(0,e.jsxs)("div",{className:Fe.chartParamsForm,children:[(0,e.jsx)("div",{className:Fe.chartParamsFormTitle,children:"Charts:"}),(0,e.jsxs)(re.Z,{form:z,layout:"vertical",autoComplete:"off",onValuesChange:Me,style:{width:"100%"},children:[(0,e.jsx)(re.Z.Item,{label:"Chart Type",name:"chartType",children:(0,e.jsx)(aa.Z,{options:[{label:"Line",value:"Line"},{label:"Pie",value:"Pie"},{label:"Column",value:"Column"}]})}),(0,e.jsx)(re.Z.Item,{label:"xAxis",name:"xAxis",children:(0,e.jsx)(aa.Z,{options:ge})}),(0,e.jsx)(re.Z.Item,{label:"yAxis",name:"yAxis",hidden:z.getFieldValue("chartType")===yt.Pie,children:(0,e.jsx)(aa.Z,{options:ge})})]})]})]}),(0,e.jsxs)("div",{className:Fe.editorOptionBlock,children:[(0,e.jsx)(Oe.ZP,{type:"primary",style:{marginRight:"8px"},onClick:se,children:(0,s.ZP)("common.button.confirm")}),(0,e.jsx)(Oe.ZP,{onClick:function(){P(!1)},children:(0,s.ZP)("common.button.cancel")})]})]})};return(0,e.jsx)(mt.Z,{spinning:B,children:(0,e.jsxs)("div",{className:Fe.container,children:[oe(),(0,e.jsxs)("div",{className:Fe.titleBar,children:[(0,e.jsx)("div",{className:Fe.title,children:x==null?void 0:x.name}),(0,e.jsx)("div",{children:(0,e.jsx)(Ae.Z,{menu:{items:[{key:"Edit",label:(0,s.ZP)("dashboard.edit"),onClick:function(){P(!0)}},{key:"Export",label:(0,s.ZP)("dashboard.export2image"),onClick:J},{key:"delete",label:(0,s.ZP)("dashboard.delete"),onClick:de}]},placement:"bottomLeft",children:(0,e.jsx)(wu.Z,{className:Fe.edit})})})]}),x!=null&&x.sqlData||L?ue():Te(),L&&Ze()]})})}var qu=Gu,Ia={"f-icon-button":"f-icon-button___ES23U","f-fill-absolute":"f-fill-absolute___w79lC","f-button":"f-button___Iqe2h","f-doc-en-break":"f-doc-en-break___FcGqc",box:"box___GiSye",dragBox:"dragBox___EYNBO",boxLeft:"boxLeft___TKo8n",createDashboardBtn:"createDashboardBtn___wUGne",boxLeftTitle:"boxLeftTitle___j9vz_",plusIcon:"plusIcon___j6dEr",boxLeftItem:"boxLeftItem___bIMG0",itemTitle:"itemTitle___AB21g",moreButton:"moreButton___H5JE8",activeItem:"activeItem___EUj5f",boxRight:"boxRight___LYRFL",boxRightTitle:"boxRightTitle___YF7sG",boxRightContentRow:"boxRightContentRow___d3TeX",boxRightContentColumn:"boxRightContentColumn___OYt4m","loading-animation":"loading-animation___eQB0J"},lm={name:"",description:"",schema:'{"chatType":"","xAxis":"","yAxis":""}'};function Ku(n){var a=n.className,t=(0,l.useState)([]),r=j()(t,2),o=r[0],i=r[1],u=(0,l.useState)(),c=j()(u,2),m=c[0],f=c[1],b=(0,l.useState)(!1),E=j()(b,2),O=E[0],T=E[1],x=Ga(function(R){return R.connectionList}),_=(0,Ut.VF)(function(R){return R.remainingUse}),N=re.Z.useForm(),C=j()(N,1),p=C[0],v=Ge.ZP.useMessage(),k=j()(v,1),D=k[0],S=(0,l.useRef)();(0,l.useEffect)(function(){M()},[]),(0,l.useEffect)(function(){var R=m||{},g=R.chartIds;m&&(!g||!g.length)&&I(m)},[m]);var M=function(){var R=he()(ee()().mark(function g(){var A,V,U;return ee()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,Mu({});case 2:if(A=G.sent,V=A.data,!(Array.isArray(V)&&V.length>0)){G.next=10;break}return i(V),G.next=8,Fo({id:V[0].id});case 8:U=G.sent,f(U);case 10:case"end":return G.stop()}},g)}));return function(){return R.apply(this,arguments)}}(),I=function(){var R=he()(ee()().mark(function g(A){var V,U;return ee()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(A){G.next=2;break}return G.abrupt("return");case 2:return G.next=4,Vo({});case 4:V=G.sent,U=h()(h()({},A),{},{schema:JSON.stringify([[V]]),chartIds:[V]}),wn(U),f(U);case 8:case"end":return G.stop()}},g)}));return function(A){return R.apply(this,arguments)}}(),L=function(){var R=he()(ee()().mark(function g(A){var V,U;return ee()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(V=A.id,(m==null?void 0:m.id)!==V){G.next=3;break}return G.abrupt("return");case 3:return G.next=5,Fo({id:V});case 5:U=G.sent,f(U);case 7:case"end":return G.stop()}},g)}));return function(A){return R.apply(this,arguments)}}(),P=function(){return(o||[]).map(function(g,A){var V;return(0,e.jsxs)("div",{className:$()((V={},W()(V,Ia.boxLeftItem,!0),W()(V,Ia.activeItem,(m==null?void 0:m.id)===g.id),V)),onClick:function(){return L(g)},children:[(0,e.jsxs)("div",{className:Ia.itemTitle,children:[(0,e.jsx)(X.Z,{code:"\uE60D",style:{marginRight:"8px"}}),g.name]}),(0,e.jsx)(Ae.Z,{menu:{items:[{key:"Edit",label:(0,s.ZP)("dashboard.edit"),onClick:function(){var Q=g.id,G=g.name,z=g.description;T(!0),p.setFieldsValue({id:Q,name:G,description:z})}},{key:"Delete",label:(0,s.ZP)("dashboard.delete"),onClick:function(){var U=he()(ee()().mark(function G(){var z;return ee()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return z=g.id,F.next=3,Bu({id:z});case 3:D.open({type:"success",content:"delete dashboard success."}),M();case 5:case"end":return F.stop()}},G)}));function Q(){return U.apply(this,arguments)}return Q}()}]},children:(0,e.jsx)("div",{className:Ia.moreButton,children:(0,e.jsx)(X.Z,{code:"\uE601"})})})]},A)})},w=function(){var R=he()(ee()().mark(function g(A,V,U){var Q,G,z,y,F,q,Y,J;return ee()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return Q=m||{},G=Q.id,z=Q.schema,y=Q.chartIds,F=y===void 0?[]:y,q=JSON.parse(z||"")||[[]],se.next=4,Vo({});case 4:Y=se.sent,se.t0=A,se.next=se.t0==="top"?8:se.t0==="bottom"?10:se.t0==="left"?12:se.t0==="right"?14:16;break;case 8:return q.splice(V,0,[Y]),se.abrupt("break",17);case 10:return q.splice(V+1,0,[Y]),se.abrupt("break",17);case 12:return q[V].splice(U,0,Y),se.abrupt("break",17);case 14:return q[V].splice(U+1,0,Y),se.abrupt("break",17);case 16:return se.abrupt("break",17);case 17:return J=h()(h()({},m),{},{id:G,schema:JSON.stringify(q),chartIds:[].concat(_e()(F),[Y])}),se.next=20,wn(J);case 20:f(J);case 21:case"end":return se.stop()}},g)}));return function(A,V,U){return R.apply(this,arguments)}}(),Z=function(){var R=he()(ee()().mark(function g(A,V,U){var Q,G,z,y,F,q;return ee()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return Q=m||{},G=Q.id,z=Q.schema,y=Q.chartIds,F=JSON.parse(z||"")||[[]],F[V].length===1?F.splice(V,1):F[V].splice(U,1),q=h()(h()({id:G},m),{},{schema:JSON.stringify(F),chartIds:y==null?void 0:y.filter(function(de){return de!==A})}),J.next=6,wn(q);case 6:f(q);case 7:case"end":return J.stop()}},g)}));return function(A,V,U){return R.apply(this,arguments)}}(),B=function(){var g=m||{},A=g.schema,V=g.name;if(A){var U=JSON.parse(A);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:Ia.boxRightTitle,children:[(0,e.jsx)(X.Z,{code:"\uE60D"}),(0,e.jsx)("div",{style:{marginLeft:"8px"},children:V})]}),(0,e.jsx)("div",{className:Ia.BoxRightContent,children:U.map(function(Q,G){return(0,e.jsx)("div",{className:Ia.boxRightContentRow,children:Q.map(function(z,y){return(0,e.jsx)("div",{className:Ia.boxRightContentColumn,style:{width:"".concat(100/Q.length,"%")},children:(0,e.jsx)(qu,{id:z,canAddRowItem:Q.length<3,addChartTop:function(){return w("top",G,y)},addChartBottom:function(){return w("bottom",G,y)},addChartLeft:function(){return w("left",G,y)},addChartRight:function(){return w("right",G,y)},onDelete:function(q){return Z(q,G,y)},connectionList:x||[],remainingUse:_},z)},y)})},G)})})]})}};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(vn,{className:$()(Ia.box,a),children:[(0,e.jsx)("div",{ref:S,className:Ia.dragBox,children:(0,e.jsxs)("div",{className:Ia.boxLeft,children:[(0,e.jsxs)("div",{className:Ia.boxLeftTitle,children:[(0,e.jsx)("div",{children:(0,s.ZP)("dashboard.title")}),(0,e.jsx)(X.Z,{code:"\uE631",className:Ia.plusIcon,onClick:function(){return T(!0)}})]}),P()]})}),(0,e.jsx)("div",{className:Ia.boxRight,children:B()})]}),(0,e.jsx)(Aa.Z,{title:p.getFieldValue("id")?(0,s.ZP)("dashboard.modal.editTitle"):(0,s.ZP)("dashboard.modal.addTitle"),open:O,onOk:he()(ee()().mark(function R(){var g,A;return ee()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.prev=0,U.next=3,p.validateFields();case 3:if(g=p.getFieldsValue(!0),A=g.id,!A){U.next=10;break}return U.next=8,wn(g);case 8:U.next=12;break;case 10:return U.next=12,Zu(g);case 12:M(),T(!1),p.resetFields(),U.next=20;break;case 17:U.prev=17,U.t0=U.catch(0),p.resetFields();case 20:case"end":return U.stop()}},R,null,[[0,17]])})),onCancel:function(){T(!1),p.resetFields()},okText:(0,s.ZP)("common.button.confirm"),cancelText:(0,s.ZP)("common.button.cancel"),children:(0,e.jsxs)(re.Z,{labelCol:{span:4},wrapperCol:{span:20},form:p,autoComplete:"off",children:[(0,e.jsx)(re.Z.Item,{label:"name",name:"name",rules:[{required:!0,message:(0,s.ZP)("dashboard.modal.name.placeholder")}],children:(0,e.jsx)(xe.Z,{})}),(0,e.jsx)(re.Z.Item,{label:"description",name:"description",children:(0,e.jsx)(xe.Z.TextArea,{})})]})})]})}var zu=Ku,va={"f-icon-button":"f-icon-button___QBL14","f-fill-absolute":"f-fill-absolute___qRWXm","f-button":"f-button___s1p96","f-doc-en-break":"f-doc-en-break___ej6Mn",box:"box___UBr9K",dataBaseListBox:"dataBaseListBox___oMcEj",dataBaseList:"dataBaseList___eZQz7",databaseItem:"databaseItem___rvCpN",databaseItemMain:"databaseItemMain___x8cOz",databaseItemLeft:"databaseItemLeft___azhVQ",databaseItemRight:"databaseItemRight___zotYQ",logoBox:"logoBox___4NWQA",databaseItemSpacer:"databaseItemSpacer___I1mMe",createConnections:"createConnections___FTrJW",showCreateConnections:"showCreateConnections____eeOa",notPermission:"notPermission___S4xBC",notPermissionIconTips:"notPermissionIconTips___lnuQQ",notPermissionIconBox:"notPermissionIconBox___DX_hE",connectButtonBox:"connectButtonBox___w_e24",notPermissionIcon:"notPermissionIcon___o9HrD",connectButton:"connectButton___S6t6L","loading-animation":"loading-animation___korc5"},sa={"f-icon-button":"f-icon-button___F7hBx","f-fill-absolute":"f-fill-absolute___P_e8v","f-button":"f-button___Adw9a","f-doc-en-break":"f-doc-en-break___rgIIE",connectionBox:"connectionBox___ccXUy",title:"title___hBEDv",form:"form___smIuS",extendInfoBox:"extendInfoBox___G0mln",labelTextAlign:"labelTextAlign___EjA19",formFooter:"formFooter___z7bjx",cancel:"cancel___BmW6Z",rightButton:"rightButton___j4cWB",test:"test___eq0OM",save:"save___KbYCH",tabsBox:"tabsBox___DI1F6",testSSHConnect:"testSSHConnect___B6Urc",testSSHConnectText:"testSSHConnectText___KZfj8",extendTable:"extendTable___nzIgV",optionItem:"optionItem___ldgOA",envTag:"envTag___cyr14","loading-animation":"loading-animation___EuNpf"},Yu=K(47221),wa={"f-icon-button":"f-icon-button___Ia4rI","f-fill-absolute":"f-fill-absolute___SAhRX","f-button":"f-button___QqdqI","f-doc-en-break":"f-doc-en-break___Q6QqU",box:"box___apd6i",downloadDriveFooter:"downloadDriveFooter___AU4pE",downloadDrive:"downloadDrive___LWfAS",downloadText:"downloadText___GPKr4",downloadTextDownload:"downloadTextDownload___pFc2P",downloadTextError:"downloadTextError___k4QHI",downloadTextLoading:"downloadTextLoading___zdBiK",text:"text___elacy",downloadTextSuccess:"downloadTextSuccess___rzBu0",uploadCustomDrive:"uploadCustomDrive___NbQ2y","loading-animation":"loading-animation___fzd6M"},Qu={"f-icon-button":"f-icon-button___gGWru","f-fill-absolute":"f-fill-absolute___zMT09","f-button":"f-button___PzCjq","f-doc-en-break":"f-doc-en-break___io7pE","loading-animation":"loading-animation___ZeUWP"},Wo=K(80969),$u=(0,l.memo)(function(a){var t=a.className,r=a.databaseType,o=r===void 0?d.DatabaseTypeCode.MYSQL:r,i=a.formChange,u=a.jdbcDriverClass,c=(0,l.useState)({dbType:o,jdbcDriverClass:u,jdbcDriver:[]}),m=j()(c,2),f=m[0],b=m[1],E={name:"multipartFiles",action:"".concat(window._BaseURL,"/api/jdbc/driver/upload"),multiple:!0,onChange:function(x){var _;if(x.file.percent===100&&(_=x.file)!==null&&_!==void 0&&(_=_.response)!==null&&_!==void 0&&(_=_.data)!==null&&_!==void 0&&_[0]){var N;b(h()(h()({},f),{},{jdbcDriver:[].concat(_e()(f.jdbcDriver),[(N=x.file)===null||N===void 0||(N=N.response)===null||N===void 0||(N=N.data)===null||N===void 0?void 0:N[0]])}))}},accept:"application/java-archive"};(0,l.useEffect)(function(){i(f)},[f]);function O(T){b(h()(h()({},f),{},{jdbcDriverClass:T.target.value}))}return(0,e.jsx)("div",{className:$()(Qu.box,t),children:(0,e.jsx)("div",{children:(0,e.jsxs)(re.Z,{labelCol:{span:3},wrapperCol:{span:16},children:[(0,e.jsx)(re.Z.Item,{label:"Class",children:(0,e.jsx)(xe.Z,{value:f.jdbcDriverClass,onChange:O})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("connection.title.uploadDriver"),children:(0,e.jsx)(Wo.Z,h()(h()({},E),{},{children:(0,e.jsx)(Oe.ZP,{children:(0,s.ZP)("connection.button.clickUpload")})}))})]})})})}),Ju=aa.Z.Option,za=function(n){return n[n.Default=0]="Default",n[n.Loading=1]="Loading",n[n.Error=2]="Error",n[n.Success=3]="Success",n}(za||{}),Xu=(0,l.memo)(function(n){var a,t,r,o=n.className,i=n.backfillData,u=n.onChange,c=(0,l.useState)(za.Default),m=j()(c,2),f=m[0],b=m[1],E=re.Z.useForm(),O=j()(E,1),T=O[0],x=(0,l.useState)(),_=j()(x,2),N=_[0],C=_[1],p=(0,l.useState)(!1),v=j()(p,2),k=v[0],D=v[1],S=(0,l.useState)({}),M=j()(S,2),I=M[0],L=M[1];(0,l.useEffect)(function(){i&&P()},[i==null?void 0:i.type]),(0,l.useEffect)(function(){if(i){var g,A,V={jdbcDriverClass:i==null||(g=i.driverConfig)===null||g===void 0?void 0:g.jdbcDriverClass,jdbcDriver:i==null||(A=i.driverConfig)===null||A===void 0?void 0:A.jdbcDriver};T.setFieldsValue(V),u(V)}},[i==null?void 0:i.driverConfig,i==null?void 0:i.id]);function P(){ra.getDriverList({dbType:i.type}).then(function(g){var A,V;if(g&&(C(h()(h()({},g),{},{driverConfigList:g.driverConfigList||[]})),(A=g.driverConfigList)!==null&&A!==void 0&&A.length&&!(i!=null&&(V=i.driverConfig)!==null&&V!==void 0&&V.jdbcDriver))){var U,Q,G={jdbcDriverClass:(U=g.driverConfigList[0])===null||U===void 0?void 0:U.jdbcDriverClass,jdbcDriver:(Q=g.driverConfigList[0])===null||Q===void 0?void 0:Q.jdbcDriver};T.setFieldsValue(G),u(G)}})}function w(g){L(g)}function Z(){ra.saveDriver(I).then(function(){D(!1),P()})}function B(){b(za.Loading),ra.downloadDriver({dbType:i.type}).then(function(){b(za.Success),P()}).catch(function(){b(za.Error)})}function R(g){var A=N==null?void 0:N.driverConfigList.find(function(V){return V.jdbcDriver===g.jdbcDriver});T.setFieldsValue({jdbcDriverClass:A==null?void 0:A.jdbcDriverClass}),u({jdbcDriverClass:A==null?void 0:A.jdbcDriverClass,jdbcDriver:g.jdbcDriver})}return(0,e.jsxs)("div",{className:$()(wa.box,o),children:[(0,e.jsxs)(re.Z,{form:T,onValuesChange:R,colon:!1,children:[(0,e.jsx)(re.Z.Item,{labelAlign:"left",name:"jdbcDriver",label:(0,s.ag)("connection.title.driver"),children:(0,e.jsx)(aa.Z,{children:N==null||(a=N.driverConfigList)===null||a===void 0?void 0:a.map(function(g){return(0,e.jsx)(Ju,{value:g.jdbcDriver,children:g.jdbcDriver},g.jdbcDriver)})})}),(0,e.jsx)(re.Z.Item,{labelAlign:"left",name:"jdbcDriverClass",label:"Class",children:(0,e.jsx)(xe.Z,{disabled:!0})})]}),(0,e.jsxs)("div",{className:wa.downloadDriveFooter,children:[N!=null&&N.driverConfigList&&!(N!=null&&(t=N.driverConfigList)!==null&&t!==void 0&&t.length)||f===za.Success?(0,e.jsxs)("div",{onClick:B,className:wa.downloadDrive,children:[f===za.Default&&(0,e.jsx)("div",{className:$()(wa.downloadText,wa.downloadTextDownload),children:(0,s.ag)("connection.text.downloadDriver")}),f===za.Loading&&(0,e.jsxs)("div",{className:$()(wa.downloadText,wa.downloadTextLoading),children:[(0,e.jsx)(or,{}),(0,e.jsx)("div",{className:wa.text,children:(0,s.ag)("connection.text.downloading")})]}),f===za.Error&&(0,e.jsx)("div",{className:$()(wa.downloadText,wa.downloadTextError),children:(0,s.ag)("connection.text.tryAgainDownload")}),f===za.Success&&(0,e.jsx)("div",{className:$()(wa.downloadText,wa.downloadTextSuccess),children:(0,s.ag)("connection.text.downloadSuccess")})]}):(0,e.jsx)("div",{}),i.isAdmin!==!1&&(0,e.jsx)("div",{className:wa.uploadCustomDrive,onClick:function(){D(!0)},children:(0,s.ag)("connection.tips.customUpload")})]}),(0,e.jsx)(Aa.Z,{destroyOnClose:!0,title:(0,s.ag)("connection.title.uploadDriver"),open:k,onOk:function(){Z()},onCancel:function(){D(!1)},children:(0,e.jsx)($u,{jdbcDriverClass:N==null||(r=N.defaultDriverConfig)===null||r===void 0?void 0:r.jdbcDriverClass,formChange:w,databaseType:i.type})})]})}),ec=aa.Z.Option,nt=function(n){return n.UPDATE="update",n.SAVE="save",n.TEST="test",n}({}),ac=(0,l.forwardRef)(function(n,a){var t,r,o=n.closeCreateConnection,i=n.connectionData,u=n.submit,c=re.Z.useForm(),m=j()(c,1),f=m[0],b=re.Z.useForm(),E=j()(b,1),O=E[0],T=(0,l.useState)({}),x=j()(T,2),_=x[0],N=x[1],C=(0,l.useState)(i),p=j()(C,2),v=p[0],k=p[1],D=(0,l.useState)({confirmButton:!1,testButton:!1,sshTestLoading:!1}),S=j()(D,2),M=S[0],I=S[1],L=Ga(function(y){return{connectionEnvList:y.connectionEnvList}}),P=L.connectionEnvList,w=(0,l.useState)([]),Z=j()(w,2),B=Z[0],R=Z[1];(0,l.useEffect)(function(){var y=P==null?void 0:P.map(function(F){return{value:F.id,label:F.name,color:F.color}});y&&R(y)},[P]);var g=(0,l.useMemo)(function(){var y=(0,fa.I8)(pn),F=y.find(function(q){return q.type===v.type});return F.baseInfo.items.forEach(function(q){q.name==="environmentId"&&B!==null&&B!==void 0&&B.length&&(q.selects=B,q.defaultValue=B[0].value)}),F},[v,B]);(0,l.useEffect)(function(){k(n.connectionData)},[n.connectionData]);function A(y){N(y)}var V=function(){return[{forceRender:!0,key:"driver",label:(0,s.ag)("connection.title.driver"),children:(0,e.jsx)(Xu,{backfillData:v,onChange:A})},{key:"ssh",forceRender:!0,label:(0,s.ag)("connection.label.sshConfiguration"),children:(0,e.jsxs)("div",{className:sa.sshBox,children:[(0,e.jsx)(Ho,{dataSourceFormConfigProps:g,backfillData:v,form:O,tab:"ssh",disabled:v.isAdmin===!1}),(0,e.jsxs)("div",{className:sa.testSSHConnect,children:[M.sshTestLoading&&(0,e.jsx)(or,{}),(0,e.jsx)("div",{onClick:z,className:sa.testSSHConnectText,children:(0,s.ag)("connection.message.testSshConnection")})]})]})},{forceRender:!0,key:"extendInfo",label:(0,s.ag)("connection.label.advancedConfiguration"),children:(0,e.jsx)("div",{className:sa.extendInfoBox,children:(0,e.jsx)(nc,{backfillData:v})})}]};(0,l.useImperativeHandle)(a,function(){return{getData:U}});function U(){var y=O.getFieldsValue(),F=f.getFieldsValue(),q=[];Go.map(function(J){(J.label||J.value)&&q.push({key:J.label,value:J.value})});var Y=h()(h()({ssh:y,driverConfig:_},F),{},{extendInfo:q,connectionEnvType:d.ConnectionEnvType.DAILY,type:v.type});return v.id&&(Y.id=v.id),Y}function Q(y){var F=U();y!==nt.SAVE&&(F.id=v.id),F.environmentId||(F.environmentId=B[0].value);var q=y===nt.TEST?"testButton":"confirmButton";if(I(h()(h()({},M),{},W()({},q,!0))),y===nt.SAVE&&u){u==null||u(F).finally(function(){I(h()(h()({},M),{},W()({},q,!1)))});return}var Y=ra[y](F);Y.then(function(J){y===nt.TEST?Ge.ZP.success(J===!1?(0,s.ag)("connection.message.testConnectResult",(0,s.ag)("common.text.failure")):(0,s.ag)("connection.message.testConnectResult",(0,s.ag)("common.text.successful"))):(Ge.ZP.success(y===nt.UPDATE?(0,s.ag)("common.message.modifySuccessfully"):(0,s.ag)("common.message.addedSuccessfully")),Mt(),y===nt.SAVE&&k(h()(h()({},v),{},{id:J})))}).finally(function(){I(h()(h()({},M),{},W()({},q,!1)))})}function G(){o()}function z(){var y=O.getFieldsValue();I(h()(h()({},M),{},{sshTestLoading:!0})),ra.testSSH(y).then(function(){Ge.ZP.success((0,s.ag)("connection.message.testConnectResult",(0,s.ag)("common.text.successful")))}).finally(function(){I(h()(h()({},M),{},{sshTestLoading:!1}))})}return(0,e.jsxs)("div",{ref:a,className:sa.connectionBox,children:[(0,e.jsxs)("div",{className:sa.title,children:[(0,e.jsx)(X.Z,{code:(t=d.databaseMap[v.type])===null||t===void 0?void 0:t.icon}),(0,e.jsx)("div",{children:(r=d.databaseMap[v.type])===null||r===void 0?void 0:r.name})]}),(0,e.jsx)("div",{className:sa.baseInfoBox,children:(0,e.jsx)(Ho,{dataSourceFormConfigProps:g,backfillData:v,form:f,tab:"baseInfo",disabled:v.isAdmin===!1})}),(0,e.jsx)(Yu.Z,{defaultActiveKey:["driver"],items:V()}),(0,e.jsxs)("div",{className:sa.formFooter,children:[(0,e.jsx)("div",{className:sa.test,children:(0,e.jsx)(Oe.ZP,{loading:M.testButton,onClick:Q.bind(null,nt.TEST),className:sa.test,children:(0,s.ag)("connection.button.testConnection")})}),(0,e.jsxs)("div",{className:sa.rightButton,children:[(0,e.jsx)(Oe.ZP,{onClick:G,className:sa.cancel,children:(0,s.ag)("common.button.cancel")}),(0,e.jsx)(Oe.ZP,{className:sa.save,type:"primary",loading:M.confirmButton,onClick:Q.bind(null,v.id?nt.UPDATE:nt.SAVE),children:v.id?(0,s.ag)("common.button.modify"):(0,s.ag)("common.button.save")})]})]})]})}),tc=ac;function Ho(n){var a=n.tab,t=n.form,r=n.backfillData,o=n.dataSourceFormConfigProps,i=!1,u=(0,l.useState)(o),c=j()(u,2),m=c[0],f=c[1],b=l.useRef(null);(0,l.useEffect)(function(){t.resetFields(),_(r),b.current=r},[r.id,r.type]),(0,l.useEffect)(function(){f(o)},[o]);var E=(0,l.useMemo)(function(){var D;return N((D=o[a])===null||D===void 0?void 0:D.items)},[]),O=(0,l.useState)(E),T=j()(O,1),x=T[0];(0,l.useEffect)(function(){r&&(a==="baseInfo"&&v({url:r.url},r),a==="ssh"&&v({},r.ssh||{}),a==="driver"&&v({},r.driverConfig||{}))},[r]);function _(D){m.ssh.items.forEach(function(S){if(S.selects){var M;S.defaultValue=(D==null||(M=D.ssh)===null||M===void 0?void 0:M[S.name])||S.defaultValue}}),m.baseInfo.items.forEach(function(S){S.selects&&(S.defaultValue=D[S.name]||S.defaultValue,S.selects.forEach(function(M){M.value===S.defaultValue&&M.onChange&&f(M.onChange(h()({},m)))}))})}function N(D){var S={};return D==null||D.map(function(M){var I;if(S[M.name]=M.defaultValue,(I=M.selects)!==null&&I!==void 0&&I.length){var L;(L=M.selects)===null||L===void 0||L.map(function(P){P.value===M.defaultValue&&(S=h()(h()({},S),N(P.items)))})}}),S}function C(D,S){if(D.length){var M=D[0].name[0],I=D[0].value,L=W()({},M,I),P={};S.map(function(Z){P[Z.name[0]]=Z.value});var w=h()(h()({},b.current||{}),P);b.current=w,a==="baseInfo"&&v(L,w)}}function p(D){for(var S=m.baseInfo,M=S.template,I=S.pattern,L=D.match(I),P=/{(.*?)}/g,w,Z=[];(w=P.exec(M))!==null;)Z.push(w[1]);var B={};return Z.map(function(R,g){B[R]=R==="database"?L[g+2]||"":L[g+1]}),B}function v(D,S,M){var I=(M||m).baseInfo,L=I.template,P=I.pattern,w=Object.keys(D)[0],Z=D[Object.keys(D)[0]],B={};if(w==="url")P.test(Z)&&(B=p(Z));else if(w==="alias")i=!0;else{var R=L;Object.keys(S).map(function(g){R=R.replace("{".concat(g,"}"),S[g]||"")}),B={url:R}}w==="host"&&!i&&(B.alias="@"+Z),t.setFieldsValue(h()(h()({},S),B))}function k(D){var S,M,I,L,P,w,Z=s.a1?D.labelNameEN:D.labelNameCN,B=D.name,R=(D==null||(S=D.styles)===null||S===void 0?void 0:S.width)||"100%",g=s.a1?(D==null||(M=D.styles)===null||M===void 0?void 0:M.labelWidthEN)||"100px":(D==null||(I=D.styles)===null||I===void 0?void 0:I.labelWidthCN)||"70px",A=s.a1?D.placeholderEN:D.placeholder,V=(D==null||(L=D.styles)===null||L===void 0?void 0:L.labelAlign)||"left",U=(P={},W()(P,H.INPUT,function(){return(0,e.jsx)(re.Z.Item,{label:Z,name:B,style:{"--form-label-width":g},labelAlign:V,children:(0,e.jsx)(xe.Z,{placeholder:A})})}),W()(P,H.SELECT,function(){var Q;return(0,e.jsx)(re.Z.Item,{label:Z,name:B,style:{"--form-label-width":g},labelAlign:V,children:(0,e.jsx)(aa.Z,{placeholder:A,value:D.defaultValue,onChange:function(z){var y;(y=D.selects)===null||y===void 0||y.forEach(function(F){if(F.value===z){var q,Y=h()({},o);F.onChange&&(Y=F.onChange(Y)),(q=Y[a])===null||q===void 0||q.items.map(function(J){J.name===B&&(J.defaultValue=F.value)}),f(Y),v(W()({},B,z),b.current,Y)}})},children:(Q=D.selects)===null||Q===void 0?void 0:Q.map(function(G){var z;return(0,e.jsx)(ec,{value:G.value,children:(0,e.jsxs)("div",{className:sa.optionItem,children:[(G==null?void 0:G.color)&&(0,e.jsx)("div",{className:sa.envTag,style:{background:G==null?void 0:G.color.toLocaleLowerCase()}}),G.label]})},(z=G.value)===null||z===void 0?void 0:z.toString())})})})}),W()(P,H.PASSWORD,function(){return(0,e.jsx)(re.Z.Item,{label:Z,name:B,style:{"--form-label-width":g},labelAlign:V,children:(0,e.jsx)(xe.Z.Password,{})})}),P);return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)("div",{className:$()(W()({},sa.labelTextAlign,D.labelTextAlign)),style:{width:R},children:U[D.inputType]()},D.name),(w=D.selects)===null||w===void 0?void 0:w.map(function(Q){if(D.defaultValue===Q.value){var G;return(G=Q.items)===null||G===void 0?void 0:G.map(function(z){return k(z)})}})]},D.name)}return(0,e.jsx)(re.Z,{colon:!1,name:a,form:t,initialValues:x,className:sa.form,autoComplete:"off",labelAlign:"left",onFieldsChange:C,disabled:n.disabled,children:m[a].items.map(function(D){return k(D)})})}var Go=[];function nc(n){var a=n.backfillData,t=a.type,r=(0,l.useState)([{key:0,label:"",value:""}]),o=j()(r,2),i=o[0],u=o[1],c=(0,l.useMemo)(function(){return(0,fa.I8)(pn).find(function(b){return b.type===t})},[a.type]),m=a.isAdmin===!1;(0,l.useEffect)(function(){var b,E=a!=null&&(b=a.extendInfo)!==null&&b!==void 0&&b.length?a==null?void 0:a.extendInfo:c.extendInfo,O=(E==null?void 0:E.map(function(T,x){return{key:x,label:T.key,value:T.value}}))||[];u([].concat(_e()(O),[{key:O.length,label:"",value:""}]))},[c,a]),(0,l.useEffect)(function(){Go=i},[i]);var f=[{title:(0,s.ag)("connection.tableHeader.name"),dataIndex:"label",width:"60%",render:function(E,O,T){var x,_=!0;(x=c.extendInfo)===null||x===void 0||x.map(function(p){p.key===O.label&&(_=!1)});function N(p){var v=_e()(i);v[T]={key:T,label:p.target.value,value:""},u(v)}function C(){var p=[];i.map(function(v){v.label&&p.push(v)}),T===i.length-1&&O.label&&(p[T]={key:T,label:O.label,value:""}),u([].concat(p,[{key:p.length,label:"",value:""}]))}return T===i.length-1||_?(0,e.jsx)(xe.Z,{disabled:m,onBlur:C,placeholder:T===i.length-1?(0,s.ag)("common.text.custom"):"",onChange:N,value:E}):(0,e.jsx)("span",{children:E})}},{title:(0,s.ag)("connection.tableHeader.value"),dataIndex:"value",width:"40%",render:function(E,O,T){function x(_){var N=_e()(i);N[T]={key:T,label:O.label,value:_.target.value},u(N)}return T===i.length-1?(0,e.jsx)(xe.Z,{onBlur:blur,disabled:!0,placeholder:"<value>",onChange:x,value:E}):(0,e.jsx)(xe.Z,{disabled:m,onChange:x,value:E})}}];return(0,e.jsx)("div",{className:sa.extendTable,children:(0,e.jsx)(et.Z,{bordered:!0,size:"small",pagination:!1,columns:f,dataSource:i})})}var rc=K(88484),oc={ncx:{accept:".ncx",uploadUrl:window._BaseURL+"/api/converter/ncx/upload"},dbp:{accept:".dbp",uploadUrl:window._BaseURL+"/api/converter/dbp/upload"}},lc=function(a){var t=a.open,r=a.onClose,o=a.onConfirm,i=(0,l.useState)(null),u=j()(i,2),c=u[0],m=u[1],f=(0,l.useState)(!1),b=j()(f,2),E=b[0],O=b[1];(0,l.useEffect)(function(){t&&m(null)},[t]);var T=function(N){return m(N),!1},x=function(){var _=he()(ee()().mark(function N(){var C,p,v,k,D;return ee()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(c){M.next=2;break}return M.abrupt("return");case 2:return C=new FormData,C.append("file",c),p=c.name.split(".").pop()||"",v=oc[p]||{},k=v.uploadUrl,M.prev=6,O(!0),M.next=10,fetch(k,{method:"POST",body:C});case 10:D=M.sent,D.ok?(Ge.ZP.success("".concat(c.name," \u5BFC\u5165\u6570\u636E\u6E90\u6210\u529F")),o&&o()):Ge.ZP.error("".concat(c.name," \u5BFC\u5165\u6570\u636E\u6E90\u5931\u8D25")),M.next=17;break;case 14:M.prev=14,M.t0=M.catch(6),Ge.ZP.error("Error: ".concat(M.t0));case 17:return M.prev=17,O(!1),M.finish(17);case 20:case"end":return M.stop()}},N,null,[[6,14,17,20]])}));return function(){return _.apply(this,arguments)}}();return(0,e.jsx)(Aa.Z,{title:(0,s.ZP)("connection.title.importTitle"),open:t,onCancel:r,onOk:x,confirmLoading:E,children:(0,e.jsx)(Wo.Z,{name:"file",accept:".ncx,.dbp",beforeUpload:T,maxCount:1,fileList:c?[c]:[],children:(0,e.jsx)(Oe.ZP,{icon:(0,e.jsx)(rc.Z,{}),children:(0,s.ZP)("common.text.selectFile")})})})},ic=lc,qo=(0,l.memo)(function(n){var a=n.className,t=n.onSubmit,r=n.connectionDetail,o=(0,l.useState)(r),i=j()(o,2),u=i[0],c=i[1],m=(0,l.useState)(!1),f=j()(m,2),b=f[0],E=f[1];(0,l.useEffect)(function(){c(r)},[r]);function O(T){c({type:T.code})}return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:$()(va.box,a),children:[u&&(0,e.jsx)("div",{className:$()(va.createConnections,W()({},va.showCreateConnections,u)),children:(0,e.jsx)(tc,{closeCreateConnection:function(){c(null)},connectionData:u,submit:t})}),u===null&&(0,e.jsx)("div",{className:va.dataBaseListBox,children:(0,e.jsxs)("div",{className:va.dataBaseList,children:[d.databaseTypeList.map(function(T){return(0,e.jsx)("div",{className:va.databaseItem,onClick:O.bind(null,T),children:(0,e.jsxs)("div",{className:va.databaseItemMain,children:[(0,e.jsxs)("div",{className:va.databaseItemLeft,children:[(0,e.jsx)("div",{className:va.logoBox,children:(0,e.jsx)(X.Z,{code:T.icon})}),T.name]}),(0,e.jsx)("div",{className:va.databaseItemRight,children:(0,e.jsx)(X.Z,{code:"\uE631"})})]})},T.code)}),(0,e.jsx)("div",{className:va.databaseItem,onClick:function(){E(!0)},children:(0,e.jsxs)("div",{className:va.databaseItemMain,children:[(0,e.jsxs)("div",{className:va.databaseItemLeft,children:[(0,e.jsx)("div",{className:va.logoBox,children:(0,e.jsx)(X.Z,{code:"\uE66C"})}),(0,s.ZP)("connection.title.importConnection")]}),(0,e.jsx)("div",{className:va.databaseItemRight,children:(0,e.jsx)(X.Z,{code:"\uE631"})})]})}),Array.from({length:20}).map(function(T,x){return(0,e.jsx)("div",{className:va.databaseItemSpacer},x)})]})})]}),(0,e.jsx)(ic,{open:b,onClose:function(){E(!1)},onConfirm:function(){E(!1),Mt()}})]})}),sc=function(a,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:250,o=(0,l.useState)(0),i=j()(o,2),u=i[0],c=i[1],m=(0,l.useState)(null),f=j()(m,2),b=f[0],E=f[1],O=(0,l.useCallback)(function(T){E(T),c(function(x){return x+1})},[]);return(0,l.useEffect)(function(){if(u===1){var T=setTimeout(function(){a(b),c(0)},r);return function(){return clearTimeout(T)}}else u===2&&(t(b),c(0))},[u,b,a,t,r]),O},uc=sc,Ma={"f-icon-button":"f-icon-button___ookfr","f-fill-absolute":"f-fill-absolute___FpOKi","f-button":"f-button___d4P92","f-doc-en-break":"f-doc-en-break___ZZb6O",box:"box___Vqymw",layoutLeft:"layoutLeft___Ibe19",pageTitle:"pageTitle___Y996D",menuBox:"menuBox___ryfVe",menuItem:"menuItem___yZ1a7",menuItemsTitle:"menuItemsTitle___Q0vhw",name:"name___VBT5T",envTag:"envTag___R69Yu",databaseTypeIcon:"databaseTypeIcon___gmXIH",moreButton:"moreButton___Aqbkq",menuItemIcon:"menuItemIcon___oElIk",menuItemActive:"menuItemActive___B3EOH",addConnection:"addConnection___qpaVj",layoutRight:"layoutRight___os6UG",dataBaseList:"dataBaseList___dLKyn",databaseItem:"databaseItem___FHFx4",databaseItemMain:"databaseItemMain___s4YuC",databaseItemLeft:"databaseItemLeft___XOt7s",databaseItemRight:"databaseItemRight___tvC6X",logoBox:"logoBox___Ly4DG",databaseItemSpacer:"databaseItemSpacer___usrJm",createConnections:"createConnections___Tlbm2",showCreateConnections:"showCreateConnections___AN73l",envLabel:"envLabel___SX5xe",envRefreshBox:"envRefreshBox___TAiuG","loading-animation":"loading-animation___obpMP"},cc=function(){var a=Ga(function(p){return{connectionList:p.connectionList}}),t=a.connectionList,r=(0,l.useRef)(),o=(0,l.useState)(null),i=j()(o,2),u=i[0],c=i[1],m=(0,l.useState)(null),f=j()(m,2),b=f[0],E=f[1],O=function(v){u!==v.id&&c(v.id)},T=function(v){Yt(v),ar("workspace")},x=uc(O,T);(0,l.useEffect)(function(){u&&(E(void 0),ra.getDetails({id:u}).then(function(p){E(p)}).catch(function(){c(null)}))},[u]);var _=function(v){var k=function(I){var L,P;(L=I.domEvent)===null||L===void 0||(P=L.stopPropagation)===null||P===void 0||P.call(L),ra.remove({id:v.id}).then(function(){Mt().then(function(){Tr()}),u===v.id&&(c(null),E(null))})},D=function(I){var L,P;(L=I.domEvent)===null||L===void 0||(P=L.stopPropagation)===null||P===void 0||P.call(L),T(v)},S=function(I){var L,P;(L=I.domEvent)===null||L===void 0||(P=L.stopPropagation)===null||P===void 0||P.call(L),ra.clone({id:v.id}).then(function(w){Mt(),c(w)})};return[{key:"enterWorkSpace",label:(0,e.jsx)(ba,{icon:"\uEC57",label:(0,s.ZP)("connection.button.connect")}),onClick:D},{key:"copyConnection",label:(0,e.jsx)(ba,{icon:"\uEC7A",label:(0,s.ZP)("common.button.copy")}),onClick:S},{key:"delete",label:(0,e.jsx)(ba,{icon:"\uE6A7",label:(0,s.ZP)("connection.button.remove")}),onClick:k}]},N=function(){return t==null?void 0:t.map(function(v){var k;return(0,e.jsx)(Ae.Z,{trigger:["contextMenu"],menu:{items:_(v)},children:(0,e.jsx)("div",{className:$()(Ma.menuItem,W()({},Ma.menuItemActive,u===v.id)),onClick:function(){x(v)},children:(0,e.jsxs)("div",{className:$()(Ma.menuItemsTitle),children:[(0,e.jsx)("span",{className:Ma.envTag,style:{background:v.environment.color.toLocaleLowerCase()}}),(0,e.jsx)("span",{className:Ma.databaseTypeIcon,children:(0,e.jsx)(X.Z,{className:Ma.menuItemIcon,code:(k=d.databaseMap[v.type])===null||k===void 0?void 0:k.icon})}),(0,e.jsx)("span",{className:Ma.name,children:v.alias})]})})},v.id)})},C=function(v){return ra.save(h()({},v)).then(function(k){Mt(),c(k)})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:Ma.box,children:[(0,e.jsxs)("div",{ref:r,className:Ma.layoutLeft,children:[(0,e.jsx)("div",{className:Ma.pageTitle,children:(0,s.ZP)("connection.title.connections")}),(0,e.jsx)("div",{className:Ma.menuBox,children:N()}),u&&(0,e.jsx)(Oe.ZP,{type:"primary",className:Ma.addConnection,onClick:function(){c(null),E(null)},children:(0,s.ZP)("connection.button.addConnection")})]}),(0,e.jsx)(Nn,{className:Ma.layoutRight,isLoading:b===void 0&&!!u,children:(0,e.jsx)(qo,{connectionDetail:b,onSubmit:C})})]})})},dc=cc,mc=K(36027),fc=K(87547),vc=K(55355),_c=K(69785),bt=K(86738),Mn=K(68795),Zn=K(24969),pc=(0,ae.Z)("/api/admin/data_source/page",{method:"get"}),hc=(0,ae.Z)("/api/admin/data_source/create",{method:"post"}),bc=(0,ae.Z)("/api/admin/data_source/update",{method:"post"}),Nc=(0,ae.Z)("/api/admin/data_source/:id",{method:"delete"}),Sc=(0,ae.Z)("/api/admin/data_source/access/page",{method:"get"}),Tc=(0,ae.Z)("/api/admin/data_source/access/batch_create",{method:"post"}),Ko=(0,ae.Z)("/api/admin/data_source/access/:id",{method:"delete"}),Ec=(0,ae.Z)("/api/admin/user/page",{method:"get"}),Cc=(0,ae.Z)("/api/admin/user/create",{method:"post"}),gc=(0,ae.Z)("/api/admin/user/update",{method:"post"}),xc=(0,ae.Z)("/api/admin/user/:id",{method:"delete"}),Ic=(0,ae.Z)("/api/admin/user/team/page",{method:"get"}),yc=(0,ae.Z)("/api/admin/user/team/batch_create",{method:"post"}),zo=(0,ae.Z)("/api/admin/user/team/:id",{method:"delete"}),Dc=(0,ae.Z)("/api/admin/user/data_source/page",{method:"get"}),Lc=(0,ae.Z)("/api/admin/user/data_source/batch_create",{method:"post"}),pr=(0,ae.Z)("/api/admin/user/data_source/:id",{method:"delete"}),Rc=(0,ae.Z)("/api/admin/team/page",{method:"get"}),Pc=(0,ae.Z)("/api/admin/team/create",{method:"post"}),Ac=(0,ae.Z)("/api/admin/team/update",{method:"post"}),Oc=(0,ae.Z)("/api/admin/team/:id",{method:"delete"}),jc=(0,ae.Z)("/api/admin/team/user/page",{method:"get"}),kc=(0,ae.Z)("/api/admin/team/user/batch_create",{method:"post"}),Yo=(0,ae.Z)("/api/admin/team/user/:id",{method:"delete"}),wc=(0,ae.Z)("/api/admin/team/data_source/page",{method:"get"}),Mc=(0,ae.Z)("/api/admin/team/data_source/batch_create",{method:"post"}),Zc=(0,ae.Z)("/api/admin/team/data_source/:id",{method:"delete"}),Bc=(0,ae.Z)("/api/admin/common/user/list",{method:"get"}),Uc=(0,ae.Z)("/api/admin/common/team/list",{method:"get"}),Fc=(0,ae.Z)("/api/admin/common/data_source/list",{method:"get"}),Vc=(0,ae.Z)("/api/admin/common/team_user/list",{method:"get"}),hr=K(66309),Wc=K(23279),Hc=K.n(Wc),Vt,Gc=(Vt={},W()(Vt,Ka["USER/TEAM"],{title:(0,s.ZP)("team.action.addUserAndTeam"),loadRequest:Vc,searchLabel:function(a){return a.name},searchValue:function(a){return JSON.stringify({id:a.id,type:a.type})},searchListKey:"accessObjectList",placeholder:(0,s.ZP)("team.action.addUserAndTeam.placeholder")}),W()(Vt,Ka.TEAM,{title:(0,s.ZP)("team.action.addTeam"),loadRequest:Uc,searchLabel:function(a){return a.name},searchValue:function(a){return a.id},searchListKey:"teamIdList",placeholder:(0,s.ZP)("team.action.addTeam.placeholder")}),W()(Vt,Ka.USER,{title:(0,s.ZP)("team.action.addUser"),loadRequest:Bc,searchLabel:function(a){return a.userName},searchValue:function(a){return a.id},searchListKey:"userIdList",placeholder:(0,s.ZP)("team.action.addUser.placeholder")}),W()(Vt,Ka.DATASOURCE,{title:(0,s.ZP)("team.action.addDatasource"),loadRequest:Fc,searchLabel:function(a){return a.alias},searchValue:function(a){return a.id},searchListKey:"dataSourceIdList",placeholder:(0,s.ZP)("team.action.addDatasource.placeholder")}),Vt);function qc(n){var a=n.open,t=n.type,r=(0,l.useState)(!1),o=j()(r,2),i=o[0],u=o[1],c=(0,l.useState)([]),m=j()(c,2),f=m[0],b=m[1],E=(0,l.useState)([]),O=j()(E,2),T=O[0],x=O[1],_=(0,l.useMemo)(function(){if(t)return Gc[t]},[t]);(0,l.useEffect)(function(){N("")},[]);var N=function(v){b([]),u(!0),_==null||_.loadRequest({searchKey:v}).then(function(k){var D=(k||[]).map(function(S){return h()(h()({},S),{},{label:_.searchLabel(S),value:_.searchValue(S),key:S.id})});b(D),u(!1)})},C=function(){if(!(!n.onConfirm||!_)){var v=W()({},_.searchListKey,t!==Ka["USER/TEAM"]?T:T.map(function(k){return JSON.parse(k)}));n.onConfirm(v),n.onClose&&n.onClose(),x([]),b([])}};return(0,e.jsx)(Aa.Z,{open:a,onOk:C,onCancel:function(){n.onClose&&n.onClose()},title:_==null?void 0:_.title,children:(0,e.jsx)(aa.Z,{size:"large",mode:"multiple",style:{width:"100%"},onSearch:Hc()(N,300),placeholder:_==null?void 0:_.placeholder,filterOption:!1,notFoundContent:i?(0,e.jsx)(mt.Z,{style:{margin:"16px 0"},size:"small"}):null,options:f,value:T,onChange:function(v){x(v)}})})}var Kc=qc,zc={tableTop:"tableTop___sfhtz"};function Yc(n){var a=n.type,t=n.open,r=(0,l.useState)([]),o=j()(r,2),i=o[0],u=o[1],c=(0,l.useState)({open:!1}),m=j()(c,2),f=m[0],b=m[1],E=(0,l.useState)(""),O=j()(E,2),T=O[0],x=O[1],_=(0,l.useState)({searchKey:"",current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),N=j()(_,2),C=N[0],p=N[1],v=(0,l.useState)(0),k=j()(v,2),D=k[0],S=k[1],M=(0,l.useMemo)(function(){var Z;return Z={},W()(Z,Sa.USER_TEAM,{type:Sa.USER_TEAM,searchType:Ka.TEAM,title:(0,s.ZP)("team.team.name"),byIdKey:"userId",queryListApi:Ic,updateListApi:yc,deleteApi:zo,columns:[{title:(0,s.ZP)("team.team.addForm.code"),dataIndex:["team","code"],key:"team.code"},{title:(0,s.ZP)("team.team.addForm.name"),dataIndex:["team","name"],key:"team.name"},{title:(0,s.ZP)("common.text.action"),key:"action",width:100,render:function(R,g){return(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),onConfirm:he()(ee()().mark(function A(){return ee()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(g.id===void 0){U.next=5;break}return U.next=3,zo({id:g.id});case 3:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),L();case 5:case"end":return U.stop()}},A)})),children:(0,e.jsx)("a",{href:"#",onClick:function(V){return V.preventDefault()},children:(0,s.ZP)("common.button.delete")})})}}]}),W()(Z,Sa.USER_DATASOURCE,{type:Sa.USER_DATASOURCE,searchType:Ka.DATASOURCE,title:(0,s.ZP)("team.datasource.rightManagement"),byIdKey:"userId",queryListApi:Dc,updateListApi:Lc,deleteApi:pr,columns:[{title:(0,s.ZP)("team.datasource.alias"),dataIndex:["dataSource","alias"],key:"dataSource.alias"},{title:(0,s.ZP)("team.datasource.url"),dataIndex:["dataSource","url"],key:"dataSource.url"},{title:(0,s.ZP)("common.text.action"),key:"action",width:100,render:function(R,g){return(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),onConfirm:he()(ee()().mark(function A(){return ee()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(g.id===void 0){U.next=5;break}return U.next=3,pr({id:g.id});case 3:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),L();case 5:case"end":return U.stop()}},A)})),children:(0,e.jsx)("a",{href:"#",onClick:function(V){return V.preventDefault()},children:(0,s.ZP)("common.button.delete")})})}}]}),W()(Z,Sa.TEAM_USER,{type:Sa.TEAM_USER,searchType:Ka.USER,title:(0,s.ZP)("team.user.name"),byIdKey:"teamId",queryListApi:jc,updateListApi:kc,deleteApi:Yo,columns:[{title:(0,s.ZP)("team.user.addForm.userName"),dataIndex:["user","userName"],key:"user.userName"},{title:(0,s.ZP)("team.user.addForm.nickName"),dataIndex:["user","nickName"],key:"user.nickName"},{title:(0,s.ZP)("common.text.action"),key:"action",width:100,render:function(R,g){return(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),onConfirm:he()(ee()().mark(function A(){return ee()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(g.id===void 0){U.next=5;break}return U.next=3,Yo({id:g.id});case 3:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),L();case 5:case"end":return U.stop()}},A)})),children:(0,e.jsx)("a",{href:"#",onClick:function(V){return V.preventDefault()},children:(0,s.ZP)("common.button.delete")})})}}]}),W()(Z,Sa.TEAM_DATASOURCE,{type:Sa.TEAM_DATASOURCE,searchType:Ka.DATASOURCE,title:(0,s.ZP)("team.action.affiliation.datasource"),byIdKey:"teamId",queryListApi:wc,updateListApi:Mc,deleteApi:Zc,columns:[{title:(0,s.ZP)("team.datasource.alias"),dataIndex:["dataSource","alias"],key:"dataSource.alias"},{title:(0,s.ZP)("team.datasource.url"),dataIndex:["dataSource","url"],key:"dataSource.url"},{title:(0,s.ZP)("common.text.action"),key:"action",width:100,render:function(R,g){return(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),onConfirm:he()(ee()().mark(function A(){return ee()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(g.id===void 0){U.next=5;break}return U.next=3,pr({id:g.id});case 3:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),L();case 5:case"end":return U.stop()}},A)})),children:(0,e.jsx)("a",{href:"#",onClick:function(V){return V.preventDefault()},children:(0,s.ZP)("common.button.delete")})})}}]}),W()(Z,Sa["DATASOURCE_USER/TEAM"],{type:Sa["DATASOURCE_USER/TEAM"],searchType:Ka["USER/TEAM"],title:(0,s.ZP)("team.datasource.rightManagement"),byIdKey:"dataSourceId",queryListApi:Sc,updateListApi:Tc,deleteApi:Ko,columns:[{title:(0,s.ZP)("team.datasource.code"),dataIndex:["accessObject","code"],key:"accessObject.code"},{title:(0,s.ZP)("team.datasource.name"),dataIndex:["accessObject","name"],key:"accessObject.name"},{title:(0,s.ZP)("team.datasource.status"),dataIndex:["accessObject","type"],key:"accessObject.type",render:function(R){return(0,e.jsx)(hr.Z,{color:R===xu.TEAM?"blue":"lime",children:R})}},{title:(0,s.ZP)("common.text.action"),key:"action",width:100,render:function(R,g){return(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),onConfirm:he()(ee()().mark(function A(){return ee()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(g.id===void 0){U.next=5;break}return U.next=3,Ko({id:g.id});case 3:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),L();case 5:case"end":return U.stop()}},A)})),children:(0,e.jsx)("a",{href:"#",onClick:function(V){return V.preventDefault()},children:(0,s.ZP)("common.button.delete")})})}}]}),Z},[n.byId,a]),I=a?M[a]:null;(0,l.useEffect)(function(){t&&(x(""),p({searchKey:"",current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),S(0),b({open:!1,type:I==null?void 0:I.searchType}))},[n.byId,a,t]),(0,l.useEffect)(function(){L()},[C]);var L=function(){var Z=he()(ee()().mark(function B(R){var g,A,V,U,Q,G;return ee()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(g=C.current,A=C.pageSize,V=I==null?void 0:I.queryListApi,!(!V||!(0,Bt.isNumber)(n.byId))){y.next=4;break}return y.abrupt("return");case 4:return y.next=6,V(W()({searchKey:R||C.searchKey,pageNo:g,pageSize:A},I==null?void 0:I.byIdKey,n.byId));case 6:U=y.sent,U&&(u((Q=U==null?void 0:U.data)!==null&&Q!==void 0?Q:[]),S((G=U==null?void 0:U.total)!==null&&G!==void 0?G:0));case 8:case"end":return y.stop()}},B)}));return function(R){return Z.apply(this,arguments)}}(),P=function(B){p(h()(h()({},C),{},{searchKey:B}))},w=function(B){p(h()(h()({},C),B))};if(I)return(0,e.jsxs)(mr.Z,{open:t,width:720,title:I==null?void 0:I.title,onClose:n.onClose,children:[(0,e.jsxs)("div",{className:zc.tableTop,children:[(0,e.jsx)(xe.Z.Search,{style:{width:"200px"},placeholder:(0,s.ZP)("team.input.search.placeholder"),value:T,onChange:function(B){return x(B.target.value)},onSearch:P,enterButton:(0,e.jsx)(Mn.Z,{})}),(0,e.jsx)(Oe.ZP,{type:"primary",icon:(0,e.jsx)(Zn.Z,{}),onClick:function(){b(h()(h()({},f),{},{open:!0,type:I.searchType}))},children:(0,s.ZP)("common.button.add")})]}),(0,e.jsx)(et.Z,{rowKey:"id",pagination:h()(h()({},C),{},{total:D}),columns:I==null?void 0:I.columns,dataSource:i,onChange:w}),(0,e.jsx)(Kc,h()(h()({},f),{},{onConfirm:function(B){I.updateListApi(h()(W()({},I.byIdKey,n.byId),B)).then(function(R){Ge.ZP.success((0,s.ZP)("common.tips.updateSuccess")),L()})},onClose:function(){b(h()(h()({},f),{},{open:!1}))}}))]})}var br=Yc,Qc={tableTop:"tableTop___jgYwy"};function $c(){var n,a=(0,l.useState)([]),t=j()(a,2),r=t[0],o=t[1],i=(0,l.useState)({searchKey:"",current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),u=j()(i,2),c=u[0],m=u[1],f=(0,l.useState)(!1),b=j()(f,2),E=b[0],O=b[1],T=(0,l.useRef)(null),x=(0,l.useState)({open:!1,type:Sa["DATASOURCE_USER/TEAM"]}),_=j()(x,2),N=_[0],C=_[1],p=(0,l.useMemo)(function(){return[{title:(0,s.ZP)("team.datasource.alias"),dataIndex:"alias",key:"alias"},{title:(0,s.ZP)("team.datasource.url"),dataIndex:"url",key:"url"},{title:(0,s.ZP)("common.text.action"),key:"action",width:300,render:function(w,Z){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){M(Z)},children:(0,s.ZP)("common.button.edit")}),(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){C(h()(h()({},N),{},{open:!0,id:Z.id}))},children:(0,s.ZP)("team.action.rightManagement")}),(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),onConfirm:function(){return I(Z.id)},okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),children:(0,e.jsx)("a",{href:"#",onClick:function(R){return R.preventDefault()},children:(0,s.ZP)("common.button.delete")})})]})}}]},[]);(0,l.useEffect)(function(){v()},[c.current,c.pageSize,c.searchKey]);var v=function(){var P=he()(ee()().mark(function w(){var Z,B,R,g,A,V;return ee()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Z=c.searchKey,B=c.current,R=c.pageSize,Q.next=3,pc({searchKey:Z,pageNo:B,pageSize:R});case 3:g=Q.sent,g&&(o((A=g==null?void 0:g.data)!==null&&A!==void 0?A:[]),m(h()(h()({},c),{},{total:(V=g==null?void 0:g.total)!==null&&V!==void 0?V:0})));case 5:case"end":return Q.stop()}},w)}));return function(){return P.apply(this,arguments)}}(),k=function(w){m(h()(h()({},c),{},{searchKey:w}))},D=function(w){m(h()(h()({},c),w))},S=function(){T.current=null,O(!0)},M=function(){var P=he()(ee()().mark(function w(Z){var B,R;return ee()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(B=Z.id,B){A.next=3;break}return A.abrupt("return");case 3:return A.next=5,ra.getDetails({id:B});case 5:R=A.sent,T.current=R,O(!0);case 8:case"end":return A.stop()}},w)}));return function(Z){return P.apply(this,arguments)}}(),I=function(){var P=he()(ee()().mark(function w(Z){return ee()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!(0,Bt.isNumber)(Z)){R.next=5;break}return R.next=3,Nc({id:Z});case 3:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),v();case 5:case"end":return R.stop()}},w)}));return function(Z){return P.apply(this,arguments)}}(),L=function(w){var Z;if(JSON.stringify(T.current)==="{}")return new Promise(function(g){g(!0)});T.current=w;var B=Cn(T==null||(Z=T.current)===null||Z===void 0?void 0:Z.id),R=B?bc:hc;return R(h()({},T.current)).then(function(){Ge.ZP.success(B?(0,s.ZP)("common.tips.updateSuccess"):(0,s.ZP)("common.tips.createSuccess")),O(!1),v()})};return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:Qc.tableTop,children:[(0,e.jsx)(xe.Z.Search,{style:{width:"320px"},placeholder:(0,s.ZP)("team.input.search.placeholder"),onSearch:k,enterButton:(0,e.jsx)(Mn.Z,{})}),(0,e.jsx)(Oe.ZP,{type:"primary",icon:(0,e.jsx)(Zn.Z,{}),onClick:S,children:(0,s.ZP)("team.action.addDatasource")})]}),(0,e.jsx)(et.Z,{style:{maxHeight:"82vh",overflow:"auto"},sticky:!0,rowKey:"id",dataSource:r,columns:p,pagination:c,onChange:D}),(0,e.jsx)(mr.Z,{title:T!=null&&(n=T.current)!==null&&n!==void 0&&n.id?(0,s.ZP)("team.action.editDatasource"):(0,s.ZP)("team.action.addDatasource"),width:1e3,open:E,onClose:function(){return O(!1)},children:(0,e.jsx)(qo,{connectionDetail:T.current,onSubmit:L})}),(0,e.jsx)(br,h()(h()({},N),{},{byId:N.id,onClose:function(){C(h()(h()({},N),{},{open:!1}))}}))]})}var Jc=$c,Xc={tableTop:"tableTop___Ljf08"},ed={labelCol:{span:6},wrapperCol:{span:16},colon:!1},Wt={required:!0,message:(0,s.ZP)("common.form.error.required")};function ad(){var n=re.Z.useForm(),a=j()(n,1),t=a[0],r=(0,l.useState)([]),o=j()(r,2),i=o[0],u=o[1],c=(0,l.useState)({searchKey:"",current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","30","40"]}),m=j()(c,2),f=m[0],b=m[1],E=(0,l.useState)(!1),O=j()(E,2),T=O[0],x=O[1],_=(0,l.useState)({open:!1}),N=j()(_,2),C=N[0],p=N[1],v=(0,l.useMemo)(function(){return[{title:(0,s.ZP)("team.user.userName"),dataIndex:"userName",key:"userName"},{title:(0,s.ZP)("team.user.nickName"),dataIndex:"nickName",key:"nickName"},{title:(0,s.ZP)("team.user.status"),dataIndex:"status",key:"status",render:function(Z){return(0,e.jsx)(hr.Z,{color:Z===ht.VALID?"green":"red",children:Z})}},{title:(0,s.ZP)("common.text.action"),key:"action",width:260,render:function(Z,B){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){I(B)},children:(0,s.ZP)("common.button.edit")}),(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){p(h()(h()({},C),{},{open:!0,type:Sa.USER_TEAM,id:B.id}))},children:(0,s.ZP)("team.action.affiliation.team")}),(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){p(h()(h()({},C),{},{open:!0,type:Sa.USER_DATASOURCE,id:B.id}))},children:(0,s.ZP)("team.action.affiliation.datasource")}),(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),onConfirm:function(){return L(B.id)},okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),children:(0,e.jsx)("a",{href:"#",onClick:function(g){return g.preventDefault()},children:(0,s.ZP)("common.button.delete")})})]})}}]},[]);(0,l.useEffect)(function(){k()},[f.current,f.pageSize,f.searchKey]);var k=function(){var w=he()(ee()().mark(function Z(){var B,R,g,A,V,U;return ee()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return B=f.searchKey,R=f.current,g=f.pageSize,G.next=3,Ec({searchKey:B,pageNo:R,pageSize:g});case 3:A=G.sent,A&&(u((V=A==null?void 0:A.data)!==null&&V!==void 0?V:[]),b(h()(h()({},f),{},{total:(U=A==null?void 0:A.total)!==null&&U!==void 0?U:0})));case 5:case"end":return G.stop()}},Z)}));return function(){return w.apply(this,arguments)}}(),D=function(Z){b(h()(h()({},f),Z))},S=function(Z){b(h()(h()({},f),{},{searchKey:Z}))},M=function(){var w=he()(ee()().mark(function Z(B){var R,g;return ee()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return R=B!=null&&B.id?gc:Cc,V.next=3,R(B);case 3:g=V.sent,g&&k();case 5:case"end":return V.stop()}},Z)}));return function(B){return w.apply(this,arguments)}}(),I=function(Z){t.setFieldsValue(Z),x(!0)},L=function(){var w=he()(ee()().mark(function Z(B){return ee()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,xc({id:B});case 2:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),k();case 4:case"end":return g.stop()}},Z)}));return function(B){return w.apply(this,arguments)}}(),P=(0,l.useMemo)(function(){return t.getFieldValue("id")!==void 0},[t.getFieldValue("id")]);return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:Xc.tableTop,children:[(0,e.jsx)(xe.Z.Search,{maxLength:50,style:{width:"320px"},placeholder:(0,s.ZP)("team.input.search.placeholder"),onSearch:S,enterButton:(0,e.jsx)(Mn.Z,{})}),(0,e.jsx)(Oe.ZP,{type:"primary",icon:(0,e.jsx)(Zn.Z,{}),onClick:function(){t.resetFields(),x(!0)},children:(0,s.ZP)("team.action.addUser")})]}),(0,e.jsx)(et.Z,{style:{maxHeight:"82vh",overflow:"auto"},sticky:!0,rowKey:"id",dataSource:i,columns:v,pagination:f,onChange:D}),(0,e.jsx)(Aa.Z,{title:P?(0,s.ZP)("team.action.editUser"):(0,s.ZP)("team.action.addUser"),open:T,onOk:function(){t.validateFields().then(function(Z){var B=t.getFieldsValue(!0);M(B),x(!1),t.resetFields()}).catch(function(Z){t.scrollToField(Z.errorFields[0].name),t.setFields(Z.errorFields)}).finally(function(){t.resetFields()})},onCancel:function(){t.resetFields(),x(!1)},children:(0,e.jsxs)(re.Z,h()(h()({},ed),{},{form:t,autoComplete:"off",initialValues:{roleCode:vr.USER,status:ht.VALID},children:[(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.user.addForm.userName"),name:"userName",rules:[Wt],children:(0,e.jsx)(xe.Z,{maxLength:50,showCount:!0,autoComplete:"off"})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.user.addForm.nickName"),name:"nickName",rules:[Wt],children:(0,e.jsx)(xe.Z,{maxLength:100,showCount:!0})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.user.addForm.email"),name:"email",rules:[Wt,{type:"email",message:(0,s.ZP)("common.form.error.email")}],children:(0,e.jsx)(xe.Z,{autoComplete:"off"})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.user.addForm.password"),name:"password",rules:[Wt],children:(0,e.jsx)(xe.Z.Password,{maxLength:30,placeholder:P?"******":"",autoComplete:"fake-password"})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.user.addForm.roleCode"),name:"roleCode",rules:[Wt],children:(0,e.jsxs)(Wa.ZP.Group,{children:[(0,e.jsx)(Wa.ZP,{value:vr.ADMIN,children:(0,s.ZP)("team.user.addForm.roleCode.admin")}),(0,e.jsx)(Wa.ZP,{value:vr.USER,children:(0,s.ZP)("team.user.addForm.roleCode.user")})]})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.user.addForm.status"),name:"status",rules:[Wt],children:(0,e.jsxs)(Wa.ZP.Group,{children:[(0,e.jsx)(Wa.ZP,{value:ht.VALID,children:(0,s.ZP)("team.user.addForm.status.valid")}),(0,e.jsx)(Wa.ZP,{value:ht.INVALID,children:(0,s.ZP)("team.user.addForm.status.invalid")})]})})]}))}),(0,e.jsx)(br,h()(h()({},C),{},{byId:C.id,onClose:function(){p(h()(h()({},C),{},{open:!1}))}}))]})}var td=ad,nd={tableTop:"tableTop___dxtai"},rd={labelCol:{span:6},wrapperCol:{span:16},colon:!1},Qo={required:!0,message:(0,s.ZP)("common.form.error.required")};function od(){var n=re.Z.useForm(),a=j()(n,1),t=a[0],r=(0,l.useState)(!1),o=j()(r,2),i=o[0],u=o[1],c=(0,l.useState)([]),m=j()(c,2),f=m[0],b=m[1],E=(0,l.useState)({searchKey:"",current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),O=j()(E,2),T=O[0],x=O[1],_=(0,l.useState)(!1),N=j()(_,2),C=N[0],p=N[1],v=(0,l.useState)({open:!1}),k=j()(v,2),D=k[0],S=k[1],M=(0,l.useMemo)(function(){return[{title:(0,s.ZP)("team.team.addForm.code"),dataIndex:"code",key:"code"},{title:(0,s.ZP)("team.team.addForm.name"),dataIndex:"name",key:"name"},{title:(0,s.ZP)("team.team.addForm.status"),dataIndex:"status",key:"status",render:function(g){return(0,e.jsx)(hr.Z,{color:g===ht.VALID?"green":"red",children:g})}},{title:(0,s.ZP)("common.text.action"),key:"action",width:260,render:function(g,A){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){return Z(A)},children:(0,s.ZP)("common.button.edit")}),(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){S(h()(h()({},D),{},{open:!0,teamId:A.id,type:Sa.TEAM_USER}))},children:(0,s.ZP)("team.action.affiliation.user")}),(0,e.jsx)(Oe.ZP,{type:"link",onClick:function(){S(h()(h()({},D),{},{open:!0,teamId:A.id,type:Sa.TEAM_DATASOURCE}))},children:(0,s.ZP)("team.action.affiliation.datasource")}),(0,e.jsx)(bt.Z,{title:(0,s.ZP)("common.tips.delete.confirm"),onConfirm:function(){return B(A.id)},okText:(0,s.ZP)("common.button.affirm"),cancelText:(0,s.ZP)("common.button.cancel"),children:(0,e.jsx)("a",{href:"#",onClick:function(U){return U.preventDefault()},children:(0,s.ZP)("common.button.delete")})})]})}}]},[]);(0,l.useEffect)(function(){I()},[T.current,T.pageSize,T.searchKey]);var I=function(){var R=he()(ee()().mark(function g(){var A,V,U,Q,G,z;return ee()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return u(!0),F.prev=1,A=T.searchKey,V=T.current,U=T.pageSize,F.next=5,Rc({searchKey:A,pageNo:V,pageSize:U});case 5:Q=F.sent,Q&&(b((G=Q==null?void 0:Q.data)!==null&&G!==void 0?G:[]),x(h()(h()({},T),{},{total:(z=Q==null?void 0:Q.total)!==null&&z!==void 0?z:0}))),F.next=11;break;case 9:F.prev=9,F.t0=F.catch(1);case 11:return F.prev=11,u(!1),F.finish(11);case 14:case"end":return F.stop()}},g,null,[[1,9,11,14]])}));return function(){return R.apply(this,arguments)}}(),L=function(g){x(h()(h()({},T),g))},P=function(g){x(h()(h()({},T),{},{searchKey:g}))},w=function(){var R=he()(ee()().mark(function g(A){var V,U;return ee()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return V=A.id?Ac:Pc,G.next=3,V(A);case 3:U=G.sent,U&&I();case 5:case"end":return G.stop()}},g)}));return function(A){return R.apply(this,arguments)}}(),Z=function(g){t.setFieldsValue(g),p(!0)},B=function(){var R=he()(ee()().mark(function g(A){return ee()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(A===void 0){U.next=5;break}return U.next=3,Oc({id:A});case 3:Ge.ZP.success((0,s.ZP)("common.text.successfullyDelete")),I();case 5:case"end":return U.stop()}},g)}));return function(A){return R.apply(this,arguments)}}();return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:nd.tableTop,children:[(0,e.jsx)(xe.Z.Search,{style:{width:"320px"},placeholder:(0,s.ZP)("team.input.search.placeholder"),onSearch:P,enterButton:(0,e.jsx)(Mn.Z,{})}),(0,e.jsx)(Oe.ZP,{type:"primary",icon:(0,e.jsx)(Zn.Z,{}),onClick:function(){return p(!0)},children:(0,s.ZP)("team.action.addTeam")})]}),(0,e.jsx)(et.Z,{style:{maxHeight:"82vh",overflow:"auto"},sticky:!0,rowKey:"id",loading:i,dataSource:f,columns:M,pagination:T,onChange:L}),(0,e.jsx)(Aa.Z,{title:t.getFieldValue("id")!==void 0?(0,s.ZP)("team.action.editTeam"):(0,s.ZP)("team.action.addTeam"),open:C,onOk:function(){t.validateFields().then(function(g){var A=t.getFieldsValue(!0);w(A),p(!1),t.resetFields()}).catch(function(g){t.scrollToField(g.errorFields[0].name),t.setFields(g.errorFields)})},onCancel:function(){t.resetFields(),p(!1)},children:(0,e.jsxs)(re.Z,h()(h()({},rd),{},{form:t,autoComplete:"off",initialValues:{status:ht.VALID},children:[(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.team.addForm.code"),name:"code",rules:[Qo],children:(0,e.jsx)(xe.Z,{})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.team.addForm.name"),name:"name",children:(0,e.jsx)(xe.Z,{})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.team.addForm.status"),name:"status",rules:[Qo],children:(0,e.jsxs)(Wa.ZP.Group,{children:[(0,e.jsx)(Wa.ZP,{value:ht.VALID,children:(0,s.ZP)("team.team.addForm.status.valid")}),(0,e.jsx)(Wa.ZP,{value:ht.INVALID,children:(0,s.ZP)("team.team.addForm.status.invalid")})]})}),(0,e.jsx)(re.Z.Item,{label:(0,s.ZP)("team.team.addForm.description"),name:"description",children:(0,e.jsx)(xe.Z.TextArea,{})})]}))}),(0,e.jsx)(br,h()(h()({},D),{},{byId:D.teamId,onClose:function(){S(h()(h()({},D),{},{open:!1}))}}))]})}var ld=od,$o={teamWrapper:"teamWrapper___LbePW",teamTabsBox:"teamTabsBox___rvRzI"},id=function(){var a=(0,l.useState)("0"),t=j()(a,2),r=t[0],o=t[1],i=(0,l.useMemo)(function(){return[{label:(0,s.ZP)("team.tab.datasource"),icon:(0,e.jsx)(mc.Z,{}),children:(0,e.jsx)(Jc,{})},{label:(0,s.ZP)("team.tab.user"),icon:(0,e.jsx)(fc.Z,{}),children:(0,e.jsx)(td,{})},{label:(0,s.ZP)("team.tab.team"),icon:(0,e.jsx)(vc.Z,{}),children:(0,e.jsx)(ld,{})}]},[]);return(0,e.jsx)("div",{className:$o.teamWrapper,children:(0,e.jsx)(_c.Z,{className:$o.teamTabsBox,activeKey:r,onChange:function(c){return o(c)},items:i.map(function(u,c){return{key:String(c),label:(0,e.jsxs)("span",{children:[u.icon,u.label]}),children:u.children}})})})},sd=id,ud=K(30528),ya={page:"page___YueCb",layoutLeft:"layoutLeft___vqtsw",dargBox:"dargBox____iumN",brandLogo:"brandLogo___uAMRL",navList:"navList___zgd3g",icon:"icon___rNUKr",activeNav:"activeNav___pIEK_",footer:"footer___GgRwE",userBox:"userBox___UpcoO",questionIcon:"questionIcon___ValoS",rocketIcon:"rocketIcon___SIeVY",userDropdown:"userDropdown___Mt8ks",layoutRight:"layoutRight___fIrFq",main:"main___IkUdn",componentBox:"componentBox___XjmnM"},cd=K(77101),dd=K(31901),md=[{key:"workspace",icon:"\uE616",iconFontSize:16,isLoad:!1,component:(0,e.jsx)(Eu,{}),name:(0,s.ZP)("workspace.title")},{key:"dashboard",icon:"\uE629",iconFontSize:24,isLoad:!1,component:(0,e.jsx)(zu,{}),name:(0,s.ZP)("dashboard.title")},{key:"connections",icon:"\uE622",iconFontSize:20,isLoad:!1,component:(0,e.jsx)(dc,{}),name:(0,s.ZP)("connection.title")},{key:"github",icon:"\uE885",iconFontSize:26,isLoad:!1,openBrowser:"https://github.com/chat2db/Chat2DB/",name:"Github"}];function fd(){var n=(0,Fa.s0)(),a=(0,xr.LM)(function(C){return{userInfo:C.curUser}}),t=a.userInfo,r=(0,l.useState)(md),o=j()(r,2),i=o[0],u=o[1],c=gr(function(C){return C.mainPageActiveTab}),m=(0,l.useState)(window.location.pathname.split("/")[1]||c),f=j()(m,2),b=f[0],E=f[1],O=(0,l.useMemo)(function(){var C;return(C=window.electronApi)===null||C===void 0?void 0:C.getPlatform().isMac},[]);(0,l.useEffect)(function(){return c==="workspace"?(0,tr.B)((0,e.jsx)(yl,{})):(0,tr.B)(!1),function(){(0,tr.B)(!1)}},[c]),(0,l.useEffect)(function(){T(),Mt(),xl()},[]),Zl(function(){x(c)},[c]),(0,l.useEffect)(function(){var C=i.findIndex(function(v){return"".concat(v.key)===b});if(C>-1){i[C].isLoad=!0,u(_e()(i));var p=window.location.origin+"/"+b;window.history.pushState({},"",p)}},[b]);var T=function(){var C=he()(ee()().mark(function p(){var v,k;return ee()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:v=_e()(i),t&&(k=v.find(function(M){return M.key==="team"}),t.admin&&!k&&v.splice(3,0,{key:"team",icon:"\uE64B",iconFontSize:24,isLoad:b==="team",component:(0,e.jsx)(sd,{}),name:(0,s.ZP)("team.title")}),!t.admin&&k&&v.splice(3,1)),u(_e()(v));case 3:case"end":return S.stop()}},p)}));return function(){return C.apply(this,arguments)}}(),x=function(p){p==="github"?window.open("https://github.com/chat2db/Chat2DB/","_blank"):(E(p),ar(p))},_=function(){(0,Xe.Kv)().then(function(){(0,xr.Dt)(void 0),n("/login")})},N=function(){return(0,e.jsx)(Ae.Z,{menu:{items:[{key:"1",label:(0,e.jsxs)("div",{className:ya.userDropdown,onClick:_,children:[(0,e.jsx)(X.Z,{code:"\uE6B2"}),(0,s.ZP)("login.text.logout")]})}]},placement:"bottomRight",trigger:["click"],children:(0,e.jsx)("div",{className:ya.userBox,children:(0,e.jsx)(X.Z,{code:"\uE64C",className:ya.questionIcon})})})};return(0,e.jsxs)("div",{className:ya.page,children:[(0,e.jsxs)("div",{className:ya.layoutLeft,children:[O===void 0&&(0,e.jsx)(Je.Z,{size:38,className:ya.brandLogo}),(0,e.jsx)("ul",{className:ya.navList,children:i.map(function(C){return(0,e.jsx)(Ve.Z,{placement:"right",title:C.name,children:(0,e.jsx)("li",{className:$()(W()({},ya.activeNav,C.key==b)),onClick:function(){return x(C.key)},children:(0,e.jsx)(X.Z,{size:C.iconFontSize,className:ya.icon,code:C.icon})})},C.key)})}),(0,e.jsxs)("div",{className:ya.footer,children:[(0,e.jsx)(Ve.Z,{placement:"right",title:(0,s.ZP)("setting.title.goto.chat2db.pro"),children:(0,e.jsx)(dd.Z,{className:ya.rocketIcon,onClick:function(){var p=(0,cd.b)();window.open(p,"_blank")}})}),(0,e.jsx)(ud.Z,{className:ya.setIcon})]})]}),(0,e.jsx)("div",{className:ya.layoutRight,children:i.map(function(C){return(0,e.jsx)("div",{className:ya.componentBox,hidden:b!==C.key,children:C.isLoad?C.component:null},C.key)})})]})}var vd=fd},90403:function(At,Ea,K){"use strict";var pe=K(46621),W=(0,pe.Z)("/api/rdb/table/list",{method:"get"}),Da=(0,pe.Z)("/api/rdb/dml/execute",{method:"post",delayTime:10}),ee=(0,pe.Z)("/api/rdb/dml/execute_table",{method:"post",delayTime:10}),La=(0,pe.Z)("/api/connection/console/connect",{method:"get"}),he=(0,pe.Z)("/api/rdb/ddl/delete",{method:"post"}),Ua=(0,pe.Z)("/api/rdb/ddl/create/example",{method:"get"}),_e=(0,pe.Z)("/api/rdb/ddl/update/example",{method:"get"}),Et=(0,pe.Z)("/api/rdb/ddl/export",{method:"get"}),j=(0,pe.Z)("/api/rdb/ddl/execute",{method:"post"}),l=(0,pe.Z)("/api/rdb/ddl/column_list",{method:"get",delayTime:200}),Fa=(0,pe.Z)("/api/rdb/ddl/index_list",{method:"get",delayTime:200}),Ae=(0,pe.Z)("/api/rdb/ddl/key_list",{method:"get",delayTime:200}),Ve=(0,pe.Z)("/api/rdb/ddl/schema_list",{method:"get",delayTime:200}),la=(0,pe.Z)("/api/rdb/ddl/database_schema_list",{method:"get"}),$=(0,pe.Z)("/api/pin/table/add",{method:"post"}),X=(0,pe.Z)("/api/pin/table/delete",{method:"post"}),Je=(0,pe.Z)("/api/rdb/dml/count",{method:"post"}),s=(0,pe.Z)("/api/rdb/view/list",{method:"get"}),Xe=(0,pe.Z)("/api/rdb/function/list",{method:"get"}),ae=(0,pe.Z)("/api/rdb/trigger/list",{method:"get"}),Ct=(0,pe.Z)("/api/rdb/procedure/list",{method:"get"}),Ra=(0,pe.Z)("/api/rdb/view/column_list",{method:"get"}),Ot=(0,pe.Z)("/api/rdb/view/detail",{method:"get"}),jt=(0,pe.Z)("/api/rdb/trigger/detail",{method:"get"}),Wn=(0,pe.Z)("/api/rdb/function/detail",{method:"get"}),Hn=(0,pe.Z)("/api/rdb/procedure/detail",{method:"get"}),Gn=(0,pe.Z)("/api/sql/format",{method:"get"}),qn=(0,pe.Z)("/api/rdb/table/table_meta",{method:"get"}),Kn=(0,pe.Z)("/api/rdb/table/query",{method:"get"}),zn=(0,pe.Z)("/api/rdb/table/table_list",{method:"get"}),Yn=(0,pe.Z)("/api/rdb/table/column_list",{method:"get"}),Qn=(0,pe.Z)("/api/rdb/table/modify/sql",{method:"post"}),$n=(0,pe.Z)("/api/rdb/dml/execute_ddl",{method:"post"}),Jn=(0,pe.Z)("/api/rdb/dml/execute_update",{method:"post"}),Xn=(0,pe.Z)("/api/rdb/dml/get_update_sql",{method:"post"}),ra=(0,pe.Z)("/api/rdb/database/create_database_sql",{method:"post"}),zt=(0,pe.Z)("/api/rdb/schema/create_schema_sql",{method:"post"});Ea.Z={getCreateSchemaSql:zt,getCreateDatabaseSql:ra,executeUpdateDataSql:Jn,executeDDL:$n,getExecuteUpdateSql:Xn,getModifyTableSql:Qn,getTableDetails:Kn,getDatabaseFieldTypeList:qn,sqlFormat:Gn,getTriggerDetail:jt,getProcedureDetail:Hn,getFunctionDetail:Wn,getViewDetail:Ot,getViewColumnList:Ra,getProcedureList:Ct,getTriggerList:ae,getFunctionList:Xe,getViewList:s,getTableList:W,executeSql:Da,executeTable:j,connectConsole:La,deleteTable:he,createTableExample:Ua,updateTableExample:_e,exportCreateTableSql:Et,viewTable:ee,getColumnList:l,getIndexList:Fa,getKeyList:Ae,getSchemaList:Ve,getDatabaseSchemaList:la,addTablePin:$,deleteTablePin:X,getDMLCount:Je,getAllTableList:zn,getAllFieldByTable:Yn}},71807:function(At,Ea,K){"use strict";K.d(Ea,{B:function(){return Da},N:function(){return W}});var pe=K(55988),W={appTitleBarRightComponent:null},Da=function(La){return pe.E.setState({appTitleBarRightComponent:La})}},93181:function(At,Ea,K){"use strict";K.d(Ea,{G9:function(){return Da},h7:function(){return ee},n$:function(){return W}});var pe=K(55988),W={openModal:null},Da=function(he){return pe.E.setState({openModal:he})},ee=function(he){var Ua,_e;return(Ua=(_e=pe.E.getState()).openModal)===null||Ua===void 0?void 0:Ua.call(_e,he)}},2550:function(At,Ea,K){"use strict";K.d(Ea,{r:function(){return Da},t:function(){return W}});var pe=K(55988),W={focusedContent:null},Da=function(La){return pe.E.setState({focusedContent:La})}},55988:function(At,Ea,K){"use strict";K.d(Ea,{E:function(){return Et}});var pe=K(97857),W=K.n(pe),Da=K(50161),ee=K(782),La=K(76248),he=K(2550),Ua=K(93181),_e=K(71807),Et=(0,Da.F)((0,ee.mW)(function(){return W()(W()(W()({},he.t),Ua.n$),_e.N)}),La.X)},94902:function(){}}]);
